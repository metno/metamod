<html><head><title>strictures</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="_grygrnw.css" media="all" >

<script type="text/javascript" src="_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:27 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#import'>import</a>
    <li class='indexItem indexItem2'><a href='#VERSION'>VERSION</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#EXTRA_TESTING_RATIONALE'>EXTRA TESTING RATIONALE</a>
  <li class='indexItem indexItem1'><a href='#COMMUNITY_AND_SUPPORT'>COMMUNITY AND SUPPORT</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#IRC_channel'>IRC channel</a>
    <li class='indexItem indexItem2'><a href='#Git_repository'>Git repository</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#CONTRIBUTORS'>CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>strictures - turn on strict and make all warnings fatal</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use strictures 1;</pre>

<p>is equivalent to</p>

<pre>  use strict;
  use warnings FATAL =&#62; &#39;all&#39;;</pre>

<p>except when called from a file which matches:</p>

<pre>  (caller)[1] =~ /^(?:t|xt|lib|blib)/</pre>

<p>and when either <code>.git</code> or <code>.svn</code> is present in the current directory (with the intention of only forcing extra tests on the author side) -- or when <code>.git</code> or <code>.svn</code> is present two directories up along with <code>dist.ini</code> (which would indicate we are in a <code>dzil test</code> operation, via <a href="./Dist/Zilla.html" class="podlinkpod"
>Dist::Zilla</a>) -- or when the <code>PERL_STRICTURES_EXTRA</code> environment variable is set, in which case</p>

<pre>  use strictures 1;</pre>

<p>is equivalent to</p>

<pre>  use strict;
  use warnings FATAL =&#62; &#39;all&#39;;
  no indirect &#39;fatal&#39;;
  no multidimensional;
  no bareword::filehandles;</pre>

<p>Note that <code>PERL_STRICTURES_EXTRA</code> may at some point add even more tests, with only a minor version increase, but any changes to the effect of <code>use strictures</code> in normal mode will involve a major version bump.</p>

<p>If any of the extra testing modules are not present, <a href="./strictures.html" class="podlinkpod"
>strictures</a> will complain loudly, once, via <code>warn()</code>, and then shut up. But you really should consider installing them, they&#39;re all great anti-footgun tools.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>I&#39;ve been writing the equivalent of this module at the top of my code for about a year now. I figured it was time to make it shorter.</p>

<p>Things like the importer in <code>use Moose</code> don&#39;t help me because they turn warnings on but don&#39;t make them fatal -- which from my point of view is useless because I want an exception to tell me my code isn&#39;t warnings-clean.</p>

<p>Any time I see a warning from my code, that indicates a mistake.</p>

<p>Any time my code encounters a mistake, I want a crash -- not spew to STDERR and then unknown (and probably undesired) subsequent behaviour.</p>

<p>I also want to ensure that obvious coding mistakes, like indirect object syntax (and not so obvious mistakes that cause things to accidentally compile as such) get caught, but not at the cost of an XS dependency and not at the cost of blowing things up on another machine.</p>

<p>Therefore, <a href="./strictures.html" class="podlinkpod"
>strictures</a> turns on additional checking, but only when it thinks it&#39;s running in a test file in a VCS checkout -- although if this causes undesired behaviour this can be overridden by setting the <code>PERL_STRICTURES_EXTRA</code> environment variable.</p>

<p>If additional useful author side checks come to mind, I&#39;ll add them to the <code>PERL_STRICTURES_EXTRA</code> code path only -- this will result in a minor version increase (e.g. 1.000000 to 1.001000 (1.1.0) or similar). Any fixes only to the mechanism of this code will result in a sub-version increase (e.g. 1.000000 to 1.000001 (1.0.1)).</p>

<p>If the behaviour of <code>use strictures</code> in normal mode changes in any way, that will constitute a major version increase -- and the code already checks when its version is tested to ensure that</p>

<pre>  use strictures 1;</pre>

<p>will continue to only introduce the current set of strictures even if 2.0 is installed.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="import"
>import</a></h2>

<p>This method does the setup work described above in <a href="#DESCRIPTION" class="podlinkpod"
>&#34;DESCRIPTION&#34;</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h2>

<p>This method traps the <code>strictures-&#62;VERSION(1)</code> call produced by a use line with a version number on it and does the version check.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXTRA_TESTING_RATIONALE"
>EXTRA TESTING RATIONALE</a></h1>

<p>Every so often, somebody complains that they&#39;re deploying via <code>git pull</code> and that they don&#39;t want <a href="./strictures.html" class="podlinkpod"
>strictures</a> to enable itself in this case -- and that setting <code>PERL_STRICTURES_EXTRA</code> to 0 isn&#39;t acceptable (additional ways to disable extra testing would be welcome but the discussion never seems to get that far).</p>

<p>In order to allow us to skip a couple of stages and get straight to a productive conversation, here&#39;s my current rationale for turning the extra testing on via a heuristic:</p>

<p>The extra testing is all stuff that only ever blows up at compile time; this is intentional. So the oft-raised concern that it&#39;s different code being tested is only sort of the case -- none of the modules involved affect the final optree to my knowledge, so the author gets some additional compile time crashes which he/she then fixes, and the rest of the testing is completely valid for all environments.</p>

<p>The point of the extra testing -- especially <code>no indirect</code> -- is to catch mistakes that newbie users won&#39;t even realise are mistakes without help. For example,</p>

<pre>  foo { ... };</pre>

<p>where foo is an &#38; prototyped sub that you forgot to import -- this is pernicious to track down since all <i>seems</i> fine until it gets called and you get a crash. Worse still, you can fail to have imported it due to a circular require, at which point you have a load order dependent bug which I&#39;ve seen before now <i>only</i> show up in production due to tiny differences between the production and the development environment. I wrote <a href="http://shadow.cat/blog/matt-s-trout/indirect-but-still-fatal/" class="podlinkurl"
>http://shadow.cat/blog/matt-s-trout/indirect-but-still-fatal/</a> to explain this particular problem before <a href="./strictures.html" class="podlinkpod"
>strictures</a> itself existed.</p>

<p>As such, in my experience so far <a href="./strictures.html" class="podlinkpod"
>strictures</a>&#39; extra testing has <i>avoided</i> production versus development differences, not caused them.</p>

<p>Additionally, <a href="./strictures.html" class="podlinkpod"
>strictures</a>&#39; policy is very much &#34;try and provide as much protection as possible for newbies -- who won&#39;t think about whether there&#39;s an option to turn on or not&#34; -- so having only the environment variable is not sufficient to achieve that (I get to explain that you need to add <code>use strict</code> at least once a week on freenode #perl -- newbies sometimes completely skip steps because they don&#39;t understand that that step is important).</p>

<p>I make no claims that the heuristic is perfect -- it&#39;s already been evolved significantly over time, especially for 1.004 where we changed things to ensure it only fires on files in your checkout (rather than <a href="./strictures.html" class="podlinkpod"
>strictures</a>-using modules you happened to have installed, which was just silly). However, I hope the above clarifies why a heuristic approach is not only necessary but desirable from a point of view of providing new users with as much safety as possible, and will allow any future discussion on the subject to focus on &#34;how do we minimise annoyance to people deploying from checkouts intentionally&#34;.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COMMUNITY_AND_SUPPORT"
>COMMUNITY AND SUPPORT</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="IRC_channel"
>IRC channel</a></h2>

<p>irc.perl.org #toolchain</p>

<p>(or bug &#39;mst&#39; in query on there or freenode)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Git_repository"
>Git repository</a></h2>

<p>Gitweb is on http://git.shadowcat.co.uk/ and the clone URL is:</p>

<pre>  git clone git://git.shadowcat.co.uk/p5sagit/strictures.git</pre>

<p>The web interface to the repository is at:</p>

<pre>  http://git.shadowcat.co.uk/gitweb/gitweb.cgi?p=p5sagit/strictures.git</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>mst - Matt S. Trout (cpan:MSTROUT) &#60;mst@shadowcat.co.uk&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONTRIBUTORS"
>CONTRIBUTORS</a></h1>

<p>None required yet. Maybe this module is perfect (hahahahaha ...).</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2010 the strictures <a href="#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34;</a> and <a href="#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34;</a> as listed above.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>This library is free software and may be distributed under the same terms as perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
