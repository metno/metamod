<html><head><title>Package::Variant</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:23 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Declaring_a_variable_package'>Declaring a variable package</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Setting_up_the_environment_for_building_variations'>Setting up the environment for building variations</a>
      <li class='indexItem indexItem3'><a href='#Declaring_a_method_to_produce_variants'>Declaring a method to produce variants</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Using_variable_packages'>Using variable packages</a>
    <li class='indexItem indexItem2'><a href='#Dynamic_creation_of_variant_packages'>Dynamic creation of variant packages</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#OPTIONS'>OPTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#importing'>importing</a>
    <li class='indexItem indexItem2'><a href='#subs'>subs</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#VARIABLE_PACKAGE_METHODS'>VARIABLE PACKAGE METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#make_variant'>make_variant</a>
    <li class='indexItem indexItem2'><a href='#import'>import</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Package%3A%3AVariant_METHODS'>Package::Variant METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#build_variation_of'>build_variation_of</a>
    <li class='indexItem indexItem2'><a href='#import'>import</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#EXPORTS'>EXPORTS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#install'>install</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#CONTRIBUTORS'>CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Package::Variant - Parameterizable packages</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  # declaring a variable Moo role
  package My::Role::ObjectAttr;
  use strictures 1;
  use Package::Variant
    # what modules to &#39;use&#39;
    importing =&#62; [&#39;Moo::Role&#39;],
    # proxied subroutines
    subs =&#62; [ qw(has around before after with) ],

  sub make_variant {
    my ($class, $target_package, %arguments) = @_;
    # access arguments
    my $name = $arguments{name};
    # use proxied &#39;has&#39; to add an attribute
    has $name =&#62; (is =&#62; &#39;lazy&#39;);
    # install a builder method
    install &#34;_build_${name}&#34; =&#62; sub {
      return $arguments{class}-&#62;new;
    };
  }

  # using the role
  package My::Class::WithObjectAttr;
  use strictures 1;
  use Moo;
  use My::Role::ObjectAttr;

  with ObjectAttr(name =&#62; &#39;some_obj&#39;, class =&#62; &#39;Some::Class&#39;);

  # using our class
  my $obj = My::Class::WithObjectAttr-&#62;new;
  $obj-&#62;some_obj; # returns a Some::Class instance</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module allows you to build packages that return different variations depending on what parameters are given.</p>

<p>Users of your package will receive a subroutine able to take parameters and return the name of a suitable variant package. The implmenetation does not care about what kind of package it builds.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Declaring_a_variable_package"
>Declaring a variable package</a></h2>

<p>There are two important parts to creating a variable package. You first have to give <code>Package::Variant</code> some basic information about what kind of package you want to provide, and how. The second part is implementing a method receiving the user&#39;s arguments and generating your variants.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Setting_up_the_environment_for_building_variations"
>Setting up the environment for building variations</a></h3>

<p>When you <code>use Package::Variant</code>, you pass along some arguments that describe how you intend to build your variations.</p>

<pre>  use Package::Variant
    importing =&#62; { $package =&#62; \@import_arguments, ... },
    subs      =&#62; [ @proxied_subroutine_names ];</pre>

<p>The <a href="#importing" class="podlinkpod"
>&#34;importing&#34;</a> option needs to be a hash or array reference with package names to be <code>use</code>d as keys, and array references containing the import arguments as values. These packages will be imported into every new variant, and need to set up every declarative subroutine you require to build your variable package. The next option will allow you to use these functions. See <a href="#importing" class="podlinkpod"
>&#34;importing&#34;</a> for more options. You can omit empty import argument lists when passing an array reference.</p>

<p>The <a href="#subs" class="podlinkpod"
>&#34;subs&#34;</a> option is an array reference of subroutine names that are exported by the packages specified with <a href="#importing" class="podlinkpod"
>&#34;importing&#34;</a>. These subroutines will be proxied from your declaration package to the variant to be generated.</p>

<p>With <a href="#importing" class="podlinkpod"
>&#34;importing&#34;</a> initializing your package and <a href="#subs" class="podlinkpod"
>&#34;subs&#34;</a> declaring what subroutines you want to use to build a variant, you can now write a <a href="#make_variant" class="podlinkpod"
>&#34;make_variant&#34;</a> method building your variants.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Declaring_a_method_to_produce_variants"
>Declaring a method to produce variants</a></h3>

<p>Every time a user requests a new variant a method named <a href="#make_variant" class="podlinkpod"
>&#34;make_variant&#34;</a> will be called with the name of the target package and the arguments from the user.</p>

<p>It can then use the proxied subroutines declared with <a href="#subs" class="podlinkpod"
>&#34;subs&#34;</a> to customize the new package. An <a href="#install" class="podlinkpod"
>&#34;install&#34;</a> subroutine is exported as well allowing you to dynamically install methods into the new package. If these options aren&#39;t flexible enough, you can use the passed name of the new package to do any other kind of customizations.</p>

<pre>  sub make_variant {
    my ($class, $target, @arguments) = @_;
    # ...
    # customization goes here
    # ...
  }</pre>

<p>When the method is finished, the user will receive the name of the new package variant you just set up.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Using_variable_packages"
>Using variable packages</a></h2>

<p>After your variable package is <a href="#Declaring_a_variable_package" class="podlinkpod"
>created</a> your users can get a variant generating subroutine by simply importing your package.</p>

<pre>  use My::Variant;
  my $new_variant_package = Variant(@variant_arguments);</pre>

<p>The package is now fully initialized and used. You can import the subroutine under a different name by specifying an <code>as</code> argument.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Dynamic_creation_of_variant_packages"
>Dynamic creation of variant packages</a></h2>

<p>For regular uses, the <a href="#Using_variable_packages" class="podlinkpod"
>normal import</a> provides more than enough flexibility. However, if you want to create variations of dynamically determined packages, you can use the <a href="#build_variation_of" class="podlinkpod"
>&#34;build_variation_of&#34;</a> method.</p>

<p>You can use this to create variations of other packages and pass arguments on to them to allow more modular and extensible variations.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<p>These are the options that can be passed when importing <code>Package::Variant</code>. They describe the environment in which the variants are created.</p>

<pre>  use Package::Variant
    importing =&#62; { $package =&#62; \@import_arguments, ... },
    subs      =&#62; [ @proxied_subroutines ];</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="importing"
>importing</a></h2>

<p>This option is a hash reference mapping package names to array references containing import arguments. The packages will be imported with the given arguments by every variation before the <a href="#make_variant" class="podlinkpod"
>&#34;make_variant&#34;</a> method is asked to create the package (this is done using <a href="../Import/Into.html" class="podlinkpod"
>Import::Into</a>).</p>

<p>If import order is important to you, you can also pass the <code>importing</code> arguments as a flat array reference:</p>

<pre>  use Package::Variant
    importing =&#62; [ &#39;PackageA&#39;, &#39;PackageB&#39; ];

  # same as
  use Package::Variant
    importing =&#62; [ &#39;PackageA&#39; =&#62; [], &#39;PackageB&#39; =&#62; [] ];

  # or
  use Package::Variant
    importing =&#62; { &#39;PackageA&#39; =&#62; [], &#39;PackageB&#39; =&#62; [] };</pre>

<p>The import method will be called even if the list of import arguments is empty or not specified,</p>

<p>If you just want to import a single package&#39;s default exports, you can also pass a string instead:</p>

<pre>  use Package::Variant importing =&#62; &#39;Package&#39;;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="subs"
>subs</a></h2>

<p>An array reference of strings listing the names of subroutines that should be proxied. These subroutines are expected to be installed into the new variant package by the modules imported with <a href="#importing" class="podlinkpod"
>&#34;importing&#34;</a>. Subroutines with the same name will be availabe in your declaration package, and will proxy through to the newly created package when used within <a href="#make_variant" class="podlinkpod"
>&#34;make_variant&#34;</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VARIABLE_PACKAGE_METHODS"
>VARIABLE PACKAGE METHODS</a></h1>

<p>These are methods on the variable package you declare when you import <code>Package::Variant</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="make_variant"
>make_variant</a></h2>

<pre>  Some::Variant::Package-&#62;make_variant( $target, @arguments );</pre>

<p><b>You need to provide this method.</b> This method will be called for every new variant of your package. This method should use the subroutines declared in <a href="#subs" class="podlinkpod"
>&#34;subs&#34;</a> to customize the new variant package.</p>

<p>This is a class method receiving the <code>$target</code> package and the <code>@arguments</code> defining the requested variant.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="import"
>import</a></h2>

<pre>  use Some::Variant::Package;
  my $variant_package = Package( @arguments );</pre>

<p>This method is provided for you. It will allow a user to <code>use</code> your package and receive a subroutine taking <code>@arguments</code> defining the variant and returning the name of the newly created variant package.</p>

<p>The following options can be specified when importing:</p>

<ul>
<li><b>as</b>
<pre>  use Some::Variant::Package as =&#62; &#39;Foo&#39;;
  my $variant_package = Foo(@arguments);</pre>

<p>Exports the generator subroutine under a different name than the default.</p>
</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Package::Variant_METHODS"
><code>Package::Variant</code> METHODS</a></h1>

<p>These methods are available on <code>Package::Variant</code> itself.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="build_variation_of"
>build_variation_of</a></h2>

<pre>  my $variant_package = Package::Variant
    -&#62;build_variation_of($variable_package, @arguments);</pre>

<p>This is the dynamic method of creating new variants. It takes the <code>$variable_package</code>, which is a pre-declared variable package, and a set of <code>@arguments</code> passed to the package to generate a new <code>$variant_package</code>, which will be returned.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="import"
>import</a></h2>

<pre>  use Package::Variant @options;</pre>

<p>Sets up the environment in which you declare the variants of your packages. See <a href="#OPTIONS" class="podlinkpod"
>&#34;OPTIONS&#34;</a> for details on the available options and <a href="#EXPORTS" class="podlinkpod"
>&#34;EXPORTS&#34;</a> for a list of exported subroutines.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXPORTS"
>EXPORTS</a></h1>

<p>Additionally to the proxies for subroutines provided in <a href="#subs" class="podlinkpod"
>&#34;subs&#34;</a>, the following exports will be available in your variable package:</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="install"
>install</a></h2>

<pre>  install($method_name, $code_reference);</pre>

<p>Installs a method with the given <code>$method_name</code> into the newly created variant package. The <code>$code_reference</code> will be used as the body for the method, and if <a href="../Sub/Name.html" class="podlinkpod"
>Sub::Name</a> is available the coderef will be named. If you want to name it something else, then use:</p>

<pre>  install($method_name, $name_to_use, $code_reference);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>mst - Matt S. Trout (cpan:MSTROUT) &#60;mst@shadowcat.co.uk&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONTRIBUTORS"
>CONTRIBUTORS</a></h1>

<p>phaylon - Robert Sedlacek (cpan:PHAYLON) &#60;r.sedlacek@shadowcat.co.uk&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2010-2012 the <code>Package::Variant</code> <a href="#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34;</a> and <a href="#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34;</a> as listed above.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>This library is free software and may be distributed under the same terms as perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
