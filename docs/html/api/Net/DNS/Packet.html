<html><head><title>Net::DNS::Packet</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:22 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#data'>data</a>
    <li class='indexItem indexItem2'><a href='#header'>header</a>
    <li class='indexItem indexItem2'><a href='#EDNS_extended_header'>EDNS extended header</a>
    <li class='indexItem indexItem2'><a href='#reply'>reply</a>
    <li class='indexItem indexItem2'><a href='#question%2C_zone'>question, zone</a>
    <li class='indexItem indexItem2'><a href='#answer%2C_pre%2C_prerequisite'>answer, pre, prerequisite</a>
    <li class='indexItem indexItem2'><a href='#authority%2C_update'>authority, update</a>
    <li class='indexItem indexItem2'><a href='#additional'>additional</a>
    <li class='indexItem indexItem2'><a href='#print'>print</a>
    <li class='indexItem indexItem2'><a href='#string'>string</a>
    <li class='indexItem indexItem2'><a href='#answerfrom'>answerfrom</a>
    <li class='indexItem indexItem2'><a href='#answersize'>answersize</a>
    <li class='indexItem indexItem2'><a href='#push'>push</a>
    <li class='indexItem indexItem2'><a href='#unique_push'>unique_push</a>
    <li class='indexItem indexItem2'><a href='#pop'>pop</a>
    <li class='indexItem indexItem2'><a href='#dn_comp'>dn_comp</a>
    <li class='indexItem indexItem2'><a href='#dn_expand'>dn_expand</a>
    <li class='indexItem indexItem2'><a href='#sign_tsig'>sign_tsig</a>
    <li class='indexItem indexItem2'><a href='#sign_sig0'>sign_sig0</a>
    <li class='indexItem indexItem2'><a href='#truncate'>truncate</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Net::DNS::Packet - DNS protocol packet</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Net::DNS::Packet;

    $query = new Net::DNS::Packet(&#39;example.com&#39;, &#39;MX&#39;, &#39;IN&#39;);

    $reply = $resolver-&#62;send($query);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>A <code>Net::DNS::Packet</code> object represents a DNS protocol packet.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    $packet = new Net::DNS::Packet(&#39;example.com&#39;);
    $packet = new Net::DNS::Packet(&#39;example.com&#39;, &#39;MX&#39;, &#39;IN&#39;);

    $packet = new Net::DNS::Packet();</pre>

<p>If passed a domain, type, and class, <code>new</code> creates a packet object appropriate for making a DNS query for the requested information. The type and class can be omitted; they default to A and IN.</p>

<p>If called with an empty argument list, <code>new</code> creates an empty packet.</p>

<pre>    $packet = new Net::DNS::Packet(\$data);
    $packet = new Net::DNS::Packet(\$data, 1);          # set debugging</pre>

<p>If passed a reference to a scalar containing DNS packet data, a new packet object is created by decoding the data. The optional second boolean argument is used to enable debugging output.</p>

<p>Returns undef if unable to create a packet object.</p>

<p>Decoding errors, including data corruption and truncation, are collected in the $@ ($EVAL_ERROR) variable.</p>

<pre>    ($packet, $length) = new Net::DNS::Packet(\$data);</pre>

<p>If called in array context, returns a packet object and the number of octets successfully decoded.</p>

<p>Note that the number of RRs in each section of the packet may differ from the corresponding header value if the data has been truncated or corrupted.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="data"
>data</a></h2>

<pre>    $data = $packet-&#62;data;
    $data = $packet-&#62;data($limit);</pre>

<p>Returns the packet data in binary format, suitable for sending to a nameserver.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="header"
>header</a></h2>

<pre>    $header = $packet-&#62;header;</pre>

<p>Constructor method which returns a reference to the unique <code>Net::DNS::Header</code> object which represents the header section of the packet.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="EDNS_extended_header"
>EDNS extended header</a></h2>

<pre>    $edns    = $packet-&#62;edns;
    $version = $edns-&#62;version;
    $size    = $edns-&#62;size;</pre>

<p>Auxilliary function edns() provides access to EDNS extensions.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="reply"
>reply</a></h2>

<pre>    $reply = $query-&#62;reply( $UDPmax );</pre>

<p>Constructor method which returns a new reply packet.</p>

<p>The optional UDPsize argument is the maximum UDP packet size which can be reassembled by the local network stack, and is advertised in response to an EDNS query.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="question,_zone"
>question, zone</a></h2>

<pre>    @question = $packet-&#62;question;</pre>

<p>Returns a list of <code>Net::DNS::Question</code> objects representing the question section of the packet.</p>

<p>In dynamic update packets, this section is known as <code>zone</code> and specifies the zone to be updated.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="answer,_pre,_prerequisite"
>answer, pre, prerequisite</a></h2>

<pre>    @answer = $packet-&#62;answer;</pre>

<p>Returns a list of <code>Net::DNS::RR</code> objects representing the answer section of the packet.</p>

<p>In dynamic update packets, this section is known as <code>pre</code> or <code>prerequisite</code> and specifies the RRs or RRsets which must or must not preexist.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="authority,_update"
>authority, update</a></h2>

<pre>    @authority = $packet-&#62;authority;</pre>

<p>Returns a list of <code>Net::DNS::RR</code> objects representing the authority section of the packet.</p>

<p>In dynamic update packets, this section is known as <code>update</code> and specifies the RRs or RRsets to be added or deleted.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="additional"
>additional</a></h2>

<pre>    @additional = $packet-&#62;additional;</pre>

<p>Returns a list of <code>Net::DNS::RR</code> objects representing the additional section of the packet.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="print"
>print</a></h2>

<pre>    $packet-&#62;print;</pre>

<p>Prints the packet data on the standard output in an ASCII format similar to that used in DNS zone files.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="string"
>string</a></h2>

<pre>    print $packet-&#62;string;</pre>

<p>Returns a string representation of the packet.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="answerfrom"
>answerfrom</a></h2>

<pre>    print &#34;packet received from &#34;, $packet-&#62;answerfrom, &#34;\n&#34;;</pre>

<p>Returns the IP address from which we received this packet. User-created packets will return undef for this method.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="answersize"
>answersize</a></h2>

<pre>    print &#34;packet size: &#34;, $packet-&#62;answersize, &#34; bytes\n&#34;;</pre>

<p>Returns the size of the packet in bytes as it was received from a nameserver. User-created packets will return undef for this method (use <code>length $packet-&#62;data</code> instead).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="push"
>push</a></h2>

<pre>    $ancount = $packet-&#62;push(prereq =&#62; $rr);
    $nscount = $packet-&#62;push(update =&#62; $rr);
    $arcount = $packet-&#62;push(additional =&#62; $rr);

    $nscount = $packet-&#62;push(update =&#62; $rr1, $rr2, $rr3);
    $nscount = $packet-&#62;push(update =&#62; @rr);</pre>

<p>Adds RRs to the specified section of the packet.</p>

<p>Returns the number of resource records in the specified section.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="unique_push"
>unique_push</a></h2>

<pre>    $ancount = $packet-&#62;unique_push(prereq =&#62; $rr);
    $nscount = $packet-&#62;unique_push(update =&#62; $rr);
    $arcount = $packet-&#62;unique_push(additional =&#62; $rr);

    $nscount = $packet-&#62;unique_push(update =&#62; $rr1, $rr2, $rr3);
    $nscount = $packet-&#62;unique_push(update =&#62; @rr);</pre>

<p>Adds RRs to the specified section of the packet provided that the RRs do not already exist in the packet.</p>

<p>Returns the number of resource records in the specified section.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="pop"
>pop</a></h2>

<pre>    my $rr = $packet-&#62;pop(&#34;pre&#34;);
    my $rr = $packet-&#62;pop(&#34;update&#34;);
    my $rr = $packet-&#62;pop(&#34;additional&#34;);
    my $rr = $packet-&#62;pop(&#34;question&#34;);</pre>

<p>Removes RRs from the specified section of the packet.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dn_comp"
>dn_comp</a></h2>

<pre>    $compname = $packet-&#62;dn_comp(&#34;foo.example.com&#34;, $offset);</pre>

<p>Returns a domain name compressed for a particular packet object, to be stored beginning at the given offset within the packet data. The name will be added to a running list of compressed domain names for future use.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dn_expand"
>dn_expand</a></h2>

<pre>    use Net::DNS::Packet qw(dn_expand);
    ($name, $nextoffset) = dn_expand(\$data, $offset);

    ($name, $nextoffset) = Net::DNS::Packet::dn_expand(\$data, $offset);</pre>

<p>Expands the domain name stored at a particular location in a DNS packet. The first argument is a reference to a scalar containing the packet data. The second argument is the offset within the packet where the (possibly compressed) domain name is stored.</p>

<p>Returns the domain name and the offset of the next location in the packet.</p>

<p>Returns undef if the domain name could not be expanded.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sign_tsig"
>sign_tsig</a></h2>

<pre>    $key_name = &#34;tsig-key&#34;;
    $key      = &#34;awwLOtRfpGE+rRKF2+DEiw==&#34;;

    $update = Net::DNS::Update-&#62;new(&#34;example.com&#34;);
    $update-&#62;push(&#34;update&#34;, rr_add(&#34;foo.example.com A 10.1.2.3&#34;));

    $update-&#62;sign_tsig($key_name, $key);

    $response = $res-&#62;send($update);</pre>

<p>Attaches a TSIG resource record object containing a key, which will be used to sign a packet with a TSIG resource record (see RFC 2845). Uses the following defaults:</p>

<pre>    algorithm   = HMAC-MD5.SIG-ALG.REG.INT
    time_signed = current time
    fudge       = 300 seconds</pre>

<p>If you wish to customize the TSIG record, you&#39;ll have to create it yourself and call the appropriate Net::DNS::RR::TSIG methods. The following example creates a TSIG record and sets the fudge to 60 seconds:</p>

<pre>    $key_name = &#34;tsig-key&#34;;
    $key      = &#34;awwLOtRfpGE+rRKF2+DEiw==&#34;;

    $tsig = Net::DNS::RR-&#62;new(&#34;$key_name TSIG $key&#34;);
    $tsig-&#62;fudge(60);

    $query = Net::DNS::Packet-&#62;new(&#34;www.example.com&#34;);
    $query-&#62;sign_tsig($tsig);

    $response = $res-&#62;send($query);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sign_sig0"
>sign_sig0</a></h2>

<p>SIG0 support is provided through the Net::DNS::RR::SIG class. This class is not part of the default Net::DNS distribution but resides in the Net::DNS::SEC distribution.</p>

<pre>    $update = Net::DNS::Update-&#62;new(&#34;example.com&#34;);
    $update-&#62;push(&#34;update&#34;, rr_add(&#34;foo.example.com A 10.1.2.3&#34;));
    $update-&#62;sign_sig0(&#34;Kexample.com+003+25317.private&#34;);</pre>

<p>SIG0 support is experimental see Net::DNS::RR::SIG for details.</p>

<p>The method will call <code>Carp::croak()</code> if Net::DNS::RR::SIG cannot be found.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="truncate"
>truncate</a></h2>

<p>The truncate method takes a maximum length as argument and then tries to truncate the packet an set the TC bit according to the rules of RFC2181 Section 9.</p>

<p>The minimum maximum length that is honored is 512 octets.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c)1997-2002 Michael Fuhr.</p>

<p>Portions Copyright (c)2002-2004 Chris Reinhardt.</p>

<p>Portions Copyright (c)2002-2009 Olaf Kolkman</p>

<p>Portions Copyright (c)2007-2008 Dick Franks</p>

<p>All rights reserved.</p>

<p>This program is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../perl.html" class="podlinkpod"
>perl</a>, <a href="../../Net/DNS.html" class="podlinkpod"
>Net::DNS</a>, <a href="../../Net/DNS/Resolver.html" class="podlinkpod"
>Net::DNS::Resolver</a>, <a href="../../Net/DNS/Update.html" class="podlinkpod"
>Net::DNS::Update</a>, <a href="../../Net/DNS/Header.html" class="podlinkpod"
>Net::DNS::Header</a>, <a href="../../Net/DNS/Question.html" class="podlinkpod"
>Net::DNS::Question</a>, <a href="../../Net/DNS/RR.html" class="podlinkpod"
>Net::DNS::RR</a>, RFC 1035 Section 4.1, RFC 2136 Section 2, RFC 2845</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
