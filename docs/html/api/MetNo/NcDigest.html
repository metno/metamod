<html><head><title>MetNo::NcDigest</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Fri Apr  4 12:00:05 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#TECHNICAL_DETAILS'>TECHNICAL DETAILS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Variable_types'>Variable types</a>
    <li class='indexItem indexItem2'><a href='#Switches_and_lists'>Switches and lists</a>
    <li class='indexItem indexItem2'><a href='#The_config_file'>The config file</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Structure_elements'>Structure elements</a>
      <li class='indexItem indexItem3'><a href='#Content_of_structure_elements'>Content of structure elements</a>
      <li class='indexItem indexItem3'><a href='#Global_attributes'>Global attributes</a>
      <li class='indexItem indexItem3'><a href='#Variables'>Variables</a>
      <li class='indexItem indexItem3'><a href='#Escapes'>Escapes</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#TODO'>TODO</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#digest'>digest</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Usage'>Usage</a>
      <li class='indexItem indexItem3'><a href='#Parameters'>Parameters</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#global'>global</a>
    <li class='indexItem indexItem2'><a href='#att'>att</a>
    <li class='indexItem indexItem2'><a href='#set'>set</a>
    <li class='indexItem indexItem2'><a href='#vocabulary'>vocabulary</a>
    <li class='indexItem indexItem2'><a href='#convert'>convert</a>
    <li class='indexItem indexItem2'><a href='#variable'>variable</a>
    <li class='indexItem indexItem2'><a href='#set_global_attribute_value'>set_global_attribute_value</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#hloop(%24refval%2C%24level%2C%24path%2C%24subrhash)'>hloop($refval,$level,$path,$subrhash)</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#parse_all(%24pathfilename%2C_%24ownertag%2C_%24xml_metadata_path%2C_%24isChild)'>parse_all($pathfilename, $ownertag, $xml_metadata_path, $isChild)</a>
    <li class='indexItem indexItem2'><a href='#parse_file(_%24fpath%2C_%24xml_metadata_path_)'>parse_file( $fpath, $xml_metadata_path )</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>MetNo::NcDigest</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use MetNo::NcDigest qw( digest );
  digest($pathfilename, $ownertag, $xml_metadata_path, $is_child );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>A netCDF file contains a set of global attributes and a set of variables. Each variable may also have attributes. The global attributes, variables and variable attributes comprise metadata that the program extracts.</p>

<p>In the config directory there must be a conf_digest_nc.xml file defining the rules that complying netCDF files must obey. The extracted metadata are formatted as XML and written to the file given by $xml_metadata_path. In this process, some metadata may be modified and some metadata may be added. Such modifications are regulated by the config file.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TECHNICAL_DETAILS"
>TECHNICAL DETAILS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Variable_types"
>Variable types</a></h2>

<p>Variables in the netCDF files are classified into different types. Two main types exist: &#34;%Data&#34; and &#34;%Coordinate&#34;. The &#34;%Data&#34; variables are supposed to contain physical entities that correspond to standard names in the CF standard names table. The &#34;%Coordinate&#34; variables are variables corresponding to one of the dimensions used by &#34;%Data&#34; variables, or auxilliary coordinate variables that should be declared as such using the &#34;coordinates&#34; attribute for at least one of the &#34;%Data&#34; variables. From these main types, various subtypes are constructed by appending strings to the type names. The following types are hardcoded into the program (additional types may be introduced in the config file):</p>

<pre>    %Data             - The variable represents a physical entity and is not used
                        as a coordinate for other variables.
    %Data_grid        - A data variable with dimensions indicating a 2D grid
                        (usually combined with other dimensions).
    %Coordinate       - The variable is used as a coordinate, but the coordinate
                        type is undecided
    %Coordinate_T     - The variable is used as a time coordinate
    %Coordinate_X     - The variable is used as a coordinate for the X axis
                        (usually having name longitude or Xc).
    %Coordinate_Y     - The variable is used as a coordinate for the Y axis
                        (usually having name latitude or Yc).
    %Coordinate_Z     - Vertical coordinate</pre>

<p>Based on CF rules, the program will try to classify the encountered variables into one of these types. Types may also be set explicitly in the config file. The config file may also define new subtypes based on the dimension strings of the variables.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Switches_and_lists"
>Switches and lists</a></h2>

<p>While analysing a netCDF file, the program may set switches and add values to lists according to the content of the netCDF file and regulations in the config file.</p>

<p>An important class of switches are those corresponding to variable type names. For each of the variable types, there exists a corresponding switch with the same name as the variable type. When at least one variable of a specific type is found, the corresponding switch is set.</p>

<p>In addition to these switches, switches may expicitly be introduced in the config file, and conditions defined for when they should be set.</p>

<p>Lists, and conditions for adding elements to them, are also introduced in the config file.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_config_file"
>The config file</a></h2>

<p>The topmost XML element in the config file is the &#60;digest_nc&#62; element, within which all other elements are contained.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Structure_elements"
>Structure elements</a></h3>

<p>On the next level is one &#60;file_structures&#62; element containing a sequence of &#60;structure&#62; elements. The structure elements are identified by a &#39;name&#39; attribute. One of the structure elements is special. It has name=&#34;default&#34;. The structure elements contain rules that the netCDF files must obey. The default structure contains the default rules.</p>

<p>The other structures contain rules that only pertain to selected datasets. Each of these other structures has a &#39;regex&#39; attribute containing a regular expression that is matched against the xmlpath argument. If the regexp matches, then the rules in this structure applies.</p>

<p>In addition, all netCDF-files must obey the default rules, if not superseded by structure specific rules.</p>

<p>In addition to rules, the structure elements contain elements that have other functions:</p>

<pre>  - Classify the netCDF-files depending on file content
  - Set switches depending on file content
  - Extract information that are added to lists</pre>

<p>These elements are helper elements that are used when formulating rules.</p>

<p>The non-default structure elements also may have elements that:</p>

<pre>  - Explisitly set metadata values
  - Explisitly classify the netCDF-files independent of file content</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Content_of_structure_elements"
>Content of structure elements</a></h3>

<pre>    The following elements are allowed within structure elements:

    &#60;set switch=&#34;...&#34; /&#62;

       Set a global switch. &#34;...&#34; contains the name of the switch, which must start with
       a &#39;%&#39; character. All switches must be declared in a &#60;global&#62; element within the
       default structure element.

    &#60;set_global_attribute_value name=&#34;...&#34;&#62;
       ...
    &#60;/set_global_attribute_value&#62;

       Set a netCDF global attribute. Used within file specific structure elements to set
       global attributes that may be missing or contain wrong values. Name=&#34;...&#34; gives the
       name of the attribute, while its value comprise the content of the element.

    &#60;variables_of_type name=&#34;...&#34;&#62;
       ...
    &#60;/variables_of_type&#62;

       Variables in the netCDF files are classified into various types. This XML element
       is used within file specific structure elements to explicitly classify a set of
       variables. The type name is given in name=&#34;...&#34;, and the set of variables is
       given in the content of the element (each variable name on a separate line).

    &#60;global switches=&#34;...&#34; /&#62;

       This element is used within the default structure to declare a set of global
       switches. A blank separated list of switch names is given by switches=&#34;...&#34;.
       Each name must start with a &#39;%&#39; character. The switches will initally be unset
       each time a new netCDF file is investigated. Other elements may set the switches
       depending on the content of the netCDF file.

       NOTE: It is not neccessary to declare switches with names equal to variable
       type names.

    &#60;global lists=&#34;...&#34; /&#62;

       This element is used within the default structure to declare a set of global
       lists. A blank separated list of list names is given by lists=&#34;...&#34;.
       Each name must start with a &#39;%&#39; character. The lists will initally be empty
       each time a new netCDF file is investigated.
       Other elements may add entities to the lists, depending on the content of the
       netCDF file.

    &#60;investigate_data_dimensions&#62;
       &#60;dim rex=&#34;...&#34; addmatches=&#34;...&#34; extendtype=&#34;...&#34; /&#62;
       ...
    &#60;/investigate_data_dimensions&#62;

       This element sets up rules for classifying netCDF variables according to the
       dimensions used by the variables. Initially, the variables are already classified
       into various types. The main types are &#39;%Data&#39; and &#39;%Coordinate&#39;. Subtypes of
       these main types are also found: &#39;%Data_grid&#39;, &#39;%Coordinate_X&#39;, &#39;%Coordinate_T&#39;
       etc. (&#34;Type&#34; will usually refer to both main types and subtypes).

       The element contains one or more &#60;dim&#62; elements. The &#39;rex&#39; attribute within a &#60;dim&#62;
       element contains a regular expression that is checked against the
       dimension string for each variable. If a match is found, the variable type is
       extended with the string given in extendtype=&#34;...&#34;. If more than one &#60;dim&#62; element
       matches, the first one is used. The optional attribute addmatches=&#34;...&#34; specifies
       a blank separated list of global list names. If this attribute is used, the regular
       expression should contain one parantesised subexpression for each global list in
       the addmatches attribute. The partial matches for the subexpressions are paired
       with the global lists, and each match added to the corresponding global list.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Global_attributes"
>Global attributes</a></h3>

<pre>    &#60;global_attributes&#62;
       &#60;att name=&#34;...&#34;&#62;
          &#60;mandatory ... /&#62;
          &#60;breaklines value=&#34;...&#34; /&#62;
          &#60;multivalue separator=&#34;...&#34; /&#62;
          &#60;vocabulary ... &#62;
             ...
          &#60;/vocabulary&#62;
          &#60;convert&#62;
             ...
          &#60;/convert&#62;
       &#60;/att&#62;
       ...
    &#60;/global_attributes&#62;

       This element contains a sequence of &#60;att&#62; elements, each naming a global attribute
       for which some rules apply, or for which some value conversion is performed.
       All elements within an &#60;att&#62; element are optional. They are used as follows:

       &#60;mandatory errmsg=&#34;...&#34; /&#62;

          This element tells that the global attribute is mandatory, and gives an error
          message to use if the attribute is not found.

       &#60;breaklines value=&#34;...&#34; /&#62;

          This element is used to reformat an attribute value so that no single line
          in the attribute value is longer than the number given in value=&#34;...&#34;.

       &#60;multivalue separator=&#34;...&#34; /&#62;

          The global attribute should be interpreted as a set of values separated by
          the given separator string.

       &#60;vocabulary ... &#62;
          ...
       &#60;/vocabulary&#62;

          This element contains a vocabulary against which the attribute value(s) are
          checked. Each line in the content represents one member of the vocabulary.

          Members of the vocabulary may contain escapes, each of which represents a set
          of character strings. An escape is identified by a &#39;%&#39; character followed by
          some alfanumeric characters. All escape identifiers must be declared in an
          &#34;escapes&#34; XML attribute within the &#60;vocabulary ... &#62; tag. This XML attribute
          contains a blank-separated list of all escapes used within the vocabulary.
          A global attribute value will match a member containing escapes if an exactly
          matching sting can be constructed from the member string by substituting all
          escapes by suitably selected character strings. For each of the escapes, this
          character string must be taken from the set of character strings that the
          escape represents.

          Se below for a list of allowed escape identifiers. In addition to this set,
          identifiers of global lists can be used as escapes. The set of character
          strings represented by a global list escape, is equal to the set of character
          strings within the list.

          Vocabulary members may also contain special keywords which also are
          identified by a &#39;%&#39; character followed by some alfanumeric characters. One
          such keyword is currently defined:

          %MANDATORY    This keyword marks the corresponding member as mandatory. Used
                        when the global attribute may contain multiple values (i.e.
                        when a &#60;multivalue ...&#62; tag is found within the &#60;att&#62; tag).
                        Then, one of the values must match the mandatory vocabulary
                        member.

          All such keywords are removed from a vocabulary member before any match
          against values are performed.

       &#60;convert&#62;
          ...
       &#60;/convert&#62;

          This element is used for changing attribute values. Between the start and
          end tags are lines of the form:

          original_value :TO: new_value

          All attribute values matching original_value are changed to new_value.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Variables"
>Variables</a></h3>

<pre>    &#60;variable name=&#34;...&#34; ...&#62;
       &#60;mandatory ... /&#62;
       &#60;dimensions ...&#62;
          ...
       &#60;/dimensions&#62;
       &#60;att name=&#34;...&#34;&#62;
          &#60;mandatory ... /&#62;
          &#60;breaklines value=&#34;...&#34; /&#62;
          &#60;multivalue separator=&#34;...&#34; /&#62;
          &#60;vocabulary ... &#62;
             ...
          &#60;/vocabulary&#62;
          &#60;convert&#62;
             ...
          &#60;/convert&#62;
       &#60;/att&#62;
       ...
    &#60;/variable&#62;

       The &#60;variable&#62; element describes one variable or variable type. The value of
       the name=&#34;...&#34; attribute is either a variable name or the name of a variable
       type. In the latter case, the name starts with a &#39;%&#39; character. The element
       contains one optional &#60;mandatory&#62; element, a &#60;dimensions&#62; element and any
       number of &#60;att&#62; elements:

       &#60;mandatory ... /&#62;

          If this option is present, the variable of the given name, or at least one
          variable of the given type, is mandatory within the netCDF file. This rule
          can be made conditional by using an only_if=&#34;...&#34; attribute. The value of
          the only_if attribute will contain the name of a global switch, which must
          be set if the rule is to be applied.

          This element should contain an errmsg=&#34;...&#34; attribute giving an error message
          to use if the rule is not obeyed.

       &#60;dimensions ...&#62;
          ...
       &#60;/dimensions&#62;

          This element contains the set of alternative dimension strings that the
          variable can use. A dimension string is the comma-separated list of
          dimensions used by the variable, as shown in a CDL-file.

          Dimension strings may contain escapes in the same manner as vocabulary
          members (explained above). All escape identifiers must be declared in an
          &#34;escapes&#34; XML attribute within the &#60;dimension ... &#62; tag. This XML attribute
          contains a blank-separated list of all escapes used within the dimension
          strings.

          This element should contain an errmsg=&#34;...&#34; attribute giving an error message
          to use if the dimension string actually used do not match any of the
          alternatives.

          If the variable is allowed to have no dimensions (i.e. it can be a scalar),
          this can be expressed by using the escape &#34;%NONE&#34; all by itself, as one of
          the alternative dimension strings.

       &#60;att name=&#34;...&#34;&#62;
          &#60;mandatory ... /&#62;
          &#60;breaklines value=&#34;...&#34; /&#62;
          &#60;multivalue separator=&#34;...&#34; /&#62;
          &#60;vocabulary ... &#62;
             ...
          &#60;/vocabulary&#62;
          &#60;convert&#62;
             ...
          &#60;/convert&#62;
       &#60;/att&#62;

          This element defines rules and modifications applied to variable attributes.
          Any number of &#60;att&#62; elements are allowed. The elements within an &#60;att&#62; element
          are all optional, and their roles are the same as those explained for the
          global attributes (see above).</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Escapes"
>Escapes</a></h3>

<p>Escapes are used within &#60;vocabulary ... &#62; elements (both for global and variable attributes), and in &#60;dimensions ... &#62; elements.</p>

<p>An escape is identified by a &#39;%&#39; character followed by some alfanumeric characters. Each escape represents a set of character strings. An escape having an identifier equal to a global list name, represents the character strings found in the list. All other escapes have fixed names, and the set of character strings they represent are hardcoded into the program.</p>

<p>The following escapes with fixed names are found:</p>

<pre>   %ANYSTRING        - Any character string.

   %ISODATE          - Date conforming to the ISO date standard, i.e.
                      having the form YYYY-MM-DD.

   %LATITUDE         - A number between -90.0 and 90.0

   %LONGITUDE        - A number between -180.0 and 180.0

   %hh               - Hour. An integer between 00 and 23

   %mm               - Minute. An integer between 00 and 59

   %ss               - Second. An integer between 00 and 59

   %i                - Any integer &#62;= 1

   %EMAIL            - Any legal E-mail address

   %NONE             - The empty string

   %TIMEUNIT         - Any time unit accepted by the UDUNITS package. Example:
                      &#34;seconds since 1981-01-01 00:00:00&#34;

   %SINGLEWORD       - Any word composed of characters [a-zA-Z0-9_]

   %CF_STANDARD_NAME - A name from the CF standard names table

   %UDUNIT           - Any unit accepted by the UDUNITS package.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TODO"
>TODO</a></h1>

<p>Rewrite as Object-oriented class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="digest"
>digest</a></h2>

<p>Checks the content of netCDF files. All the files must belong to the same dataset. Metadata are extracted from the files and saved into an XML file. The netCDF files are supposed to be CF compliant.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Usage"
>Usage</a></h3>

<pre>  digest($pathfilename, $ownertag, $xml_metadata_path, $is_child );</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Parameters"
>Parameters</a></h3>

<dl>
<dt><a name="$pathfilename"
>$pathfilename</a></dt>

<dd>
<p>Path to input file. The first line in this file is an URL that points to where the data will be found by users. This dataref URL will be included as metadata in the XML file to be produced. The rest of the lines comprise the files to be parsed, one file on each line. These files all belongs to one dataset.</p>

<dt><a name="$ownertag"
>$ownertag</a></dt>

<dd>
<p>Short keyword (e.g. &#34;DAM&#34;) that will tag the data in the database as owned by a specific project/organisation.</p>

<dt><a name="$xml_metadata_path"
>$xml_metadata_path</a></dt>

<dd>
<p>Path to an XML file that will receive the result of the netCDF parsing. If this file already exists, it will contain the metadata for a previous version of the dataset. In this case, a new version of the file will be created, comprising a merge of the old and new metadata. The xmlpath will also define the dataset-name: last directory parts + filename for parents, last two directory parts + filename for children.</p>

<dt><a name="$is_child"
>$is_child</a></dt>

<dd>
<p>if defined, creates a child xml-file, that is a xml-file which corresponds exactly to one file, rather than to a set/directory of files. The content of the old xmlpath will be ignored and just overwritten. The dataset-name will contain of an extra directory.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="global"
>global</a></h2>

<p>Add to the %globswitches and %globlists hashes.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="att"
>att</a></h2>

<p>Add attributes to the %attributes hash using keys as: &#34;&#60;structure name&#62;,&#60;glob_or_var&#62;,&#60;attribute name&#62;&#34; where &#60;structure name&#62; is &#34;default&#34; or the name of another structure, and &#60;glob_or_var&#62; is either &#34;global_attributes&#34; or the name of a variable.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set"
>set</a></h2>

<p>Initialize global switch (in %globswitches) as set.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="vocabulary"
>vocabulary</a></h2>

<p>Add to the %vocabularies hash.</p>

<p>The keys to this hash has the form: &#34;&#60;structname&#62;,&#60;glob_or_var&#62;,&#60;attributename&#62;&#34; where:</p>

<pre>    &#60;structname&#62; is &#34;default&#34; or the name of another structure.
    &#60;glob_or_var&#62; is &#34;global_attribute&#34; or variable name.
    &#60;attributename&#62; is name of the attribute.</pre>

<p>Each hash value is a reference to an array with five elements:</p>

<pre>    [0]:  Reference to the @content array containing the original lines
          within the vocabulary. These are used to search for switches
          that are to be set if a line matches an attribute value.
    [1]:  Reference to the @rcontent array with regular expressions
          corresponding to each @content line. NOTE: The original line
          (in @content) must not contain any special characters used in
          regular expressions (^ $ [ ] \ ( ) ? | ? * + { } ).
    [2]:  Reference to the @mapcontent array (see below).
    [3]:  String telling what to do if value not found in vocabulary.
          Is one of: &#34;use&#34;, &#34;notuse&#34; or &#34;use_first_in_vocabulary&#34;.
    [4]:  Error message key (string) to be used if value not found
          in vocabulary. Could be an empty string.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="convert"
>convert</a></h2>

<p>Add to the %conversions hash:</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="variable"
>variable</a></h2>

<p>Add to the %variables hash:</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_global_attribute_value"
>set_global_attribute_value</a></h2>

<p>... FIXME</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="hloop($refval,$level,$path,$subrhash)"
>hloop($refval,$level,$path,$subrhash)</a></h3>

<p>Recursively traverse the XML tree:</p>

<p>Split argument array into the following variables:</p>

<dl>
<dt><a name="$refval"
>$refval</a></dt>

<dd>
<p>Reference to subtree inside the larger XML tree. (can both be a HASH reference or ARRAY reference):</p>

<dt><a name="$level"
>$level</a></dt>

<dd>
<p>Number representing the level where the subtree is rooted. The upmost (root) level corresponds to 0.</p>

<dt><a name="$path"
>$path</a></dt>

<dd>
<p>String. Sequence of hash keys and array indices separated by &#34;/&#34; characters. Each key/index represents a key or index in the XML tree. The first key/index corresponds to one of the nodes identified by the topmost (root) node. Then follows the keys and indices down to, and including, the identifier of the current subtree. The $path is a unique identifier of the current subtree.</p>

<dt><a name="$subrhash"
>$subrhash</a></dt>

<dd>
<p>Reference to the %parse_actions hash of subroutines. These subroutines are identified by hash keywords used in the XML tree, and activated when hloop encounters these keywords in the XML tree.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="parse_all($pathfilename,_$ownertag,_$xml_metadata_path,_$isChild)"
>parse_all($pathfilename, $ownertag, $xml_metadata_path, $isChild)</a></h2>

<p>Loop through all files found in the $pathfilename file. Parse each of these files. Construct two hashes. Both uses the file pathes in $pathfilename as keys:</p>

<dl>
<dt><a name="%all_variables"
>%all_variables</a></dt>

<dd>
<p>References to variables found within each file. Each reference points to a hash describing the variables within the file. See the %foundvars hash described in the parse_file routine.</p>

<dt><a name="%all_globatts"
>%all_globatts</a></dt>

<dd>
<p>References to global attributes found within each file. Each reference points to a hash describing the global attributes of the file. See the %foundglobatts hash described in the parse_file routine.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="parse_file(_$fpath,_$xml_metadata_path_)"
>parse_file( $fpath, $xml_metadata_path )</a></h2>

<p>This subroutine parses one netCDF file given by the file or URL path $fpath</p>

<dl>
<dt><a name="$fpath"
>$fpath</a></dt>

<dd>
<dt><a name="$xml_metadata_path_(optional)"
>$xml_metadata_path (optional)</a></dt>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Egil St&#248;ren, &#60;egils\@met.no&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>GPLv2 <a href="http://www.gnu.org/licenses/gpl-2.0.html" class="podlinkurl"
>http://www.gnu.org/licenses/gpl-2.0.html</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
