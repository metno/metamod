<html><head><title>Moose::Manual::MOP</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:21 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#INTRODUCTION'>INTRODUCTION</a>
  <li class='indexItem indexItem1'><a href='#GETTING_STARTED'>GETTING STARTED</a>
  <li class='indexItem indexItem1'><a href='#USING_THE_METACLASS_OBJECT'>USING THE METACLASS OBJECT</a>
  <li class='indexItem indexItem1'><a href='#ALTERING_CLASSES_WITH_THE_MOP'>ALTERING CLASSES WITH THE MOP</a>
  <li class='indexItem indexItem1'><a href='#GOING_FURTHER'>GOING FURTHER</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Moose::Manual::MOP - The Moose (and Class::MOP) meta API</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>version 2.0604</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTRODUCTION"
>INTRODUCTION</a></h1>

<p>Moose provides a powerful introspection API built on top of <code>Class::MOP</code>.
&#34;MOP&#34; stands for Meta-Object Protocol.
In plainer English,
a MOP is an API for performing introspection on classes,
attributes,
methods,
and so on.</p>

<p>In fact,
it is <code>Class::MOP</code> that provides many of Moose&#39;s core features,
including attributes,
before/after/around method modifiers,
and immutability.
In most cases,
Moose takes an existing <code>Class::MOP</code> class and subclasses it to add additional features.
Moose also adds some entirely new features of its own,
such as roles,
the augment modifier,
and types.</p>

<p>If you&#39;re interested in the MOP,
it&#39;s important to know about <code>Class::MOP</code> so you know what docs to read.
Often,
the introspection method that you&#39;re looking for is defined in a <code>Class::MOP</code> class,
rather than Moose itself.</p>

<p>The MOP provides more than just <i>read-only</i> introspection.
It also lets you add attributes and methods,
apply roles,
and much more.
In fact,
all of the declarative Moose sugar is simply a thin layer on top of the MOP API.</p>

<p>If you want to write Moose extensions,
you&#39;ll need to learn some of the MOP API.
The introspection methods are also handy if you want to generate docs or inheritance graphs,
or do some other runtime reflection.</p>

<p>This document is not a complete reference for the meta API.
We&#39;re just going to cover some of the highlights,
and give you a sense of how it all works.
To really understand it,
you&#39;ll have to read a lot of other docs,
and possibly even dig into the Moose guts a bit.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="GETTING_STARTED"
>GETTING STARTED</a></h1>

<p>The usual entry point to the meta API is through a class&#39;s metaclass object,
which is a <a href="../../Moose/Meta/Class.html" class="podlinkpod"
>Moose::Meta::Class</a>.
This is available by calling the <code>meta</code> method on a class or object:</p>

<pre>  package User;

  use Moose;

  my $meta = __PACKAGE__-&#62;meta;</pre>

<p>The <code>meta</code> method is added to a class when it uses Moose.</p>

<p>You can also use <code>Class::MOP::Class-&#62;initialize($name)</code> to get a metaclass object for any class. This is safer than calling <code>$class-&#62;meta</code> when you&#39;re not sure that the class has a meta method.</p>

<p>The <code>Class::MOP::Class-&#62;initialize</code> constructor will return an existing metaclass if one has already been created (via Moose or some other means). If it hasn&#39;t, it will return a new <code>Class::MOP::Class</code> object. This will work for classes that use Moose, meta API classes, and classes which don&#39;t use Moose at all.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USING_THE_METACLASS_OBJECT"
>USING THE METACLASS OBJECT</a></h1>

<p>The metaclass object can tell you about a class&#39;s attributes, methods, roles, parents, and more. For example, to look at all of the class&#39;s attributes:</p>

<pre>  for my $attr ( $meta-&#62;get_all_attributes ) {
      print $attr-&#62;name, &#34;\n&#34;;
  }</pre>

<p>The <code>get_all_attributes</code> method is documented in <code>Class::MOP::Class</code>. For Moose-using classes, it returns a list of <a href="../../Moose/Meta/Attribute.html" class="podlinkpod"
>Moose::Meta::Attribute</a> objects for attributes defined in the class and its parents.</p>

<p>You can also get a list of methods:</p>

<pre>  for my $method ( $meta-&#62;get_all_methods ) {
      print $method-&#62;fully_qualified_name, &#34;\n&#34;;
  }</pre>

<p>Now we&#39;re looping over a list of <a href="../../Moose/Meta/Method.html" class="podlinkpod"
>Moose::Meta::Method</a> objects. Note that some of these objects may actually be a subclass of <a href="../../Moose/Meta/Method.html" class="podlinkpod"
>Moose::Meta::Method</a>, as Moose uses different classes to represent wrapped methods, delegation methods, constructors, etc.</p>

<p>We can look at a class&#39;s parent classes and subclasses:</p>

<pre>  for my $class ( $meta-&#62;linearized_isa ) {
      print &#34;$class\n&#34;;
  }

  for my $subclass ( $meta-&#62;subclasses ) {
      print &#34;$subclass\n&#34;;
  }</pre>

<p>Note that both these methods return class <i>names</i>, not metaclass objects.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ALTERING_CLASSES_WITH_THE_MOP"
>ALTERING CLASSES WITH THE MOP</a></h1>

<p>The metaclass object can change the class directly, by adding attributes, methods, etc.</p>

<p>As an example, we can add a method to a class:</p>

<pre>  $meta-&#62;add_method( &#39;say&#39; =&#62; sub { print @_, &#34;\n&#34; } );</pre>

<p>Or an attribute:</p>

<pre>  $meta-&#62;add_attribute( &#39;size&#39; =&#62; ( is =&#62; &#39;rw&#39;, isa  =&#62; &#39;Int&#39; ) );</pre>

<p>Obviously, this is much more cumbersome than using Perl syntax or Moose sugar for defining methods and attributes, but this API allows for very powerful extensions.</p>

<p>You might remember that we&#39;ve talked about making classes immutable elsewhere in the manual. This is a good practice. However, once a class is immutable, calling any of these update methods will throw an exception.</p>

<p>You can make a class mutable again simply by calling <code>$meta-&#62;make_mutable</code>. Once you&#39;re done changing it, you can restore immutability by calling <code>$meta-&#62;make_immutable</code>.</p>

<p>However, the most common use for this part of the meta API is as part of Moose extensions. These extensions should assume that they are being run before you make a class immutable.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="GOING_FURTHER"
>GOING FURTHER</a></h1>

<p>If you&#39;re interested in extending Moose, we recommend reading all of the &#34;Meta&#34; and &#34;Extending&#34; recipes in the <a href="../../Moose/Cookbook.html" class="podlinkpod"
>Moose::Cookbook</a>. Those recipes show various practical applications of the MOP.</p>

<p>If you&#39;d like to write your own extensions, one of the best ways to learn more about this is to look at other similar extensions to see how they work. You&#39;ll probably also need to read various API docs, including the docs for the various <code>Moose::Meta::*</code> and <code>Class::MOP::*</code> classes.</p>

<p>Finally, we welcome questions on the Moose mailing list and IRC. Information on the mailing list, IRC, and more references can be found in the <a href="../../Moose.html#GETTING_HELP" class="podlinkpod"
>Moose.pm docs</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Moose is maintained by the Moose Cabal, along with the help of many contributors. See <a href="../../Moose.html#CABAL" class="podlinkpod"
>&#34;CABAL&#34; in Moose</a> and <a href="../../Moose.html#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34; in Moose</a> for details.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>This software is copyright (c) 2012 by Infinity Interactive, Inc..</p>

<p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
