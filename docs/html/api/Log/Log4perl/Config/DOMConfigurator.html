<html><head><title>Log::Log4perl::Config::DOMConfigurator</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:19 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#WHY'>WHY</a>
  <li class='indexItem indexItem1'><a href='#HOW'>HOW</a>
  <li class='indexItem indexItem1'><a href='#WHY_TWO_DTDs'>WHY TWO DTDs</a>
  <li class='indexItem indexItem1'><a href='#WHY_NAMESPACES'>WHY NAMESPACES</a>
  <li class='indexItem indexItem1'><a href='#VARIABLE_SUBSTITUTION'>VARIABLE SUBSTITUTION</a>
  <li class='indexItem indexItem1'><a href='#REQUIRES'>REQUIRES</a>
  <li class='indexItem indexItem1'><a href='#CAVEATS'>CAVEATS</a>
  <li class='indexItem indexItem1'><a href='#CHANGES'>CHANGES</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Log::Log4perl::Config::DOMConfigurator - reads xml config files</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    --------------------------
    --using the log4j DTD--
    --------------------------

    &#60;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&#62;
    &#60;!DOCTYPE log4j:configuration SYSTEM &#34;log4j.dtd&#34;&#62;

    &#60;log4j:configuration xmlns:log4j=&#34;http://jakarta.apache.org/log4j/&#34;&#62;

    &#60;appender name=&#34;FileAppndr1&#34; class=&#34;org.apache.log4j.FileAppender&#34;&#62;
        &#60;layout class=&#34;Log::Log4perl::Layout::PatternLayout&#34;&#62;
                &#60;param name=&#34;ConversionPattern&#34;
                       value=&#34;%d %4r [%t] %-5p %c %t - %m%n&#34;/&#62;
        &#60;/layout&#62;
        &#60;param name=&#34;File&#34; value=&#34;t/tmp/DOMtest&#34;/&#62;
        &#60;param name=&#34;Append&#34; value=&#34;false&#34;/&#62;
    &#60;/appender&#62;

    &#60;category name=&#34;a.b.c.d&#34; additivity=&#34;false&#34;&#62;
        &#60;level value=&#34;warn&#34;/&#62;  &#60;!-- note lowercase! --&#62;
        &#60;appender-ref ref=&#34;FileAppndr1&#34;/&#62;
    &#60;/category&#62;

   &#60;root&#62;
        &#60;priority value=&#34;warn&#34;/&#62;
        &#60;appender-ref ref=&#34;FileAppndr1&#34;/&#62;
   &#60;/root&#62;

   &#60;/log4j:configuration&#62;
   
   
   
   --------------------------
   --using the log4perl DTD--
   --------------------------
   
   &#60;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&#62;
    &#60;!DOCTYPE log4perl:configuration SYSTEM &#34;log4perl.dtd&#34;&#62;

    &#60;log4perl:configuration xmlns:log4perl=&#34;http://log4perl.sourceforge.net/&#34;
        threshold=&#34;debug&#34; oneMessagePerAppender=&#34;true&#34;&#62;

    &#60;log4perl:appender name=&#34;jabbender&#34; class=&#34;Log::Dispatch::Jabber&#34;&#62;

            &#60;param-nested name=&#34;login&#34;&#62;
                   &#60;param name=&#34;hostname&#34; value=&#34;a.jabber.server&#34;/&#62;
                   &#60;param name=&#34;password&#34; value=&#34;12345&#34;/&#62;
                   &#60;param name=&#34;port&#34;     value=&#34;5222&#34;/&#62;
                   &#60;param name=&#34;resource&#34; value=&#34;logger&#34;/&#62;
                   &#60;param name=&#34;username&#34; value=&#34;bobjones&#34;/&#62;
            &#60;/param-nested&#62;

            &#60;param name=&#34;to&#34; value=&#34;bob@a.jabber.server&#34;/&#62;

            &#60;param-text name=&#34;to&#34;&#62;
                  mary@another.jabber.server
            &#60;/param-text&#62;

            &#60;log4perl:layout class=&#34;org.apache.log4j.PatternLayout&#34;&#62;
                &#60;param name=&#34;ConversionPattern&#34; value = &#34;%K xx %G %U&#34;/&#62;
                &#60;cspec name=&#34;K&#34;&#62;
                    sub { return sprintf &#34;%1x&#34;, $$}
                &#60;/cspec&#62;
                &#60;cspec name=&#34;G&#34;&#62;
                    sub {return &#39;thisistheGcspec&#39;}
                &#60;/cspec&#62;
            &#60;/log4perl:layout&#62;
    &#60;/log4perl:appender&#62;

    &#60;log4perl:appender name=&#34;DBAppndr2&#34; class=&#34;Log::Log4perl::Appender::DBI&#34;&#62;
              &#60;param name=&#34;warp_message&#34; value=&#34;0&#34;/&#62;
              &#60;param name=&#34;datasource&#34; value=&#34;DBI:CSV:f_dir=t/tmp&#34;/&#62;
              &#60;param name=&#34;bufferSize&#34; value=&#34;2&#34;/&#62;
              &#60;param name=&#34;password&#34; value=&#34;sub { $ENV{PWD} }&#34;/&#62;
              &#60;param name=&#34;username&#34; value=&#34;bobjones&#34;/&#62;

              &#60;param-text name=&#34;sql&#34;&#62;
                  INSERT INTO log4perltest
                            (loglevel, message, shortcaller, thingid,
                            category, pkg, runtime1, runtime2)
                  VALUES
                             (?,?,?,?,?,?,?,?)
              &#60;/param-text&#62;

               &#60;param-nested name=&#34;params&#34;&#62;
                    &#60;param name=&#34;1&#34; value=&#34;%p&#34;/&#62;
                    &#60;param name=&#34;3&#34; value=&#34;%5.5l&#34;/&#62;
                    &#60;param name=&#34;5&#34; value=&#34;%c&#34;/&#62;
                    &#60;param name=&#34;6&#34; value=&#34;%C&#34;/&#62;
               &#60;/param-nested&#62;

               &#60;layout class=&#34;Log::Log4perl::Layout::NoopLayout&#34;/&#62;
    &#60;/log4perl:appender&#62;

    &#60;category name=&#34;animal.dog&#34;&#62;
               &#60;priority value=&#34;info&#34;/&#62;
               &#60;appender-ref ref=&#34;jabbender&#34;/&#62;
               &#60;appender-ref ref=&#34;DBAppndr2&#34;/&#62;
    &#60;/category&#62;

    &#60;category name=&#34;plant&#34;&#62;
            &#60;priority value=&#34;debug&#34;/&#62;
            &#60;appender-ref ref=&#34;DBAppndr2&#34;/&#62;
    &#60;/category&#62;

    &#60;PatternLayout&#62;
        &#60;cspec name=&#34;U&#34;&#62;&#60;![CDATA[
            sub {
                return &#34;UID $&#60; GID $(&#34;;
            }
        ]]&#62;&#60;/cspec&#62;
    &#60;/PatternLayout&#62;

    &#60;/log4perl:configuration&#62;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module implements an XML config, complementing the properties-style config described elsewhere.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="WHY"
>WHY</a></h1>

<p>&#34;Why would I want my config in XML?&#34; you ask. Well, there are a couple reasons you might want to. Maybe you have a personal preference for XML. Maybe you manage your config with other tools that have an affinity for XML, like XML-aware editors or automated config generators. Or maybe (and this is the big one) you don&#39;t like having to run your application just to check the syntax of your config file.</p>

<p>By using an XML config and referencing a DTD, you can use a namespace-aware validating parser to see if your XML config at least follows the rules set in the DTD.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="HOW"
>HOW</a></h1>

<p>To reference a DTD, drop this in after the &#60;?xml...&#62; declaration in your config file:</p>

<pre>    &#60;!DOCTYPE log4perl:configuration SYSTEM &#34;log4perl.dtd&#34;&#62;</pre>

<p>That tells the parser to validate your config against the DTD in &#34;log4perl.dtd&#34;, which is available in the xml/ directory of the log4perl distribution. Note that you&#39;ll also need to grab the log4j-1.2.dtd from there as well, since the it&#39;s included by log4perl.dtd.</p>

<p>Namespace-aware validating parsers are not the norm in Perl. But the Xerces project (http://xml.apache.org/xerces-c/index.html --lots of binaries available, even rpm&#39;s) does provide just such a parser that you can use like this:</p>

<pre>    StdInParse -ns -v &#60; my-log4perl-config.xml</pre>

<p>This module itself does not use a validating parser, the obvious one XML::DOM::ValParser doesn&#39;t seem to handle namespaces.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="WHY_TWO_DTDs"
>WHY TWO DTDs</a></h1>

<p>The log4j DTD is from the log4j project, they designed it to handle their needs. log4perl has added some extensions to the original log4j functionality which needed some extensions to the log4j DTD. If you aren&#39;t using these features then you can validate your config against the log4j dtd and know that you&#39;re using unadulterated log4j config tags.</p>

<p>The features added by the log4perl dtd are:</p>

<dl>
<dt><a name="1_oneMessagePerAppender_global_setting"
>1 oneMessagePerAppender global setting</a></dt>

<dd>
<pre>    log4perl.oneMessagePerAppender=1</pre>

<dt><a name="2_globally_defined_user_conversion_specifiers"
>2 globally defined user conversion specifiers</a></dt>

<dd>
<pre>    log4perl.PatternLayout.cspec.G=sub { return &#34;UID $&#60; GID $(&#34;; }</pre>

<dt><a name="3_appender-local_custom_conversion_specifiers"
>3 appender-local custom conversion specifiers</a></dt>

<dd>
<pre>     log4j.appender.appndr1.layout.cspec.K = sub {return sprintf &#34;%1x&#34;, $$ }</pre>

<dt><a name="4_nested_options"
>4 nested options</a></dt>

<dd>
<pre>     log4j.appender.jabbender          = Log::Dispatch::Jabber
     #(note how these are nested under &#39;login&#39;)
     log4j.appender.jabbender.login.hostname = a.jabber.server
     log4j.appender.jabbender.login.port     = 5222
     log4j.appender.jabbender.login.username = bobjones</pre>

<dt><a name="5_the_log4perl-specific_filters,_see_Log::Log4perl::Filter,_lots_of_examples_in_t/044XML-Filter.t,_here&#39;s_a_short_one:"
>5 the log4perl-specific filters, see <a href="../../../Log/Log4perl/Filter.html" class="podlinkpod"
>Log::Log4perl::Filter</a>, lots of examples in t/044XML-Filter.t, here&#39;s a short one:</a></dt>

<dd>
<pre>  &#60;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&#62; 
  &#60;!DOCTYPE log4perl:configuration SYSTEM &#34;log4perl.dtd&#34;&#62;

  &#60;log4perl:configuration xmlns:log4perl=&#34;http://log4perl.sourceforge.net/&#34;&#62;
   
  &#60;appender name=&#34;A1&#34; class=&#34;Log::Log4perl::Appender::TestBuffer&#34;&#62;
        &#60;layout class=&#34;Log::Log4perl::Layout::SimpleLayout&#34;/&#62;
        &#60;filter class=&#34;Log::Log4perl::Filter::Boolean&#34;&#62;
            &#60;param name=&#34;logic&#34; value=&#34;!Match3 &#38;amp;&#38;amp; (Match1 || Match2)&#34;/&#62; 
        &#60;/filter&#62;
  &#60;/appender&#62;   
  
  &#60;appender name=&#34;A2&#34; class=&#34;Log::Log4perl::Appender::TestBuffer&#34;&#62;
        &#60;layout class=&#34;Log::Log4perl::Layout::SimpleLayout&#34;/&#62;
        &#60;filter-ref id=&#34;Match1&#34;/&#62;
  &#60;/appender&#62;   
  
  &#60;log4perl:filter name=&#34;Match1&#34; value=&#34;sub { /let this through/ }&#34; /&#62;
  
  &#60;log4perl:filter name=&#34;Match2&#34;&#62;
        sub { 
            /and that, too/ 
        }
   &#60;/log4perl:filter&#62;
  
  &#60;log4perl:filter name=&#34;Match3&#34; class=&#34;Log::Log4perl::Filter::StringMatch&#34;&#62;
    &#60;param name=&#34;StringToMatch&#34; value=&#34;suppress&#34;/&#62;
    &#60;param name=&#34;AcceptOnMatch&#34; value=&#34;true&#34;/&#62;
  &#60;/log4perl:filter&#62;
  
  &#60;log4perl:filter name=&#34;MyBoolean&#34; class=&#34;Log::Log4perl::Filter::Boolean&#34;&#62;
    &#60;param name=&#34;logic&#34; value=&#34;!Match3 &#38;amp;&#38;amp; (Match1 || Match2)&#34;/&#62;
  &#60;/log4perl:filter&#62;
  
   
   &#60;root&#62;
           &#60;priority value=&#34;info&#34;/&#62;
           &#60;appender-ref ref=&#34;A1&#34;/&#62;
   &#60;/root&#62;
   
   &#60;/log4perl:configuration&#62;</pre>
</dd>
</dl>

<p>So we needed to extend the log4j dtd to cover these additions. Now I could have just taken a &#39;steal this code&#39; approach and mixed parts of the log4j dtd into a log4perl dtd, but that would be cut-n-paste programming. So I&#39;ve used namespaces and</p>

<ul>
<li>replaced three elements:
<dl>
<dt><a name="&#60;log4perl:configuration&#62;"
>&#60;log4perl:configuration&#62;</a></dt>

<dd>
<p>handles #1) and accepts &#60;PatternLayout&#62;</p>

<dt><a name="&#60;log4perl:appender&#62;"
>&#60;log4perl:appender&#62;</a></dt>

<dd>
<p>accepts &#60;param-nested&#62; and &#60;param-text&#62;</p>

<dt><a name="&#60;log4perl:layout&#62;"
>&#60;log4perl:layout&#62;</a></dt>

<dd>
<p>accepts custom cspecs for #3)</p>
</dd>
</dl>
</li>

<li>added a &#60;param-nested&#62; element (complementing the &#60;param&#62; element) to handle #4)</li>

<li>added a root &#60;PatternLayout&#62; element to handle #2)</li>

<li>added &#60;param-text&#62; which lets you put things like perl code into escaped CDATA between the tags, so you don&#39;t have to worry about escaping characters and quotes</li>

<li>added &#60;cspec&#62;</li>
</ul>

<p>See the examples up in the <a href="#SYNOPSIS" class="podlinkpod"
>&#34;SYNOPSIS&#34;</a> for how all that gets used.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="WHY_NAMESPACES"
>WHY NAMESPACES</a></h1>

<p>I liked the idea of using the log4j DTD <i>in situ</i>, so I used namespaces to extend it. If you really don&#39;t like having to type &#60;log4perl:appender&#62; instead of just &#60;appender&#62;, you can make your own DTD combining the two DTDs and getting rid of the namespace prefixes. Then you can validate against that, and log4perl should accept it just fine.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VARIABLE_SUBSTITUTION"
>VARIABLE SUBSTITUTION</a></h1>

<p>This supports variable substitution like <code>${foobar}</code> in text and in attribute values except for appender-ref. If an environment variable is defined for that name, its value is substituted. So you can do stuff like</p>

<pre>        &#60;param name=&#34;${hostname}&#34; value=&#34;${hostnameval}.foo.com&#34;/&#62;
        &#60;param-text name=&#34;to&#34;&#62;${currentsysadmin}@foo.com&#60;/param-text&#62;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="REQUIRES"
>REQUIRES</a></h1>

<p>To use this module you need XML::DOM installed.</p>

<p>To use the log4perl.dtd, you&#39;ll have to reference it in your XML config, and you&#39;ll also need to note that log4perl.dtd references the log4j dtd as &#34;log4j-1.2.dtd&#34;, so your validator needs to be able to find that file as well. If you don&#39;t like having to schlep two files around, feel free to dump the contents of &#34;log4j-1.2.dtd&#34; into your &#34;log4perl.dtd&#34; file.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAVEATS"
>CAVEATS</a></h1>

<p>You can&#39;t mix a multiple param-nesteds with the same name, I&#39;m going to leave that for now, there&#39;s presently no need for a list of structs in the config.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CHANGES"
>CHANGES</a></h1>

<p>0.03 2/26/2003 Added support for log4perl extensions to the log4j dtd</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>t/038XML-DOM1.t, t/039XML-DOM2.t for examples</p>

<p>xml/log4perl.dtd, xml/log4j-1.2.dtd</p>

<p>Log::Log4perl::Config</p>

<p>Log::Log4perl::Config::PropertyConfigurator</p>

<p>Log::Log4perl::Config::LDAPConfigurator (coming soon!)</p>

<p>The code is brazenly modeled on log4j&#39;s DOMConfigurator class, (by Christopher Taylor, Ceki G&#252;lc&#252;, and Anders Kristensen) and any perceived similarity is not coincidental.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>Copyright 2002-2013 by Mike Schilli &#60;m@perlmeister.com&#62; and Kevin Goess &#60;cpan@goess.org&#62;.</p>

<p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Please contribute patches to the project on Github:</p>

<pre>    http://github.com/mschilli/log4perl</pre>

<p>Send bug reports or requests for enhancements to the authors via our</p>

<p>MAILING LIST (questions, bug reports, suggestions/patches): log4perl-devel@lists.sourceforge.net</p>

<p>Authors (please contact them via the list above, not directly): Mike Schilli &#60;m@perlmeister.com&#62;, Kevin Goess &#60;cpan@goess.org&#62;</p>

<p>Contributors (in alphabetical order): Ateeq Altaf, Cory Bennett, Jens Berthold, Jeremy Bopp, Hutton Davidson, Chris R. Donnelly, Matisse Enzer, Hugh Esco, Anthony Foiani, James FitzGibbon, Carl Franks, Dennis Gregorovic, Andy Grundman, Paul Harrington, Alexander Hartmaier David Hull, Robert Jacobson, Jason Kohles, Jeff Macdonald, Markus Peter, Brett Rann, Peter Rabbitson, Erik Selberg, Aaron Straup Cope, Lars Thegler, David Viner, Mac Yang.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
