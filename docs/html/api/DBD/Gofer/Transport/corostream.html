<html><head><title>DBD::Gofer::Transport::corostream</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:14 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#KNOWN_ISSUES_AND_LIMITATIONS'>KNOWN ISSUES AND LIMITATIONS</a>
  <li class='indexItem indexItem1'><a href='#STATUS'>STATUS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENCE_AND_COPYRIGHT'>LICENCE AND COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#APPENDIX'>APPENDIX</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBD::Gofer::Transport::corostream - Async DBD::Gofer stream transport using Coro and AnyEvent</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>   DBI_AUTOPROXY=&#34;dbi:Gofer:transport=corostream&#34; perl some-perl-script-using-dbi.pl</pre>

<p>or</p>

<pre>   $dsn = ...; # the DSN for the driver and database you want to use
   $dbh = DBI-&#62;connect(&#34;dbi:Gofer:transport=corostream;dsn=$dsn&#34;, ...);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The <i>BIG WIN</i> from using <a href="../../../Coro.html" class="podlinkpod"
>Coro</a> is that it enables the use of existing DBI frameworks like <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="KNOWN_ISSUES_AND_LIMITATIONS"
>KNOWN ISSUES AND LIMITATIONS</a></h1>

<pre>  - Uses Coro::Select so alters CORE::select globally
    Parent class probably needs refactoring to enable a more encapsulated approach.

  - Doesn&#39;t prevent multiple concurrent requests
    Probably just needs a per-connection semaphore

  - Coro has many caveats. Caveat emptor.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="STATUS"
>STATUS</a></h1>

<p>THIS IS CURRENTLY JUST A PROOF-OF-CONCEPT IMPLEMENTATION FOR EXPERIMENTATION.</p>

<p>Please note that I have no plans to develop this code further myself. I&#39;d very much welcome contributions. Interested? Let me know!</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Tim Bunce, <a href="http://www.tim.bunce.name" class="podlinkurl"
>http://www.tim.bunce.name</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENCE_AND_COPYRIGHT"
>LICENCE AND COPYRIGHT</a></h1>

<p>Copyright (c) 2010, Tim Bunce, Ireland. All rights reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself. See <a href="../../../perlartistic.html" class="podlinkpod"
>perlartistic</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../../DBD/Gofer/Transport/stream.html" class="podlinkpod"
>DBD::Gofer::Transport::stream</a></p>

<p><a href="../../../DBD/Gofer.html" class="podlinkpod"
>DBD::Gofer</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="APPENDIX"
>APPENDIX</a></h1>

<p>Example code:</p>

<pre>    #!perl

    use strict;
    use warnings;
    use Time::HiRes qw(time);

    BEGIN { $ENV{PERL_ANYEVENT_STRICT} = 1; $ENV{PERL_ANYEVENT_VERBOSE} = 1; }

    use AnyEvent;

    BEGIN { $ENV{DBI_TRACE} = 0; $ENV{DBI_GOFER_TRACE} = 0; $ENV{DBD_GOFER_TRACE} = 0; };

    use DBI;

    $ENV{DBI_AUTOPROXY} = &#39;dbi:Gofer:transport=corostream&#39;;

    my $ticker = AnyEvent-&#62;timer( after =&#62; 0, interval =&#62; 0.1, cb =&#62; sub {
        warn sprintf &#34;-tick- %.2f\n&#34;, time
    } );

    warn &#34;connecting...\n&#34;;
    my $dbh = DBI-&#62;connect(&#34;dbi:NullP:&#34;);
    warn &#34;...connected\n&#34;;

    for (1..3) {
        warn &#34;entering DBI...\n&#34;;
        $dbh-&#62;do(&#34;sleep 0.3&#34;); # pseudo-sql understood by the DBD::NullP driver
        warn &#34;...returned\n&#34;;
    }

    warn &#34;done.&#34;;</pre>

<p>Example output:</p>

<pre>    $ perl corogofer.pl
    connecting...
    -tick- 1293631437.14
    -tick- 1293631437.14
    ...connected
    entering DBI...
    -tick- 1293631437.25
    -tick- 1293631437.35
    -tick- 1293631437.45
    -tick- 1293631437.55
    ...returned
    entering DBI...
    -tick- 1293631437.66
    -tick- 1293631437.76
    -tick- 1293631437.86
    ...returned
    entering DBI...
    -tick- 1293631437.96
    -tick- 1293631438.06
    -tick- 1293631438.16
    ...returned
    done. at corogofer.pl line 39.</pre>

<p>You can see that the timer callback is firing while the code &#39;waits&#39; inside the do() method for the response from the database. Normally that would block.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
