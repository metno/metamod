<html><head><title>DBD::File::HowTo</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:14 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#CREATING_DRIVER_CLASSES'>CREATING DRIVER CLASSES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Sample_Skeleton'>Sample Skeleton</a>
    <li class='indexItem indexItem2'><a href='#Start_over'>Start over</a>
    <li class='indexItem indexItem2'><a href='#User_comfort'>User comfort</a>
    <li class='indexItem indexItem2'><a href='#Testing'>Testing</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBD::File::HowTo - Guide to create DBD::File based driver</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  perldoc DBD::File::HowTo
  perldoc DBI
  perldoc DBI::DBD
  perldoc DBD::File::Developers
  perldoc DBI::DBD::SqlEngine::Developers
  perldoc DBI::DBD::SqlEngine
  perldoc SQL::Eval
  perldoc DBI::DBD::SqlEngine::HowTo
  perldoc SQL::Statement::Embed
  perldoc DBD::File
  perldoc DBD::File::HowTo
  perldoc DBD::File::Developers</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This document provides a step-by-step guide, how to create a new <code>DBD::File</code> based DBD. It expects that you carefully read the <a href="../../DBI.html" class="podlinkpod"
>DBI</a> documentation and that you&#39;re familiar with <a href="../../DBI/DBD.html" class="podlinkpod"
>DBI::DBD</a> and had read and understood <a href="../../DBD/ExampleP.html" class="podlinkpod"
>DBD::ExampleP</a>.</p>

<p>This document addresses experienced developers who are really sure that they need to invest time when writing a new DBI Driver. Writing a DBI Driver is neither a weekend project nor an easy job for hobby coders after work. Expect one or two man-month of time for the first start.</p>

<p>Those who are still reading, should be able to sing the rules of <a href="../../DBI/DBD.html#CREATING_A_NEW_DRIVER" class="podlinkpod"
>&#34;CREATING A NEW DRIVER&#34; in DBI::DBD</a>.</p>

<p>Of course, DBD::File is a DBI::DBD::SqlEngine and you surely read <a href="../../DBI/DBD/SqlEngine/HowTo.html" class="podlinkpod"
>DBI::DBD::SqlEngine::HowTo</a> before continuing here.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CREATING_DRIVER_CLASSES"
>CREATING DRIVER CLASSES</a></h1>

<p>Do you have an entry in DBI&#39;s DBD registry? For this guide, a prefix of <code>foo_</code> is assumed.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Sample_Skeleton"
>Sample Skeleton</a></h2>

<pre>    package DBD::Foo;

    use strict;
    use warnings;
    use vars qw(@ISA $VERSION);
    use base qw(DBD::File);

    use DBI ();

    $VERSION = &#34;0.001&#34;;

    package DBD::Foo::dr;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::dr);
    $imp_data_size = 0;

    package DBD::Foo::db;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::db);
    $imp_data_size = 0;

    package DBD::Foo::st;

    use vars qw(@ISA $imp_data_size);

    @ISA = qw(DBD::File::st);
    $imp_data_size = 0;

    package DBD::Foo::Statement;

    use vars qw(@ISA);

    @ISA = qw(DBD::File::Statement);

    package DBD::Foo::Table;

    use vars qw(@ISA);

    @ISA = qw(DBD::File::Table);

    1;</pre>

<p>Tiny, eh? And all you have now is a DBD named foo which will is able to deal with temporary tables, as long as you use <a href="../../SQL/Statement.html" class="podlinkpod"
>SQL::Statement</a>. In <a href="../../DBI/SQL/Nano.html" class="podlinkpod"
>DBI::SQL::Nano</a> environments, this DBD can do nothing.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Start_over"
>Start over</a></h2>

<p>Based on <a href="../../DBI/DBD/SqlEngine/HowTo.html" class="podlinkpod"
>DBI::DBD::SqlEngine::HowTo</a>, we&#39;re now having a driver which could do basic things. Of course, it should now derive from DBD::File instead of DBI::DBD::SqlEngine, shouldn&#39;t it?</p>

<p>DBD::File extends DBI::DBD::SqlEngine to deal with any kind of files. In principle, the only extensions required are to the table class:</p>

<pre>    package DBD::Foo::Table;

    sub bootstrap_table_meta
    {
        my ( $self, $dbh, $meta, $table ) = @_;

        # initialize all $meta attributes which might be relevant for
        # file2table

        return $self-&#62;SUPER::bootstrap_table_meta($dbh, $meta, $table);
    }

    sub init_table_meta
    {
        my ( $self, $dbh, $meta, $table ) = @_;

        # called after $meta contains the results from file2table
        # initialize all missing $meta attributes

        $self-&#62;SUPER::init_table_meta( $dbh, $meta, $table );
    }</pre>

<p>In case <code>DBD::File::Table::open_file</code> doesn&#39;t open the files as the driver needs that, override it!</p>

<pre>    sub open_file
    {
        my ( $self, $meta, $attrs, $flags ) = @_;
        # ensure that $meta-&#62;{f_dontopen} is set
        $self-&#62;SUPER::open_file( $meta, $attrs, $flags );
        # now do what ever needs to be done
    }</pre>

<p>Combined with the methods implemented using the <a href="../../SQL/Statement/Embed.html" class="podlinkpod"
>SQL::Statement::Embed</a> guide, the table is full working and you could try a start over.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="User_comfort"
>User comfort</a></h2>

<p><code>DBD::File</code> since <code>0.39</code> consolidates all persistent meta data of a table into a single structure stored in <code>$dbh-&#62;{f_meta}</code>. With <code>DBD::File</code> version <code>0.41</code> and <code>DBI::DBD::SqlEngine</code> version <code>0.05</code>, this consolidation moves to <a href="../../DBI/DBD/SqlEngine.html" class="podlinkpod"
>DBI::DBD::SqlEngine</a>. It&#39;s still the <code>$dbh-&#62;{$drv_prefix . &#34;_meta&#34;}</code> attribute which cares, so what you learned at this place before, is still valid.</p>

<pre>    sub init_valid_attributes
    {
        my $dbh = $_[0];

        $dbh-&#62;SUPER::init_valid_attributes ();

        $dbh-&#62;{foo_valid_attrs} = { ... };
        $dbh-&#62;{foo_readonly_attrs} = { ...  };

        $dbh-&#62;{foo_meta} = &#34;foo_tables&#34;;

        return $dbh;
    }</pre>

<p>See updates at <a href="../../DBI/DBD/SqlEngine/HowTo.html#User_comfort" class="podlinkpod"
>&#34;User comfort&#34; in DBI::DBD::SqlEngine::HowTo</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Testing"
>Testing</a></h2>

<p>Now you should have your own DBD::File based driver. Was easy, wasn&#39;t it? But does it work well? Prove it by writing tests and remember to use dbd_edit_mm_attribs from <a href="../../DBI/DBD.html" class="podlinkpod"
>DBI::DBD</a> to ensure testing even rare cases.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>This guide is written by Jens Rehsack. DBD::File is written by Jochen Wiedmann and Jeff Zucker.</p>

<p>The module DBD::File is currently maintained by</p>

<p>H.Merijn Brand &#60; h.m.brand at xs4all.nl &#62; and Jens Rehsack &#60; rehsack at googlemail.com &#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>Copyright (C) 2010 by H.Merijn Brand &#38; Jens Rehsack</p>

<p>All rights reserved.</p>

<p>You may freely distribute and/or modify this module under the terms of either the GNU General Public License (GPL) or the Artistic License, as specified in the Perl README file.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
