<html><head><title>HTML::FormHandler::Manual::Testing</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:18 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#Example'>Example</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>HTML::FormHandler::Manual::Testing - testing forms</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>version 0.40028</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p><a href="../../../HTML/FormHandler/Manual.html" class="podlinkpod"
>Manual Index</a></p>

<p>One of the big advantages of FormHandler compared to many other form packages is that you can test the same form that you use in your controller.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>It&#39;s difficult to test forms that are instantiated in controllers with &#39;add_element&#39; calls and from YAML,
and that have no form class.
It&#39;s one of the reasons that &#39;dynamic&#39; forms generated with a field_list aren&#39;t a good idea for anything except the simplest forms.
If you have a form class that contains everything that is needed for processing the form,
it&#39;s really really easy to create tests for forms.
Look in the FormHandler &#39;t&#39; directory.
It&#39;s full of tests for forms.</p>

<p>You can test that the validations work,
that the database is getting updated correctly,
even that the HTML that&#39;s being rendered is correct.
If something isn&#39;t working correctly,
it&#39;s ten times easier to debug in a test case than sitting in a controller somewhere.
And when you finally start up your application and use the form,
there should be very few surprises.</p>

<p>FormHandler provides a simple function to test whether the HTML output is correct,
&#39;is_html&#39; in <a href="../../../HTML/FormHandler/Test.html" class="podlinkpod"
>HTML::FormHandler::Test</a>,
which uses <a href="../../../HTML/TreeBuilder.html" class="podlinkpod"
>HTML::TreeBuilder</a>.
If you need to build forms that use the rendering code to produce particular output,
it can be helpful.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Example"
>Example</a></h1>

<p>Here&#39;s an example of a test,
originally copied from one of the DBIC model tests.
But you should download the tar.gz or checkout the distribution from github and browse through the tests.</p>

<pre>   use Test::More;
   use lib &#39;t/lib&#39;;

   use_ok( &#39;BookDB::Form::Book&#39;);
   use_ok( &#39;BookDB::Schema::DB&#39;);

   my $schema = BookDB::Schema::DB-&#62;connect(&#39;dbi:SQLite:t/db/book.db&#39;);
   ok($schema, &#39;get db schema&#39;);

   my $form = BookDB::Form::Book-&#62;new(schema =&#62; $schema);

   # This is munging up the equivalent of param data from a form
   my $good = {
       &#39;title&#39; =&#62; &#39;How to Test Perl Form Processors&#39;,
       &#39;author&#39; =&#62; &#39;I.M. Author&#39;,
       &#39;genres&#39; =&#62; [2, 4],
       &#39;format&#39;       =&#62; 2,
       &#39;isbn&#39;   =&#62; &#39;123-02345-0502-2&#39; ,
       &#39;publisher&#39; =&#62; &#39;EreWhon Publishing&#39;,
   };
   ok( $form-&#62;process( params =&#62; $good ), &#39;Good data&#39; );

   my $book = $form-&#62;item;
   END { $book-&#62;delete };
   ok ($book, &#39;get book object from form&#39;);
   my $num_genres = $book-&#62;genres-&#62;count;
   is( $num_genres, 2, &#39;multiple select list updated ok&#39;);
   is( $form-&#62;field(&#39;format&#39;)-&#62;value, 2, &#39;get value for format&#39; );

   my $bad_1 = {
       notitle =&#62; &#39;not req&#39;,
       silly_field   =&#62; 4,
   };
   ok( !$form-&#62;process( $bad_1 ), &#39;bad 1&#39; );

   my $bad_2 = {
       &#39;title&#39; =&#62; &#34;Another Silly Test Book&#34;,
       &#39;author&#39; =&#62; &#34;C. Foolish&#34;,
       &#39;year&#39; =&#62; &#39;1590&#39;,
       &#39;pages&#39; =&#62; &#39;too few&#39;,
       &#39;format&#39; =&#62; &#39;22&#39;,
   };
   ok( !$form-&#62;process( $bad_2 ), &#39;bad 2&#39;);
   ok( $form-&#62;field(&#39;year&#39;)-&#62;has_errors, &#39;year has error&#39; );
   ok( $form-&#62;field(&#39;pages&#39;)-&#62;has_errors, &#39;pages has error&#39; );
   ok( !$form-&#62;field(&#39;author&#39;)-&#62;has_errors, &#39;author has no error&#39; );
   ok( $form-&#62;field(&#39;format&#39;)-&#62;has_errors, &#39;format has error&#39; );

   my $good = {
      title =&#62; &#34;Another Silly Test Book&#34;,
      author =&#62; &#34;C. Foolish&#34;,
      year =&#62; 1999,
      pages =&#62; 101,
      format =&#62; 2
   };
   ok( $form-&#62;process($good), &#39;now form validates&#39; );

   done_testing;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>FormHandler Contributors - see HTML::FormHandler</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>This software is copyright (c) 2013 by Gerda Shank.</p>

<p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
