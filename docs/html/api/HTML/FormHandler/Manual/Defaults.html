<html><head><title>HTML::FormHandler::Manual::Defaults</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:18 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#Defaults'>Defaults</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Defaults_when_processing_params'>Defaults when processing params</a>
    <li class='indexItem indexItem2'><a href='#Query_parameters_for_defaults'>Query parameters for defaults</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>HTML::FormHandler::Manual::Defaults - form defaults documentation</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>version 0.40028</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p><a href="../../../HTML/FormHandler/Manual.html" class="podlinkpod"
>Manual Index</a></p>

<p>How to set defaults for your fields.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Defaults"
>Defaults</a></h1>

<p>Defaults for form fields come from a number of different places.
The simplest way to set a field&#39;s default is on the field definition:</p>

<pre>   has_field &#39;foo&#39; =&#62; ( type =&#62; &#39;Text&#39;, default =&#62; &#39;my_foo&#39; );
   has_field &#39;select_many&#39; =&#62; ( type =&#62; &#39;Multiple&#39;, default =&#62; [1, 2, 3] );</pre>

<p>You can also set the default for a field with a method in the form with the name &#39;default_&#60;field_name&#62;&#39;, where any periods in the field name are replaced with underscores.</p>

<pre>   has_field &#39;foo&#39;;
   sub default_foo { &#39;my_default&#39; }</pre>

<p>Like other field attributes, the &#39;default&#39; attribute can be modified on new with the &#39;field_list&#39; attribute, or on &#39;process&#39; with the &#39;update_field_list&#39; parameter (or the shorthand form &#39;defaults&#39;).</p>

<pre>   my $form =&#62; MyApp::Form-&#62;new( field_list =&#62; { &#39;+foo&#39; =&#62; { default =&#62; &#39;my_foo&#39; } } );
   $form-&#62;process( update_field_list =&#62; { foo =&#62; { default =&#62; &#39;my_foo&#39; } } );
   $form-&#62;process( defaults =&#62; { foo =&#62; &#39;my_foo&#39; }, params =&#62; $params );</pre>

<p>For forms where you pass in an &#39;item&#39; (usually a database row object), the values in that object will be used preferentially; if an accessor exists in the &#39;item&#39; object, then the defaults won&#39;t be used. (If an accessor doesn&#39;t exist, the defaults *will* be used.)</p>

<pre>   $form-&#62;process( item =&#62; $row, params =&#62; {} );</pre>

<p>For the above call the &#39;default&#39; on the field will not be used, which is usually what you want.</p>

<p>When creating a new database record with your form, if you don&#39;t pass in an empty row, then the field defaults will be used, or you can provide defaults in an &#39;init_object&#39;.</p>

<pre>   note: the form class has &#39;item_class&#39; set already.
   $form-&#62;process( schema =&#62; $schema, init_object =&#62; $obj ... );</pre>

<p>If you provide an empty row object for &#39;create&#39; type actions, however, you might want some defaults filled in. This can be done by filling the values into the row object or by turning on the form flag &#39;use_defaults_over_obj&#39;.</p>

<pre>   $form-&#62;process( item =&#62; $empty_row, use_defaults_over_obj =&#62; 1 );</pre>

<p>You could also pass in another object or hashref in the &#39;init_object&#39; attribute, and set the &#39;use_init_obj_over_item&#39; flag:</p>

<pre>   $form-&#62;process( item =&#62; $empty_row, init_object =&#62; $example,
                   use_init_obj_over_item =&#62; 1 );</pre>

<p>Note that the &#39;use_init_obj_over_item&#39; and &#39;use_defaults_over_obj&#39; flags are automatically cleared (if you&#39;re using persistent forms).</p>

<p>For forms where some defaults come from a database row, and some defaults come from some other dynamic source (so that putting them into the field definitions doesn&#39;t make sense), you can use the &#39;use_init_obj_when_no_accessor_in_item&#39; flag to provide two different sets of defaults, one set in the &#39;item&#39; (usually a db row) and one set in the init_obj. If the &#39;item&#39; is undefined, the values in the init_object are used.</p>

<pre>    in form: has &#39;+use_init_obj_when_no_accessor_in_item&#39; =&#62; ( default =&#62; 1 );
    $form-&#62;process( item =&#62; $item, init_object =&#62; { foo =&#62; &#39;...&#39; }, .. );</pre>

<p>There is a convenience method for setting &#39;defaults&#39; on a number of fields at once, the form&#39;s &#39;defaults&#39; attribute, which uses the same mechanism as &#39;update_field_list&#39; but only sets defaults. Note that this hashref is structured like the update_field_list with regard to field names, while the &#39;init_object&#39; uses &#34;structured&#34; data:</p>

<pre>   my $defaults = {
       model =&#62; &#39;standard&#39;,
       &#39;opts.color&#39; =&#62; &#39;Red&#39;,
       &#39;opts.size&#39;  =&#62; &#39;Big&#39;,
   };
   my $init_object =&#62; {
       model =&#62; &#39;standard&#39;,
       opts  =&#62; { color =&#62; &#39;Red&#39;, size =&#62; &#39;Big&#39; }
   };

   $form-&#62;process( defaults =&#62; $defaults, ... );
   $form-&#62;process( init_object =&#62; $init_object ... );</pre>

<p>In addition, the &#39;defaults&#39; actually changes the &#39;default&#39; stored in the field definitions, while the init_object does not.</p>

<p>There is also an alternative attribute in the fields, &#39;default_over_obj&#39;, but the new &#39;use_defaults_over_obj&#39; and &#39;use_init_obj_over_item&#39; flags, make it less necessary. Note that the &#39;default_over_obj&#39; attribute only provides a default if an item/init_object and accessor exists.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Defaults_when_processing_params"
>Defaults when processing params</a></h2>

<p>Normally when a form is posted, the params will contain all the values that are necessary to fill in the form. However, when a form is used in an API-like fashion, such as complex search forms, sometimes it is convenient to only provide particular params and let the others use defaults. However when the results are built from input, fields with no input are skipped unless the field has a value for &#39;input_without_param&#39;. There is an additional form-level flag, &#39;use_fields_for_input_without_param&#39; which will cause fields with no param entry to be built from the fields. This means that &#39;defaults&#39; on the field will be used to provide a value and an input for the field.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Query_parameters_for_defaults"
>Query parameters for defaults</a></h2>

<p>You can use either the &#39;defaults&#39; hashref or the &#39;init_object&#39; to provide query parameter &#39;defaults&#39;. They should not be provided in the &#39;params&#39; hash, because then FormHandler will assume that the form has been posted and attempt to validate, which you don&#39;t want to do until the form has been submitted. Or you can use the &#39;posted&#39; flag, to indicate whether or not to perform validation:</p>

<pre>    $form-&#62;process( posted =&#62; ( $c-&#62;req-&#62;method eq &#39;POST&#39; ), params =&#62; $c-&#62;req-&#62;params );</pre>

<p>Note that in Catalyst, there are &#39;query_parameters&#39; and &#39;body_parameters&#39;. The &#39;parameters&#39; contains both &#39;query_parameters&#39; and &#39;body_parameters&#39;.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>FormHandler Contributors - see HTML::FormHandler</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>This software is copyright (c) 2013 by Gerda Shank.</p>

<p>This is free software; you can redistribute it and/or modify it under the same terms as the Perl 5 programming language system itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
