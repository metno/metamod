<html><head><title>XML::PatAct::ToObjects</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:29 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#EXAMPLE'>EXAMPLE</a>
  <li class='indexItem indexItem1'><a href='#TODO'>TODO</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>XML::PatAct::ToObjects - An action module for creating Perl objects</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre> use XML::PatAct::ToObjects;

 my $patterns = [ PATTERN =&#62; [ OPTIONS ],
                  PATTERN =&#62; &#34;PERL-CODE&#34;,
                  ... ];

 my $matcher = XML::PatAct::ToObjects-&#62;new( Patterns =&#62; $patterns,
                                            Matcher =&#62; $matcher,
                                            CopyId =&#62; 1,
                                            CopyAttributes =&#62; 1 );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>XML::PatAct::ToObjects is a PerlSAX handler for applying pattern-action lists to XML parses or trees. XML::PatAct::ToObjects creates Perl objects of the types and contents of the action items you define.</p>

<p>New XML::PatAct::ToObject instances are creating by calling `new()&#39;. Parameters can be passed as a list of key, value pairs or a hash. `new()&#39; requires the Patterns and Matcher parameters, the rest are optional:</p>

<dl>
<dt><a name="Patterns"
>Patterns</a></dt>

<dd>
<p>The pattern-action list to apply.</p>

<dt><a name="Matcher"
>Matcher</a></dt>

<dd>
<p>An instance of the pattern or query matching module.</p>

<dt><a name="CopyId"
>CopyId</a></dt>

<dd>
<p>Causes the `ID&#39; attribute, if any, in a source XML element to be copied to an `ID&#39; attribute in newly created objects. Note that IDs may be lost of no pattern matches that element or an object is not created (<code>-make</code>) for that element.</p>

<dt><a name="CopyAttributes"
>CopyAttributes</a></dt>

<dd>
<p>Causes all attributes of the element to be copied to the newly created objects.</p>
</dd>
</dl>

<p>Each action can either be a list of options defined below or a string containing a fragment of Perl code. If the action is a string of Perl code then simple then some simple substitutions are made as described further below.</p>

<p>Options that can be used in an action item containing an option-list:</p>

<dl>
<dt><a name="-holder"
><b>-holder</b></a></dt>

<dd>
<p>Ignore this element, but continue processing it&#39;s children (compare to <b>-ignore</b>). <code>-pcdata</code> may be used with this option.</p>

<dt><a name="-ignore"
><b>-ignore</b></a></dt>

<dd>
<p>Ignore (discard) this element and it&#39;s children (compare to <b>-holder</b>).</p>

<dt><a name="-pcdata"
><b>-pcdata</b></a></dt>

<dd>
<p>Character data in this element should be copied to the <code>Contents</code> field.</p>

<dt><a name="-make_PACKAGE"
><b>-make</b> <i>PACKAGE</i></a></dt>

<dd>
<p>Create an object blessed into <i>PACKAGE</i>, and continue processing this element and it&#39;s children. <i>PACKAGE</i> may be the type `<code>HASH</code>&#39; to simply create an anonyous hash.</p>

<dt><a name="-args_ARGUMENTS"
><b>-args</b> <i>ARGUMENTS</i></a></dt>

<dd>
<p>Use <i>ARGUMENTS</i> in creating the object specified by <b>-make</b>. This is commonly used to copy element attributes into fields in the newly created object. For example:</p>

<pre>  -make =&#62; &#39;HASH&#39;, -args =&#62; &#39;URL =&#62; %{href}&#39;</pre>

<p>would copy the `<code>href</code>&#39; attribute in an element to the `<code>URL</code>&#39; field of the newly created hash.</p>

<dt><a name="-field_FIELD"
><b>-field</b> <i>FIELD</i></a></dt>

<dd>
<p>Store this element, object, or children of this element in the parent object&#39;s field named by <i>FIELD</i>.</p>

<dt><a name="-push-field_FIELD"
><b>-push-field</b> <i>FIELD</i></a></dt>

<dd>
<p>Similar to <b>-field</b>, except that <i>FIELD</i> is an array and the contents are pushed onto that array.</p>

<dt><a name="-value_VALUE"
><b>-value</b> <i>VALUE</i></a></dt>

<dd>
<p>Use <i>VALUE</i> as a literal value to store in <i>FIELD</i>, otherwise ignoring this element and it&#39;s children. Only valid with <b>-field</b> or <b>-push-field</b>. `<code>%{<i>ATTRIBUTE</i>}</code>&#39; notation can be used to substitute the value of an attribute into the literal value.</p>

<dt><a name="-as-string"
><b>-as-string</b></a></dt>

<dd>
<p>Convert the contents of this element to a string (as in <code>XML::Grove::AsString</code>) and store in <i>FIELD</i>. Only valid with <b>-field</b> or <b>-push-field</b>.</p>

<dt><a name="-grove"
><b>-grove</b></a></dt>

<dd>
<p>Copy this element to <i>FIELD</i> without further processing. The element can then be processed later as the Perl objects are manipulated. Only valid with <b>-field</b> or <b>-push-field</b>. If ToObjects is used with PerlSAX, this will use XML::Grove::Builder to build the grove element.</p>

<dt><a name="-grove-contents"
><b>-grove-contents</b></a></dt>

<dd>
<p>Used with <b>-make</b>, <b>-grove-contents</b> creates an object but then takes all of the content of that element and stores it in Contents.</p>
</dd>
</dl>

<p>If an action item is a string, that string is treated as a fragment of Perl code. The following simple substitutions are performed on the fragment to provide easy access to the information being converted:</p>

<dl>
<dt><a name="@ELEM@"
><b>@ELEM@</b></a></dt>

<dd>
<p>The object that caused this action to be called. If ToObjects is used with PerlSAX this will be a hash with the element name and attributes, with XML::Grove this will be the element object, with Data::Grove it will be the matching object, and with XML::DOM it will be an XML::DOM::Element.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLE"
>EXAMPLE</a></h1>

<p>The example pattern-action list below will convert the following XML representing a Database schema:</p>

<pre>    &#60;schema&#62;
      &#60;table&#62;
        &#60;name&#62;MyTable&#60;/name&#62;
        &#60;summary&#62;A short summary&#60;/summary&#62;
        &#60;description&#62;A long description that may
          contain a subset of HTML&#60;/description&#62;
        &#60;column&#62;
          &#60;name&#62;MyColumn1&#60;/name&#62;
          &#60;summary&#62;A short summary&#60;/summary&#62;
          &#60;description&#62;A long description&#60;/description&#62;
          &#60;unique/&#62;
          &#60;non-null/&#62;
          &#60;default&#62;42&#60;/default&#62;
        &#60;/column&#62;
      &#60;/table&#62;
    &#60;/schema&#62;</pre>

<p>into Perl objects looking like:</p>

<pre>    [
      { Name =&#62; &#34;MyTable&#34;,
        Summary =&#62; &#34;A short summary&#34;,
        Description =&#62; $grove_object,
        Columns =&#62; [
          { Name =&#62; &#34;MyColumn1&#34;,
            Summary =&#62; &#34;A short summary&#34;,
            Description =&#62; $grove_object,
            Unique =&#62; 1,
            NonNull =&#62; 1,
            Default =&#62; 42
          }
        ]
      }
    ]</pre>

<p>Here is a Perl script and pattern-action list that will perform the conversion using the simple name matching pattern module XML::PatAct::MatchName. The script accepts a Schema XML file as an argument (<code>$ARGV[0]</code>) to the script. This script creates a grove as one of it&#39;s objects, so it requires the XML::Grove module.</p>

<pre>    use XML::Parser::PerlSAX;
    use XML::PatAct::MatchName;
    use XML::PatAct::ToObjects;

    my $patterns = [
      &#39;schema&#39;      =&#62; [ qw{ -holder                                  } ],
      &#39;table&#39;       =&#62; [ qw{ -make Schema::Table                      } ],
      &#39;name&#39;        =&#62; [ qw{ -field Name -as-string                   } ],
      &#39;summary&#39;     =&#62; [ qw{ -field Summary -as-string                } ],
      &#39;description&#39; =&#62; [ qw{ -field Description -grove                } ],
      &#39;column&#39;      =&#62; [ qw{ -make Schema::Column -push-field Columns } ],
      &#39;unique&#39;      =&#62; [ qw{ -field Unique -value 1                   } ],
      &#39;non-null&#39;    =&#62; [ qw{ -field NonNull -value 1                  } ],
      &#39;default&#39;     =&#62; [ qw{ -field Default -as-string                } ],
    ];

    my $matcher = XML::PatAct::MatchName-&#62;new( Patterns =&#62; $patterns );
    my $handler = XML::PatAct::ToObjects-&#62;new( Patterns =&#62; $patterns,
                                               Matcher =&#62; $matcher);

    my $parser = XML::Parser::PerlSAX-&#62;new( Handler =&#62; $handler );
    my $schema = $parser-&#62;parse(Source =&#62; { SystemId =&#62; $ARGV[0] } );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TODO"
>TODO</a></h1>

<ul>
<li>It&#39;d be nice if patterns could be applied even in <b>-as-string</b> and <b>-grove</b>.</li>

<li>Implement Perl code actions.</li>

<li><b>-as-xml</b> to write XML into the field.</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Ken MacLeod, ken@bitsko.slc.ut.us</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>perl(1), Data::Grove(3)</p>

<p>``Using PatAct Modules&#39;&#39; and ``Creating PatAct Modules&#39;&#39; in libxml-perl.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
