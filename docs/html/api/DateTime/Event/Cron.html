<html><head><title>DateTime::Event::Cron</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:04 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#DateTime%3A%3ASet_Factories'>DateTime::Set Factories</a>
    <li class='indexItem indexItem2'><a href='#Constructors'>Constructors</a>
    <li class='indexItem indexItem2'><a href='#Other_methods'>Other methods</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DateTime::Event::Cron - DateTime extension for generating recurrence sets from crontab lines and files.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use DateTime::Event::Cron;

  # check if a date matches (defaults to current time)
  my $c = DateTime::Event::Cron-&#62;new(&#39;* 2 * * *&#39;);
  if ($c-&#62;match) {
    # do stuff
  }
  if ($c-&#62;match($date)) {
    # do something else for datetime $date
  }

  # DateTime::Set construction from crontab line
  $crontab = &#39;*/3 15 1-10 3,4,5 */2&#39;;
  $set = DateTime::Event::Cron-&#62;from_cron($crontab);
  $iter = $set-&#62;iterator(after =&#62; DateTime-&#62;now);
  while (1) {
    my $next = $iter-&#62;next;
    my $now  = DateTime-&#62;now;
    sleep(($next-&#62;subtract_datetime_absolute($now))-&#62;seconds);
    # do stuff...
  }

  # List of DateTime::Set objects from crontab file
  @sets = DateTime::Event::Cron-&#62;from_crontab(file =&#62; &#39;/etc/crontab&#39;);
  $now = DateTime-&#62;now;
  print &#34;Now: &#34;, $now-&#62;datetime, &#34;\n&#34;;
  foreach (@sets) {
    my $next = $_-&#62;next($now);
    print $next-&#62;datetime, &#34;\n&#34;;
  }

  # DateTime::Set parameters
  $crontab = &#39;* * * * *&#39;;

  $now = DateTime-&#62;now;
  %set_parms = ( after =&#62; $now );
  $set = DateTime::Event::Cron-&#62;from_cron(cron =&#62; $crontab, %set_parms);
  $dt = $set-&#62;next;
  print &#34;Now: &#34;, $now-&#62;datetime, &#34; and next: &#34;, $dt-&#62;datetime, &#34;\n&#34;;

  # Spans for DateTime::Set
  $crontab = &#39;* * * * *&#39;;
  $now = DateTime-&#62;now;
  $now2 = $now-&#62;clone;
  $span = DateTime::Span-&#62;from_datetimes(
            start =&#62; $now-&#62;add(minutes =&#62; 1),
            end   =&#62; $now2-&#62;add(hours =&#62; 1),
          );
  %parms = (cron =&#62; $crontab, span =&#62; $span);
  $set = DateTime::Event::Cron-&#62;from_cron(%parms);
  # ...do things with the DateTime::Set

  # Every RTFCT relative to 12am Jan 1st this year
  $crontab = &#39;7-10 6,12-15 10-28/2 */3 3,4,5&#39;;
  $date = DateTime-&#62;now-&#62;truncate(to =&#62; &#39;year&#39;);
  $set = DateTime::Event::Cron-&#62;from_cron(cron =&#62; $crontab, after =&#62; $date);

  # Rather than generating DateTime::Set objects, next/prev
  # calculations can be made directly:

  # Every day at 10am, 2pm, and 6pm. Reference date
  # defaults to DateTime-&#62;now.
  $crontab = &#39;10,14,18 * * * *&#39;;
  $dtc = DateTime::Event::Cron-&#62;new_from_cron(cron =&#62; $crontab);
  $next_datetime = $dtc-&#62;next;
  $last_datetime = $dtc-&#62;previous;
  ...

  # List of DateTime::Event::Cron objects from
  # crontab file
  @dtc = DateTime::Event::Cron-&#62;new_from_crontab(file =&#62; &#39;/etc/crontab&#39;);

  # Full cron lines with user, such as from /etc/crontab
  # or files in /etc/cron.d, are supported and auto-detected:
  $crontab = &#39;* * * * * gump /bin/date&#39;;
  $dtc = DateTime::Event::Cron-&#62;new(cron =&#62; $crontab);

  # Auto-detection of users is disabled if you explicitly
  # enable/disable via the user_mode parameter:
  $dtc = DateTime::Event::Cron-&#62;new(cron =&#62; $crontab, user_mode =&#62; 1);
  my $user = $dtc-&#62;user;
  my $command = $dtc-&#62;command;

  # Unparsed original cron entry
  my $original = $dtc-&#62;original;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>DateTime::Event::Cron generated DateTime events or DateTime::Set objects based on crontab-style entries.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<p>The cron fields are typical crontab-style entries. For more information, see <a href="http://man.he.net/man5/crontab" class="podlinkman"
>crontab(5)</a> and extensions described in <a href="../../Set/Crontab.html" class="podlinkpod"
>Set::Crontab</a>. The fields can be passed as a single string or as a reference to an array containing each field. Only the first five fields are retained.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DateTime::Set_Factories"
>DateTime::Set Factories</a></h2>

<p>See <a href="../../DateTime/Set.html" class="podlinkpod"
>DateTime::Set</a> for methods provided by Set objects, such as <code>next()</code> and <code>previous()</code>.</p>

<dl>
<dt><a name="from_cron($cronline)"
>from_cron($cronline)</a></dt>

<dd>
<dt><a name="from_cron(cron_=&#62;_$cronline,_%parms,_%set_parms)"
>from_cron(cron =&#62; $cronline, %parms, %set_parms)</a></dt>

<dd>
<p>Generates a DateTime::Set recurrence for the cron line provided. See new() for details on %parms. Optionally takes parameters for DateTime::Set.</p>

<dt><a name="from_crontab(file_=&#62;_$crontab_fh,_%parms,_%set_parms)"
>from_crontab(file =&#62; $crontab_fh, %parms, %set_parms)</a></dt>

<dd>
<p>Returns a list of DateTime::Set recurrences based on lines from a crontab file. <code>$crontab_fh</code> can be either a filename or filehandle reference. See new() for details on %parm. Optionally takes parameters for DateTime::Set which will be passed along to each set for each line.</p>

<dt><a name="as_set(%set_parms)"
>as_set(%set_parms)</a></dt>

<dd>
<p>Generates a DateTime::Set recurrence from an existing DateTime::Event::Cron object.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Constructors"
>Constructors</a></h2>

<dl>
<dt><a name="new_from_cron(cron_=&#62;_$cronstring,_%parms)"
>new_from_cron(cron =&#62; $cronstring, %parms)</a></dt>

<dd>
<p>Returns a DateTime::Event::Cron object based on the cron specification. Optional parameters include the boolean &#39;user_mode&#39; which indicates that the crontab entry includes a username column before the command.</p>

<dt><a name="new_from_crontab(file_=&#62;_$fh,_%parms)"
>new_from_crontab(file =&#62; $fh, %parms)</a></dt>

<dd>
<p>Returns a list of DateTime::Event::Cron objects based on the lines of a crontab file. <code>$fh</code> can be either a filename or a filehandle reference. Optional parameters include the boolean &#39;user_mode&#39; as mentioned above.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Other_methods"
>Other methods</a></h2>

<dl>
<dt><a name="next()"
>next()</a></dt>

<dd>
<dt><a name="next($date)"
>next($date)</a></dt>

<dd>
<p>Returns the next valid datetime according to the cron specification. <code>$date</code> defaults to DateTime-&#62;now unless provided.</p>

<dt><a name="previous()"
>previous()</a></dt>

<dd>
<dt><a name="previous($date)"
>previous($date)</a></dt>

<dd>
<p>Returns the previous valid datetime according to the cron specification. <code>$date</code> defaults to DateTime-&#62;now unless provided.</p>

<dt><a name="increment($date)"
>increment($date)</a></dt>

<dd>
<dt><a name="decrement($date)"
>decrement($date)</a></dt>

<dd>
<p>Same as <code>next()</code> and <code>previous()</code> except that the provided datetime is modified to the new datetime.</p>

<dt><a name="match($date)"
>match($date)</a></dt>

<dd>
<p>Returns whether or not the given datetime (defaults to current time) matches the current cron specification. Dates are truncated to minute resolution.</p>

<dt><a name="valid($date)"
>valid($date)</a></dt>

<dd>
<p>A more strict version of match(). Returns whether the given datetime is valid under the current cron specification. Cron dates are only accurate to the minute -- datetimes with seconds greater than 0 are invalid by default. (note: never fear, all methods accepting dates will accept invalid dates -- they will simply be rounded to the next nearest valid date in all cases except this particular method)</p>

<dt><a name="command()"
>command()</a></dt>

<dd>
<p>Returns the command string, if any, from the original crontab entry. Currently no expansion is performed such as resolving environment variables, etc.</p>

<dt><a name="user()"
>user()</a></dt>

<dd>
<p>Returns the username under which this cron command was to be executed, assuming such a field was present in the original cron entry.</p>

<dt><a name="original()"
>original()</a></dt>

<dd>
<p>Returns the original, unparsed cron string including any user or command fields.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Matthew P. Sisk &#60;sisk@mojotoad.com&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2003 Matthew P. Sisk. All rights reserved. All wrongs revenged. This program is free software; you can distribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>DateTime(3), DateTime::Set(3), DateTime::Event::Recurrence(3), DateTime::Event::ICal(3), DateTime::Span(3), Set::Crontab(3), crontab(5)</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
