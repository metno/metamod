<html><head><title>Metamod::Utils</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Fri Apr  4 12:00:05 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#human_readable_size(%24size)'>human_readable_size($size)</a>
    <li class='indexItem indexItem2'><a href='#random_string(%24length%2C_%24character_list)'>random_string($length, $character_list)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="human_readable_size($size)"
>human_readable_size($size)</a></h2>

<p>Convert a number of bytes to a more human readable format.</p>

<dl>
<dt><a name="$size"
>$size</a></dt>

<dd>
<p>The number of bytes in a file or similar</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>A text string in a format that is more readable than mere byte size.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="random_string($length,_$character_list)"
>random_string($length,
$character_list)</a></h2>

<p>Generate a random string.</p>

<dl>
<dt><a name="$length_(optional,_default=8)"
>$length (optional,
default=8)</a></dt>

<dd>
<p>The totalt length of the generated string.</p>

<dt><a name="@character_list_(optional,_default_=_(a...z,0...9)_)"
>@character_list (optional,
default = (a...z,0...9) )</a></dt>

<dd>
<p>The list to draw characters from.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>A random string of the specified length.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Metamod::Utils - utilities for metamod</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use Metamod::Utils qw(findFiles isNetcdf trim);

  daemonize(&#39;/var/log/logfile&#39;,&#39;/var/pid/pidfile&#39;);

  my @files = findFiles(&#39;/tmp&#39;);
  my @numberFiles = findFiles(&#39;/tmp&#39;, sub {$_[0] =~ m/^\d/});

  # precompile pattern with variables
  foreach my $var (qw(.x .y .z)) {
         my @files = findFiles(&#39;/tmp&#39;, eval &#39;sub{$_[0] =~ m/$var$/o}&#39;);
         print scalar @files , &#34; files ending with $var\n&#34;;
  }

  if (isNetcdf(&#34;file.nc&#34;)) {
         # ... do something with a nc file
  }

  my $trimmed = trim(&#34;  string  &#34;); # $trimmed = &#34;string&#34;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This modules is a collection of small functions useful when working with Metamod.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<dl>
<dt><a name="findFiles($dir,_[@callbacks]])"
>findFiles($dir, [@callbacks]])</a></dt>

<dd>
<p>Return all files in the directory. The each callback-function will be called with the filename as $_[0] parameter. All callbacks need to return true for the file. The callbacks have in addition access to the following variables: $File::Find::name and $File::Find::dir. In addition the perl-special _ filehandle is set due to a previously checked -f. See stat or -X in <a href="../perlfunc.html" class="podlinkpod"
>perlfunc</a>.</p>

<p>An example follows:</p>

<pre>  my %files;
  foreach my $appendix (qw(.xml .xmd)) {
     $files{$appendix} = findFiles(&#39;/dir&#39;,
                                   sub {$_[0] =~ /$appendix$/o},
                                   sub {-x _});
  }</pre>

<p>The o flag of the pattern will make sure, that the pattern is only compiled once for each time the sub is compiled (that is twice), instead of for each file. Only executables will be selected.</p>

<dt><a name="isNetcdf($file)"
>isNetcdf($file)</a></dt>

<dd>
<p>Checks if a file is a netcdf file by checking the first 3 bytes (magic-key) of the file to be CDF. It will die if the file is not readable.</p>

<dt><a name="getFiletype($file)"
>getFiletype($file)</a></dt>

<dd>
<p>get the filetype of a file. Supported files are: nc3, gzip, gzip-compressed, bzip2, pkzip, ascii and tar</p>

<p>ascii detection works with perls -T option tar detection uses file-extension only for pre-POSIX tar (normally the case)</p>

<dt><a name="remove_cr_from_file($file)"
>remove_cr_from_file($file)</a></dt>

<dd>
<p>remove \r from a file returns error message on error, 0 on succes because it emulates a shell-script</p>

<dt><a name="trim($str)"
>trim($str)</a></dt>

<dd>
<p>Remove leading and trailing strings. Return string. Does not change inline.</p>

<dt><a name="daemonize($logFile,_$pidFile)"
>daemonize($logFile, $pidFile)</a></dt>

<dd>
<p>Make the current process a daemon. Log all STDOUT and STDERR to $logFile, write the generated pid to $pidFile.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Heiko Klein, &#60;H.Klein@met.no&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../File/Find.html" class="podlinkpod"
>File::Find</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
