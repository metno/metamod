<html><head><title>Metamod::ForeignDataset</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.30,
  using Pod::Simple::PullParser v3.30,
  under Perl v5.014002 at Mon Jun  1 13:07:51 2015 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#newFromDoc(%24metaXML%2C_%5B%24xmdXML%2C_%25options%5D)'>newFromDoc($metaXML, [$xmdXML, %options])</a>
    <li class='indexItem indexItem2'><a href='#newFromFile(%24basename)'>newFromFile($basename)</a>
    <li class='indexItem indexItem2'><a href='#newFromFileAutocomplete(%24basename)'>newFromFileAutocomplete($basename)</a>
    <li class='indexItem indexItem2'><a href='#writeToFile(%24basename)'>writeToFile($basename)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3E_writeToFileHelper(%24fileBase)'>$self-&#62;_writeToFileHelper($fileBase)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3E_writeToDatabase(%24filename)'>$self-&#62;_writeToDatabase($filename)</a>
    <li class='indexItem indexItem2'><a href='#deleteDatasetFile(%24basename)'>deleteDatasetFile($basename)</a>
    <li class='indexItem indexItem2'><a href='#getXMD_XML'>getXMD_XML</a>
    <li class='indexItem indexItem2'><a href='#getMETA_XML'>getMETA_XML</a>
    <li class='indexItem indexItem2'><a href='#getXMD_DOC'>getXMD_DOC</a>
    <li class='indexItem indexItem2'><a href='#getMETA_DOC'>getMETA_DOC</a>
    <li class='indexItem indexItem2'><a href='#getInfo()'>getInfo()</a>
    <li class='indexItem indexItem2'><a href='#setInfo(%5C%25info)'>setInfo(\%info)</a>
    <li class='indexItem indexItem2'><a href='#replaceInfo(%5C%25info)'>replaceInfo(\%info)</a>
    <li class='indexItem indexItem2'><a href='#getParentName'>getParentName</a>
    <li class='indexItem indexItem2'><a href='#originalFormat()'>originalFormat()</a>
    <li class='indexItem indexItem2'><a href='#getQuadtree()'>getQuadtree()</a>
    <li class='indexItem indexItem2'><a href='#setQuadtree(%5C%40quadtree_nodes)'>setQuadtree(\@quadtree_nodes)</a>
    <li class='indexItem indexItem2'><a href='#getWMSInfo()'>getWMSInfo()</a>
    <li class='indexItem indexItem2'><a href='#setWMSInfo(%24wmsInfo)'>setWMSInfo($wmsInfo)</a>
    <li class='indexItem indexItem2'><a href='#getProjectionInfo()'>getProjectionInfo()</a>
    <li class='indexItem indexItem2'><a href='#setProjectionInfo(%24projectionInfo)'>setProjectionInfo($projectionInfo)</a>
    <li class='indexItem indexItem2'><a href='#getDatasetRegion()'>getDatasetRegion()</a>
    <li class='indexItem indexItem2'><a href='#deleteDatasetRegion()'>deleteDatasetRegion()</a>
    <li class='indexItem indexItem2'><a href='#setDatasetRegion(%24region)'>setDatasetRegion($region)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#POD_ERRORS'>POD ERRORS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Metamod::ForeignDataset - working with Metamod datasets without known Metadata</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use Metamod::ForeignDataset;

  # create a new dataset/mm2
  $ds = new Metamod::ForeignDataset(&#39;&#60;DIF&#62;&#60;/DIF&#62;&#39;);
  %info = (&#39;name&#39; =&#62; &#39;NEW/Name&#39;,
              &#39;ownertag&#39; =&#62; &#39;DAM&#39;);
  $ds-&#62;setInfo(\%info);

  # read an existing dataset from $basename.xml and $basename.xmd
  $ds = newFromFile Metamod::ForeignDataset($basename);
  %info = $ds-&#62;getInfo;
  @quadtreeNodes = $ds-&#62;getQuadtree;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The Metamod::ForeignDataset package give a convenient way to work with the xml-files describing default datasets consisting of meta-metadata (dataset.xmd files) and metadata (file.xml) files or strings. The metadata-file is not modified, except for content-invariant changes through the xml-parser/writer.</p>

<p>XML::LibXML requires properly encoded utf-8 strings as input, with perl utf8-flag switched on. Please make sure to provide such data by:</p>

<dl>
<dt><a name="use_Encode;_and_decode_all_data_with_decode(&#39;charset&#39;,_$string);"
>use Encode; and decode all data with decode(&#39;charset&#39;, $string);</a></dt>

<dd>
<dt><a name="use_encoding_&#39;utf-8&#39;;_To_set_non-binary_input-files_annd_all_literals_(&#39;name&#39;)_to_utf8"
>use encoding &#39;utf-8&#39;; To set non-binary input-files annd all literals (&#39;name&#39;) to utf8</a></dt>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<blockquote>
<p>removeUndefinedXMLCharacters($str)</p>

<p>Remove all undefined xml characters as defined in http://www.w3.org/TR/REC-xml/#dt-character from the string.</p>

<p>Return: clean string in scalar context</p>
</blockquote>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<p>These methods need to be implemented by the extending modules.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="newFromDoc($metaXML,_[$xmdXML,_%options])"
>newFromDoc($metaXML, [$xmdXML, %options])</a></h2>

<p>Create a dataset from <a href="../XML/LibXML/Document.html" class="podlinkpod"
>XML::LibXML::Document</a> or xml-string. The foreign-(metadata) document needs to be set. If $xmdXML is empty, new dataset information will be created. In that case the creationDate-info will be set to currentDate, status-info is active, everything else is empty.</p>

<p>Currently known options: &#39;format&#39;, this will set the originalFormat of the dataset.</p>

<p>Return: $xmdXML object Dies on missing $metaXML, or on invalid xml-strings.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="newFromFile($basename)"
>newFromFile($basename)</a></h2>

<p>read a dataset from a file. The file may or may not end with .xml or .xmd. The xml-file needs to exist. The xml file is mapped to foreign and the xmd file is mapped to $xmdXML. See <a href="../newFromDoc.html" class="podlinkpod"
>newFromDoc</a> for more information.</p>

<p>Return: $xmdXML object Dies on missing xml-file, or on invalid xml-strings in xml or xmd files.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="newFromFileAutocomplete($basename)"
>newFromFileAutocomplete($basename)</a></h2>

<p>Read a dataset from a file. If only a .xml file is given without .xml file, try to autdetect the DatasetTransformer plugin and let it generate the xmd information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="writeToFile($basename)"
>writeToFile($basename)</a></h2>

<p>write the current content to $basename.xml and $basename.xmd (appendixes will be truncated). This will overwrite an existing file! Dies on error.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;_writeToFileHelper($fileBase)"
>$self-&#62;_writeToFileHelper($fileBase)</a></h2>

<p>Writes the dataset information to .xml and .xmd files.</p>

<p><b>IMPLEMTATION NOTE:</b> This has been separated as its own function to facilitate unit testing of writing to file without involving the database.</p>

<dl>
<dt><a name="$fileBase"
>$fileBase</a></dt>

<dd>
<p>The base filename</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns 1 on success. Throws and exception on failure.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;_writeToDatabase($filename)"
>$self-&#62;_writeToDatabase($filename)</a></h2>

<p>Write the information in the dataset to the metabase database.</p>

<dl>
<dt><a name="$filename"
>$filename</a></dt>

<dd>
<p>The filename for this dataset.</p>

<dt><a name="return"
>return</a></dt>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="deleteDatasetFile($basename)"
>deleteDatasetFile($basename)</a></h2>

<p>delete the files belonging to the dataset $basename (.xml and .xmd). Return false on failure, true on success. This is a class rather than a object-method.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getXMD_XML"
>getXMD_XML</a></h2>

<p>Return: xml-string of xmd-file as byte stream</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getMETA_XML"
>getMETA_XML</a></h2>

<p>Return: xml-string of MM2 as byte stream in the original document encoding</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getXMD_DOC"
>getXMD_DOC</a></h2>

<p>Get a clone of the internal xmd document.</p>

<p>Return: XML::LibXML::Document of dataset</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getMETA_DOC"
>getMETA_DOC</a></h2>

<p>Get a clone of the internal metadata document.</p>

<p>Return: XML::LibXML::Document of the metadata</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getInfo()"
>getInfo()</a></h2>

<p>read the info attributes (name, ownertag, status, metadataFormat, creationDate, datestamp) from the dataset</p>

<p>Return: %info</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setInfo(\%info)"
>setInfo(\%info)</a></h2>

<p>add or overwrite info attributes to the dataset</p>

<p>Return: undef</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="replaceInfo(\%info)"
>replaceInfo(\%info)</a></h2>

<p>replace all info attributes with those in %info. This will remove all attributes not in %info.</p>

<p>Return: undef</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getParentName"
>getParentName</a></h2>

<p>The dataset-name can consist on 2 or 3 parts: project/parentname/filename or project/filename In the first case, this method will return project/parentname in the second case undef.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="originalFormat()"
>originalFormat()</a></h2>

<p>Return: string describing the original format as defined through &#39;newFromFile&#39; or &#39;newFromDoc&#39;. This does not describe the originalFormat field in the info region of the .xmd file.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getQuadtree()"
>getQuadtree()</a></h2>

<p>Return: array with quadtree_nodes</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setQuadtree(\@quadtree_nodes)"
>setQuadtree(\@quadtree_nodes)</a></h2>

<p>set the @quadtree_nodes as dataset-quadtree-nodes</p>

<p>Return: @oldQuadtree_nodes</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getWMSInfo()"
>getWMSInfo()</a></h2>

<p>Return: raw-xml content of the WMSInfo node</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setWMSInfo($wmsInfo)"
>setWMSInfo($wmsInfo)</a></h2>

<p>set/replace the raw-xml WMSInfo node.</p>

<p>Return: old WMSInfo</p>

<p>Throws: Exception if $wmsInfo is not valid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getProjectionInfo()"
>getProjectionInfo()</a></h2>

<p>Return: raw content of the ProjectionInfo node</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setProjectionInfo($projectionInfo)"
>setProjectionInfo($projectionInfo)</a></h2>

<p>set/replace the raw ProjectionInfo node</p>

<p>Return: old ProjectionInfo</p>

<p>Throws: Exception if $projectionInfo is not valid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getDatasetRegion()"
>getDatasetRegion()</a></h2>

<p>Return: a Metamod::DatasetRegion</p>

<p>Warning: this is a copy of the region, when changing, a call to setDatasetRegion is required</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="deleteDatasetRegion()"
>deleteDatasetRegion()</a></h2>

<p>Return: the old region</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setDatasetRegion($region)"
>setDatasetRegion($region)</a></h2>

<p>set the Metamod::DatasetRegion to a new region.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="POD_ERRORS"
>POD ERRORS</a></h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>
<dt><a name="Around_line_110:"
>Around line 110:</a></dt>

<dd>
<p>You can&#39;t have =items (as at line 120) unless the first thing after the =over is an =item</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
