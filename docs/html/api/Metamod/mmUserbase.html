<html><head><title>Metamod::mmUserbase</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.30,
  using Pod::Simple::PullParser v3.30,
  under Perl v5.014002 at Mon Jun  1 13:07:51 2015 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#POD_ERRORS'>POD ERRORS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Metamod::mmUserbase - Perl API against the METAMOD User Database</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre> # Initialize an mmUserbase object and create a new user,
 # illustrating error handling:
 my $userbase = Metamod::mmUserbase-&#62;new();
 unless ($userbase-&#62;user_create(&#39;email_address&#39;,&#39;DIRKEY&#39;)) {
     if ($userbase-&#62;exception_is_error()) {
         print &#39;   ERROR:   &#39; . $userbase-&#62;get_exception() . &#34;\n&#34;;
     } else {
         print &#39;   INFO:   &#39; . $userbase-&#62;get_exception() . &#34;\n&#34;;
     }
 }
 $userbase-&#62;close();

 # Find an existing user:
 $userbase-&#62;user_find(&#39;email_address&#39;,&#39;DIRKEY&#39;);

 # Loop through all users:
 $userbase-&#62;user_first();
 do {
     my $name = $userbase-&#62;user_get(&#39;u_name&#39;);
     $userbase-&#62;user_put(&#39;u_name&#39;,&#39;Some Other Name&#39;);
 } until (! $userbase-&#62;user_next());

 # Many more possibilities. See the METHODS paragraph.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>API for accessing and updating the METAMOD User database. The database contains information about users, datasets and files. A user owns one or more dataset, and a dataset owns one or more file. The database also contain information that are connected to both dataset and user, but not neccessarily the user that owns the dataset (the infoUDS table).</p>

<p>The database will contain a complete inventory of the datasets that are also found in the Metadata database (and the XML files that are sources for the Metadata database). The Files table in the User database will not be complete. It is only intended for users to look at the status of recently uploaded files.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<dl>
<dt><a name="get_exception()"
>get_exception()</a></dt>

<dd>
<p>Return value: A text string explaining the last exception encountered.</p>

<dt><a name="exception_is_error()"
>exception_is_error()</a></dt>

<dd>
<p>Return value: TRUE if last exception was an error (and not just an info like &#34;no more users&#34;). Othervise FALSE.</p>

<dt><a name="close()"
>close()</a></dt>

<dd>
<p>Submit any pending changes to the database, then disconnect the database handle. Return value: TRUE on success, FALSE on error.</p>

<dt><a name="revert()"
>revert()</a></dt>

<dd>
<p>Revert any changes to the database made by this Userbase object. Disconnect the database handle. Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_find($email_address,$application_id)"
>user_find($email_address,$application_id)</a></dt>

<dd>
<p>Search for an existing user in the database and make him/her the current user.</p>

<p>IN: User E-mail address, application id (a_id).</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_lfind($login_name,$application_id)"
>user_lfind($login_name,$application_id)</a></dt>

<dd>
<p>Search for an existing user in the database and make him/her the current user.</p>

<p>IN: User login name, application id (a_id).</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_create(email_address,application_id)"
>user_create(email_address,application_id)</a></dt>

<dd>
<p>IN: User E-mail address, application id (a_id).</p>

<p>Create a new user and make it the current user. Initially, the value of the mandatory U_loginname field will be set to the E-mail address, but this can be changed using the user_put method.</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_put($property,$value)"
>user_put($property,$value)</a></dt>

<dd>
<p>Set user properties for the current user.</p>

<p>IN: Property name (one of &#39;u_name&#39;, &#39;u_password&#39;, &#39;u_institution&#39;, &#39;u_telephone&#39;, &#39;u_session&#39;), property value</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_get($property)"
>user_get($property)</a></dt>

<dd>
<p>Get user properties for the current user.</p>

<p>IN: Property name (one of &#39;u_id&#39;, &#39;u_email&#39;, &#39;a_id&#39; &#39;u_name&#39;, &#39;u_password&#39;, &#39;u_loginname&#39;, &#39;u_institution&#39;, &#39;u_telephone&#39;, &#39;u_session&#39;)</p>

<p>Return value: Property value on success, FALSE on error.</p>

<dt><a name="user_first()"
>user_first()</a></dt>

<dd>
<p>Make the first user in the database the current user.</p>

<p>Return value: TRUE on success, FALSE on error / no user in database.</p>

<dt><a name="user_next()"
>user_next()</a></dt>

<dd>
<p>Make the next user in the database the current one.</p>

<p>Return value: TRUE on success, FALSE on error / already last user.</p>

<dt><a name="user_isync()"
>user_isync()</a></dt>

<dd>
<p>Make the user corresponding to the current infoUDS-row (see below) the current user.</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="user_dsync()"
>user_dsync()</a></dt>

<dd>
<p>Make the user owning the current dataset the current user.</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="dset_create($dataset_name,$dataset_key)"
>dset_create($dataset_name,$dataset_key)</a></dt>

<dd>
<p>Create a new dataset and make it the current dataset. The current user will be the owner of the new dataset.</p>

<p>IN: Dataset name, dataset key.</p>

<p>Return value: TRUE on success, FALSE on error / dataset already exists.</p>

<dt><a name="dset_find($applic_id,$dataset_name)"
>dset_find($applic_id,$dataset_name)</a></dt>

<dd>
<p>Find a dataset in the database and make it the current dataset.</p>

<p>IN: Application id, dataset name.</p>

<p>Return value: TRUE on success, FALSE on error / no such dataset.</p>

<dt><a name="dset_first()"
>dset_first()</a></dt>

<dd>
<p>Make the first dataset (owned by the current user) the current dataset.</p>

<p>Return value: TRUE on success, FALSE on error / no dataset owned by the current user.</p>

<dt><a name="dset_next()"
>dset_next()</a></dt>

<dd>
<p>Make the next dataset (owned by the current user) the current dataset.</p>

<p>Return value: TRUE on success, FALSE on error / no more datasets.</p>

<dt><a name="dset_isync()"
>dset_isync()</a></dt>

<dd>
<p>Make the dataset corresponding to the current infoUDS-row (see below) the current dataset.</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="dset_put($info_type,$info_content)"
>dset_put($info_type,$info_content)</a></dt>

<dd>
<p>Add or replace content fields in the current dataset.</p>

<p>IN: Information type (I_type), value of I_content field (single entity or XML).</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="dset_get($info_type)"
>dset_get($info_type)</a></dt>

<dd>
<p>Get information from the current dataset.</p>

<p>IN: Information type (I_type). Currently one of &#39;ds_name&#39;, &#39;ds_id&#39;, &#39;u_id&#39;, &#39;DSKEY&#39;, &#39;LOCATION&#39;, &#39;CATALOG&#39;, &#39;WMS_URL&#39;, &#39;WMS_XML&#39;</p>

<p>Return value: Value of field (single entity or XML), FALSE on error.</p>

<dt><a name="infoUDS_set($info_type,$info_span)"
>infoUDS_set($info_type,$info_span)</a></dt>

<dd>
<p>Define a set of rows from the InfoUDS table and set the first row as the current row.</p>

<pre> IN:
 1. Information type. (Currently only SUBSCRIPTION_XML).
 2. Keyword that tells how the set shall relate to the current user and/or current dataset
    (values: USER, DATASET, USER_AND_DATASET).
    DATASET: All rows pertaining to the current dataset
    USER:  All rows pertaining to the current user
    USER_AND_DATASET: All rows pertaining to both the current user and current dataset.

 Return value: Number of rows (N) in the set, or FALSE on error / empty set.</pre>

<dt><a name="infoUDS_put($content)"
>infoUDS_put($content)</a></dt>

<dd>
<p>Replace the content field in the current row.</p>

<p>IN: Value of I_content field (single entity or XML).</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="infoUDS_get()"
>infoUDS_get()</a></dt>

<dd>
<p>Get information from the current row in the current set.</p>

<p>Return value: Value of I_content field (single entity or XML).</p>

<dt><a name="infoUDS_next()"
>infoUDS_next()</a></dt>

<dd>
<p>Define the next row in the set as the current row.</p>

<p>Return value: TRUE on success, FALSE on error / no more rows in the set.</p>

<dt><a name="infoUDS_new($content)"
>infoUDS_new($content)</a></dt>

<dd>
<p>Create a new row in the set and define it as the current row. The row will belong to the user and/or dataset that defines the set. If the set is only defined by user, the current dataset will be used to connect the row to a dataset. Similarly, if the set is only defined by dataset, the current user will be used. NOTE: The new row will be set up as the last row in the current set. Used inside a loop with infoUDS_next, this method will accordingly break out of the sequential visiting of rows from the set.</p>

<p>IN: Value of I_content field (single entity or XML).</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="infoUDS_delete()"
>infoUDS_delete()</a></dt>

<dd>
<p>Delete the current InfoUDS row.</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="file_find($file_name)"
>file_find($file_name)</a></dt>

<dd>
<p>Search for an existing file (owned by the curent user) and make it the current file.</p>

<p>IN: File name (F_name).</p>

<p>Return value: TRUE on success, FALSE on error / no such file.</p>

<dt><a name="file_create($file_name)"
>file_create($file_name)</a></dt>

<dd>
<p>Create a new file (for the current user) and make it the current file.</p>

<p>IN: File name (F_name)</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="file_put($property,$value)"
>file_put($property,$value)</a></dt>

<dd>
<p>Set file properties for the current file.</p>

<p>IN: Property name (one of f_timestamp, f_size, f_status, f_errurl), property value</p>

<p>Return value: TRUE on success, FALSE on error.</p>

<dt><a name="file_get($property)"
>file_get($property)</a></dt>

<dd>
<p>Get file properties for the current file.</p>

<p>IN: Property name (one of f_timestamp, f_size, f_status, f_errurl).</p>

<p>Return value: Property value or FALSE on error.</p>

<dt><a name="file_first()"
>file_first()</a></dt>

<dd>
<p>Make the first file (owned by the current user) the current file.</p>

<p>Return value: TRUE on success, FALSE on error / no files owned by the current dataset.</p>

<dt><a name="file_next()"
>file_next()</a></dt>

<dd>
<p>Make the next file in the database the current one.</p>

<p>Return value: TRUE on success, FALSE on error / no more files.</p>

<dt><a name="file_delete()"
>file_delete()</a></dt>

<dd>
<p>Delete the current file in the database.</p>

<p>Return value: TRUE on success, FALSE on error.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Egil St&#65533;ren &#60;egil.storen@met.no&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="POD_ERRORS"
>POD ERRORS</a></h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>
<dt><a name="Around_line_2133:"
>Around line 2133:</a></dt>

<dd>
<p>Non-ASCII character seen before =encoding in &#39;St&#65533;ren&#39;. Assuming UTF-8</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
