<html><head><title>Class::Singleton</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:03 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#PREREQUISITES'>PREREQUISITES</a>
  <li class='indexItem indexItem1'><a href='#INSTALLATION'>INSTALLATION</a>
  <li class='indexItem indexItem1'><a href='#USING_THE_CLASS%3A%3ASINGLETON_MODULE'>USING THE CLASS::SINGLETON MODULE</a>
  <li class='indexItem indexItem1'><a href='#DERIVING_SINGLETON_CLASSES'>DERIVING SINGLETON CLASSES</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#instance()'>instance()</a>
    <li class='indexItem indexItem2'><a href='#has_instance()'>has_instance()</a>
    <li class='indexItem indexItem2'><a href='#_new_instance()'>_new_instance()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Class::Singleton - Implementation of a &#34;Singleton&#34; class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Class::Singleton;
    
    my $one = Class::Singleton-&#62;instance();   # returns a new instance
    my $two = Class::Singleton-&#62;instance();   # returns same instance</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This is the <code>Class::Singleton</code> module. A Singleton describes an object class that can have only one instance in any system. An example of a Singleton might be a print spooler or system registry. This module implements a Singleton class from which other classes can be derived. By itself, the <code>Class::Singleton</code> module does very little other than manage the instantiation of a single object. In deriving a class from <code>Class::Singleton</code>, your module will inherit the Singleton instantiation method and can implement whatever specific functionality is required.</p>

<p>For a description and discussion of the Singleton class, see &#34;Design Patterns&#34;, Gamma et al, Addison-Wesley, 1995, ISBN 0-201-63361-2.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PREREQUISITES"
>PREREQUISITES</a></h1>

<p><code>Class::Singleton</code> requires Perl version 5.004 or later. If you have an older version of Perl, please upgrade to latest version, available from your nearest CPAN site (see <a href="../INSTALLATION.html" class="podlinkpod"
>INSTALLATION</a> below).</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INSTALLATION"
>INSTALLATION</a></h1>

<p>The <code>Class::Singleton</code> module is available from CPAN. As the &#39;perlmod&#39; man page explains:</p>

<pre>    CPAN stands for the Comprehensive Perl Archive Network.
    This is a globally replicated collection of all known Perl
    materials, including hundreds of unbunded modules.
    
    [...]
    
    For an up-to-date listing of CPAN sites, see
    http://www.perl.com/perl/ or ftp://ftp.perl.com/perl/ .</pre>

<p>The module is available in the following directories:</p>

<pre>    /modules/by-module/Class/Class-Singleton-&#60;version&#62;.tar.gz
    /authors/id/ABW/Class-Singleton-&#60;version&#62;.tar.gz</pre>

<p><code>Class::Singleton</code> is distributed as a single gzipped tar archive file:</p>

<pre>    Class-Singleton-&#60;version&#62;.tar.gz</pre>

<p>Note that &#34;&#60;version&#62;&#34; represents the current version number, of the form &#34;<code>1.23</code>&#34;. See <a href="../VERSION.html" class="podlinkpod"
>VERSION</a> below to determine the current version number for <code>Class::Singleton</code>.</p>

<p>Unpack the archive to create an installation directory:</p>

<pre>    gunzip Class-Singleton-&#60;version&#62;.tar.gz
    tar xvf Class-Singleton-&#60;version&#62;.tar</pre>

<p>&#39;cd&#39; into that directory, make, test and install the module:</p>

<pre>    cd Class-Singleton-&#60;version&#62;
    perl Makefile.PL
    make
    make test
    make install</pre>

<p>The &#39;<code>make install</code>&#39; will install the module on your system. You may need root access to perform this task. If you install the module in a local directory (for example, by executing &#34;<code>perl Makefile.PL LIB=~/lib</code>&#34; in the above - see <code>perldoc MakeMaker</code> for full details), you will need to ensure that the <code>PERL5LIB</code> environment variable is set to include the location, or add a line to your scripts explicitly naming the library location:</p>

<pre>    use lib &#39;/local/path/to/lib&#39;;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USING_THE_CLASS::SINGLETON_MODULE"
>USING THE CLASS::SINGLETON MODULE</a></h1>

<p>To import and use the <code>Class::Singleton</code> module the following line should appear in your Perl program:</p>

<pre>    use Class::Singleton;</pre>

<p>The <a href="../instance().html" class="podlinkpod"
>instance()</a> method is used to create a new <code>Class::Singleton</code> instance, or return a reference to an existing instance. Using this method, it is only possible to have a single instance of the class in any system.</p>

<pre>    my $highlander = Class::Singleton-&#62;instance();</pre>

<p>Assuming that no <code>Class::Singleton</code> object currently exists, this first call to <a href="../instance().html" class="podlinkpod"
>instance()</a> will create a new <code>Class::Singleton</code> and return a reference to it. Future invocations of <a href="../instance().html" class="podlinkpod"
>instance()</a> will return the same reference.</p>

<pre>    my $macleod    = Class::Singleton-&#62;instance();</pre>

<p>In the above example, both <code>$highlander</code> and <code>$macleod</code> contain the same reference to a <code>Class::Singleton</code> instance. There can be only one.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DERIVING_SINGLETON_CLASSES"
>DERIVING SINGLETON CLASSES</a></h1>

<p>A module class may be derived from <code>Class::Singleton</code> and will inherit the <a href="../instance().html" class="podlinkpod"
>instance()</a> method that correctly instantiates only one object.</p>

<pre>    package PrintSpooler;
    use base &#39;Class::Singleton&#39;;
    
    # derived class specific code
    sub submit_job {
        ...
    }
    
    sub cancel_job {
        ...
    }</pre>

<p>The <code>PrintSpooler</code> class defined above could be used as follows:</p>

<pre>    use PrintSpooler;
    
    my $spooler = PrintSpooler-&#62;instance();
    
    $spooler-&#62;submit_job(...);</pre>

<p>The <a href="../instance().html" class="podlinkpod"
>instance()</a> method calls the <a href="../_new_instance().html" class="podlinkpod"
>_new_instance()</a> constructor method the first and only time a new instance is created. All parameters passed to the <a href="../instance().html" class="podlinkpod"
>instance()</a> method are forwarded to <a href="../_new_instance().html" class="podlinkpod"
>_new_instance()</a>. In the base class the <a href="../_new_instance().html" class="podlinkpod"
>_new_instance()</a> method returns a blessed reference to a hash array containing any arguments passed as either a hash reference or list of named parameters.</p>

<pre>    package MyConfig;
    use base &#39;Class::Singleton&#39;;
    
    sub foo {
        shift-&#62;{ foo };
    }
    
    sub bar {
        shift-&#62;{ bar };
    }
    
    package main;
    
    # either: hash reference of named parameters
    my $config = MyConfig-&#62;instance({ foo =&#62; 10, bar =&#62; 20 });
    
    # or: list of named parameters
    my $config = MyConfig-&#62;instance( foo =&#62; 10, bar =&#62; 20 );
    
    print $config-&#62;foo();   # 10
    print $config-&#62;bar();   # 20</pre>

<p>Derived classes may redefine the <a href="../_new_instance().html" class="podlinkpod"
>_new_instance()</a> method to provide more specific object initialisation or change the underlying object type (to a list reference, for example).</p>

<pre>    package MyApp::Database;
    use base &#39;Class::Singleton&#39;;
    use DBI;
    
    # this only gets called the first time instance() is called
    sub _new_instance {
        my $class = shift;
        my $self  = bless { }, $class;
        my $db    = shift || &#34;myappdb&#34;;    
        my $host  = shift || &#34;localhost&#34;;
        
        $self-&#62;{ DB } = DBI-&#62;connect(&#34;DBI:mSQL:$db:$host&#34;)
            || die &#34;Cannot connect to database: $DBI::errstr&#34;;
        
        # any other initialisation...
        
        return $self;
    }</pre>

<p>The above example might be used as follows:</p>

<pre>    use MyApp::Database;
    
    # first use - database gets initialised
    my $database = MyApp::Database-&#62;instance();</pre>

<p>Some time later on in a module far, far away...</p>

<pre>    package MyApp::FooBar
    use MyApp::Database;
    
    # this FooBar object needs access to the database; the Singleton
    # approach gives a nice wrapper around global variables.
    
    sub new {
        my $class = shift;
        bless {
            database =&#62; MyApp::Database-&#62;instance(),
        }, $class;
    }</pre>

<p>The <code>Class::Singleton</code> <a href="../instance().html" class="podlinkpod"
>instance()</a> method uses a package variable to store a reference to any existing instance of the object. This variable, &#34;<code>_instance</code>&#34;, is coerced into the derived class package rather than the base class package.</p>

<p>Thus, in the <code>MyApp::Database</code> example above, the instance variable would be:</p>

<pre>    $MyApp::Database::_instance;</pre>

<p>This allows different classes to be derived from <code>Class::Singleton</code> that can co-exist in the same system, while still allowing only one instance of any one class to exists. For example, it would be possible to derive both &#39;<code>PrintSpooler</code>&#39; and &#39;<code>MyApp::Database</code>&#39; from <code>Class::Singleton</code> and have a single instance of <i>each</i> in a system, rather than a single instance of <i>either</i>.</p>

<p>You can use the <a href="../has_instance().html" class="podlinkpod"
>has_instance()</a> method to find out if a particular class already has an instance defined. A reference to the instance is returned or <code>undef</code> if none is currently defined.</p>

<pre>    my $instance = MyApp::Database-&#62;has_instance()
        || warn &#34;No instance is defined yet&#34;;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="instance()"
>instance()</a></h2>

<p>This method is called to return a current object instance or create a new one by calling <a href="../_new_instance().html" class="podlinkpod"
>_new_instance()</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="has_instance()"
>has_instance()</a></h2>

<p>This method returns a reference to any existing instance or <code>undef</code> if none is defined.</p>

<pre>    my $testing = MySingleton1-&#62;has_instance()
        || warn &#34;No instance defined for MySingleton1&#34;;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_new_instance()"
>_new_instance()</a></h2>

<p>This &#34;private&#34; method is called by <a href="../instance().html" class="podlinkpod"
>instance()</a> to create a new object instance if one doesn&#39;t already exist. It is not intended to be called directly (although there&#39;s nothing to stop you from calling it if you&#39;re really determined to do so).</p>

<p>It creates a blessed hash reference containing any arguments passed to the method as either a hash reference or list of named parameters.</p>

<pre>    # either: hash reference of named parameters
    my $example1 = MySingleton1-&#62;new({ pi =&#62; 3.14, e =&#62; 2.718 });

    # or: list of named parameters
    my $example2 = MySingleton2-&#62;new( pi =&#62; 3.14, e =&#62; 2.718 );</pre>

<p>It is important to remember that the <a href="../instance().html" class="podlinkpod"
>instance()</a> method will <i>only</i> call the <i>_new_instance()</i> method once, so any arguments you pass may be silently ignored if an instance already exists. You can use the <a href="../has_instance().html" class="podlinkpod"
>has_instance()</a> method to determine if an instance is already defined.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Andy Wardley &#60;abw@wardley.org&#62; <a href="http://wardley.org/" class="podlinkurl"
>http://wardley.org/</a></p>

<p>Thanks to Andreas Koenig for providing some significant speedup patches and other ideas.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>This is version 1.4, released September 2007</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright Andy Wardley 1998-2007. All Rights Reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
