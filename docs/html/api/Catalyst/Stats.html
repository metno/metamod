<html><head><title>Catalyst::Stats</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:03 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#enable'>enable</a>
    <li class='indexItem indexItem2'><a href='#profile'>profile</a>
    <li class='indexItem indexItem2'><a href='#created'>created</a>
    <li class='indexItem indexItem2'><a href='#elapsed'>elapsed</a>
    <li class='indexItem indexItem2'><a href='#report'>report</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#COMPATIBILITY_METHODS'>COMPATIBILITY METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#accept'>accept</a>
    <li class='indexItem indexItem2'><a href='#addChild'>addChild</a>
    <li class='indexItem indexItem2'><a href='#setNodeValue'>setNodeValue</a>
    <li class='indexItem indexItem2'><a href='#getNodeValue'>getNodeValue</a>
    <li class='indexItem indexItem2'><a href='#traverse'>traverse</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Stats - Catalyst Timing Statistics Class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    $stats = $c-&#62;stats;
    $stats-&#62;enable(1);
    $stats-&#62;profile($comment);
    $stats-&#62;profile(begin =&#62; $block_name, comment =&#62;$comment);
    $stats-&#62;profile(end =&#62; $block_name);
    $elapsed = $stats-&#62;elapsed;
    $report = $stats-&#62;report;</pre>

<p>See <a href="../Catalyst.html" class="podlinkpod"
>Catalyst</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module provides the default, simple timing stats collection functionality for Catalyst. If you want something different set <code>MyApp-&#62;stats_class</code> in your application module, e.g.:</p>

<pre>    __PACKAGE__-&#62;stats_class( &#34;My::Stats&#34; );</pre>

<p>If you write your own, your stats object is expected to provide the interface described here.</p>

<p>Catalyst uses this class to report timings of component actions. You can add profiling points into your own code to get deeper insight. Typical usage might be like this:</p>

<pre>  sub mysub {
    my ($c, ...) = @_;
    $c-&#62;stats-&#62;profile(begin =&#62; &#34;mysub&#34;);
    # code goes here
    ...
    $c-&#62;stats-&#62;profile(&#34;starting critical bit&#34;);
    # code here too
    ...
    $c-&#62;stats-&#62;profile(&#34;completed first part of critical bit&#34;);
    # more code
    ...
    $c-&#62;stats-&#62;profile(&#34;completed second part of critical bit&#34;);
    # more code
    ...
    $c-&#62;stats-&#62;profile(end =&#62; &#34;mysub&#34;);
  }</pre>

<p>Supposing mysub was called from the action &#34;process&#34; inside a Catalyst Controller called &#34;service&#34;, then the reported timings for the above example might look something like this:</p>

<pre>  .----------------------------------------------------------------+-----------.
  | Action                                                         | Time      |
  +----------------------------------------------------------------+-----------+
  | /service/process                                               | 1.327702s |
  |  mysub                                                         | 0.555555s |
  |   - starting critical bit                                      | 0.111111s |
  |   - completed first part of critical bit                       | 0.333333s |
  |   - completed second part of critical bit                      | 0.111000s |
  | /end                                                           | 0.000160s |
  &#39;----------------------------------------------------------------+-----------&#39;</pre>

<p>which means mysub took 0.555555s overall, it took 0.111111s to reach the critical bit, the first part of the critical bit took 0.333333s, and the second part 0.111s.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<p>Constructor.</p>

<pre>    $stats = Catalyst::Stats-&#62;new;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="enable"
>enable</a></h2>

<pre>    $stats-&#62;enable(0);
    $stats-&#62;enable(1);</pre>

<p>Enable or disable stats collection. By default, stats are enabled after object creation.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="profile"
>profile</a></h2>

<pre>    $stats-&#62;profile($comment);
    $stats-&#62;profile(begin =&#62; $block_name, comment =&#62;$comment);
    $stats-&#62;profile(end =&#62; $block_name);</pre>

<p>Marks a profiling point. These can appear in pairs, to time the block of code between the begin/end pairs, or by themselves, in which case the time of execution to the previous profiling point will be reported.</p>

<p>The argument may be either a single comment string or a list of name-value pairs. Thus the following are equivalent:</p>

<pre>    $stats-&#62;profile($comment);
    $stats-&#62;profile(comment =&#62; $comment);</pre>

<p>The following key names/values may be used:</p>

<ul>
<li>begin =&#62; ACTION
<p>Marks the beginning of a block. The value is used in the description in the timing report.</p>
</li>

<li>end =&#62; ACTION
<p>Marks the end of the block. The name given must match a previous &#39;begin&#39;. Correct nesting is recommended, although this module is tolerant of blocks that are not correctly nested, and the reported timings should accurately reflect the time taken to execute the block whether properly nested or not.</p>
</li>

<li>comment =&#62; COMMENT
<p>Comment string; use this to describe the profiling point. It is combined with the block action (if any) in the timing report description field.</p>
</li>

<li>uid =&#62; UID
<p>Assign a predefined unique ID. This is useful if, for whatever reason, you wish to relate a profiling point to a different parent than in the natural execution sequence.</p>
</li>

<li>parent =&#62; UID
<p>Explicitly relate the profiling point back to the parent with the specified UID. The profiling point will be ignored if the UID has not been previously defined.</p>
</li>
</ul>

<p>Returns the UID of the current point in the profile tree. The UID is automatically assigned if not explicitly given.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="created"
>created</a></h2>

<pre>    ($seconds, $microseconds) = $stats-&#62;created;</pre>

<p>Returns the time the object was created, in <code>gettimeofday</code> format, with Unix epoch seconds followed by microseconds.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="elapsed"
>elapsed</a></h2>

<pre>    $elapsed = $stats-&#62;elapsed</pre>

<p>Get the total elapsed time (in seconds) since the object was created.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="report"
>report</a></h2>

<pre>    print $stats-&#62;report .&#34;\n&#34;;
    $report = $stats-&#62;report;
    @report = $stats-&#62;report;</pre>

<p>In scalar context, generates a textual report. In array context, returns the array of results where each row comprises:</p>

<pre>    [ depth, description, time, rollup ]</pre>

<p>The depth is the calling stack level of the profiling point.</p>

<p>The description is a combination of the block name and comment.</p>

<p>The time reported for each block is the total execution time for the block, and the time associated with each intermediate profiling point is the elapsed time from the previous profiling point.</p>

<p>The &#39;rollup&#39; flag indicates whether the reported time is the rolled up time for the block, or the elapsed time from the previous profiling point.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COMPATIBILITY_METHODS"
>COMPATIBILITY METHODS</a></h1>

<p>Some components might expect the stats object to be a regular Tree::Simple object. We&#39;ve added some compatibility methods to handle this scenario:</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="accept"
>accept</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="addChild"
>addChild</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setNodeValue"
>setNodeValue</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getNodeValue"
>getNodeValue</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="traverse"
>traverse</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../Catalyst.html" class="podlinkpod"
>Catalyst</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>Catalyst Contributors, see Catalyst.pm</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>This library is free software. You can redistribute it and/or modify it under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
