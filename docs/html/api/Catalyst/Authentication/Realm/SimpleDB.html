<html><head><title>Catalyst::Authentication::Realm::SimpleDB</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:02 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#CONFIGURATION'>CONFIGURATION</a>
  <li class='indexItem indexItem1'><a href='#PREPARATION'>PREPARATION</a>
  <li class='indexItem indexItem1'><a href='#MIGRATION'>MIGRATION</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Authentication::Realm::SimpleDB - A simplified Catalyst authentication configurator.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Catalyst qw/
        Authentication
    /;

    __PACKAGE__-&#62;config-&#62;{&#39;Plugin::Authentication&#39;} =
        {
            default =&#62; {
                class      =&#62; &#39;SimpleDB&#39;,
                user_model =&#62; &#39;MyApp::Schema::Users&#39;,
            }
        }

    # later on ...
    $c-&#62;authenticate({ username =&#62; &#39;myusername&#39;,
                       password =&#62; &#39;mypassword&#39; });

    my $age = $c-&#62;user-&#62;get(&#39;age&#39;);

    $c-&#62;logout;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The Catalyst::Authentication::Realm::SimpleDB provides a simple way to configure Catalyst Authentication when using the most common configuration of a password protected user retrieved from an SQL database.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONFIGURATION"
>CONFIGURATION</a></h1>

<p>The SimpleDB Realm class configures the Catalyst authentication system based on the following:</p>

<ul>
<li>Your user data is stored in a table that is accessible via $c-&#62;model($cfg-&#62;{user_model});</li>

<li>Your passwords are stored in the &#39;password&#39; field in your users table and are not encrypted.</li>

<li>Your roles for users are stored in a separate table and are directly accessible via a DBIx::Class relationship called &#39;roles&#39; and the text of the role is stored in a field called &#39;role&#39; within the role table.</li>

<li>Your user information is stored in the session once the user is authenticated.</li>
</ul>

<p>For the above usage, only one configuration option is necessary, &#39;user_model&#39;. <b>user_model</b> should contain the <b>class name of your user class</b>. See the <a href="#PREPARATION" class="podlinkpod"
>&#34;PREPARATION&#34;</a> section for info on how to set up your database for use with this module.</p>

<p>If your system differs from the above, some minor configuration may be necessary. The options available are detailed below. These options match the configuration options used by the underlying credential and store modules. More information on these options can be found in <a href="../../../Catalyst/Authentication/Credential/Password.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Password</a> and <a href="../../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>Catalyst::Authentication::Store::DBIx::Class</a>.</p>

<dl>
<dt><a name="user_model"
>user_model</a></dt>

<dd>
<p>Contains the class name (as passed to $c-&#62;model() ) of the DBIx::Class schema to use as the source for user information. This config item is <b>REQUIRED</b>.</p>

<dt><a name="password_field"
>password_field</a></dt>

<dd>
<p>If your password field is not &#39;password&#39; set this option to the name of your password field. Note that if you change this to, say &#39;users_password&#39; you will need to use that in the authenticate call:</p>

<pre>    $c-&#62;authenticate({ username =&#62; &#39;bob&#39;, users_password =&#62; &#39;foo&#39; });</pre>

<dt><a name="password_type"
>password_type</a></dt>

<dd>
<p>If the password is not stored in plaintext you will need to define what format the password is in. The common options are <b>crypted</b> and <b>hashed</b>. Crypted uses the standard unix crypt to encrypt the password. Hashed uses the <a href="../../../Digest.html" class="podlinkpod"
>Digest</a> modules to perform password hashing.</p>

<dt><a name="password_hash_type"
>password_hash_type</a></dt>

<dd>
<p>If you use a hashed password type - this defines the type of hashing. See <a href="../../../Catalyst/Authentication/Credential/Password.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Password</a> for more details on this setting.</p>

<dt><a name="role_column"
>role_column</a></dt>

<dd>
<p>If your users roles are stored directly in your user table, set this to the column name that contains your roles. For example, if your user table contains a field called &#39;permissions&#39;, the value of role_column would be &#39;permissions&#39;. <b>NOTE</b>: If multiple values are stored in the role column, they should be space or pipe delimited.</p>

<dt><a name="role_relation_and_role_field"
>role_relation and role_field</a></dt>

<dd>
<p>These define an alternate role relationship name and the column that holds the role&#39;s name in plain text. See <a href="../../../Catalyst/Authentication/Store/DBIx/Class.html#CONFIGURATION" class="podlinkpod"
>&#34;CONFIGURATION&#34; in Catalyst::Authentication::Store::DBIx::Class</a> for more details on these settings.</p>

<dt><a name="use_userdata_from_session"
>use_userdata_from_session</a></dt>

<dd>
<p>This is a simple 1 / 0 setting which determines how a user&#39;s data is saved / restored from the session. If it is set to 1, the user&#39;s complete information (at the time of authentication) is cached between requests. If it is set to 0, the users information is loaded from the database on each request.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PREPARATION"
>PREPARATION</a></h1>

<p>This module makes several assumptions about the structure of your database. Below is an example of a table structure which will function with this module in it&#39;s default configuration. You can use this table structure as-is or add additional fields as necessary. <b>NOTE</b> that this is the default SimpleDB configuration only. Your table structure can differ significantly from this when using the <a href="../../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>DBIx::Class Store</a> directly.</p>

<pre>    --
    -- note that you can add any additional columns you require to the users table.
    --
    CREATE TABLE users (
            id            INTEGER PRIMARY KEY,
            username      TEXT,
            password      TEXT,
    );

    CREATE TABLE roles (
            id   INTEGER PRIMARY KEY,
            role TEXT
    );
    CREATE TABLE user_roles (
            user_id INTEGER,
            role_id INTEGER,
            PRIMARY KEY (user_id, role_id)
    );</pre>

<p>Also, after you have loaded this table structure into your DBIx::Class schema, please be sure that you have a many_to_many DBIx::Class relationship defined for the users to roles relation. Your schema files should contain something along these lines:</p>

<p><code>lib/MyApp/Schema/Users.pm</code>:</p>

<pre>    __PACKAGE__-&#62;has_many(map_user_role =&#62; &#39;MyApp::Schema::UserRoles&#39;, &#39;user_id&#39;);
    __PACKAGE__-&#62;many_to_many(roles =&#62; &#39;map_user_role&#39;, &#39;role&#39;);</pre>

<p><code>lib/MyApp/Schema/UserRoles.pm</code>:</p>

<pre>    __PACKAGE__-&#62;belongs_to(role =&#62; &#39;MyApp::Schema::Roles&#39;, &#39;role_id&#39;);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="MIGRATION"
>MIGRATION</a></h1>

<p>If and when your application becomes complex enough that you need more features than SimpleDB gives you access to, you can migrate to a standard Catalyst Authentication configuration fairly easily. SimpleDB simply creates a standard Auth config based on the inputs you give it. The config SimpleDB creates by default looks like this:</p>

<pre>    MyApp-&#62;config(&#39;Plugin::Authentication&#39;) = {
        default =&#62; {
            credential =&#62; {
                class =&#62; &#39;Password&#39;,
                password_type =&#62; &#39;clear&#39;
            },
            store =&#62; {
                class =&#62; &#39;DBIx::Class&#39;,
                role_relation =&#62; &#39;roles&#39;,
                role_field =&#62; &#39;role&#39;,
                use_userdata_from_session =&#62; &#39;1&#39;,
                user_model =&#62; $user_model_from_simpledb_config
                }
            }
    };</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>This module relies on a number of other modules to do it&#39;s job. For more information you can refer to the following:</p>

<ul>
<li><a href="../../../Catalyst/Manual/Tutorial/Authentication.html" class="podlinkpod"
>Catalyst::Manual::Tutorial::Authentication</a></li>

<li><a href="../../../Catalyst/Plugin/Authentication.html" class="podlinkpod"
>Catalyst::Plugin::Authentication</a></li>

<li><a href="../../../Catalyst/Authentication/Credential/Password.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Password</a></li>

<li><a href="../../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>Catalyst::Authentication::Store::DBIx::Class</a></li>

<li><a href="../../../Catalyst/Plugin/Authorization/Roles.html" class="podlinkpod"
>Catalyst::Plugin::Authorization::Roles</a></li>
</ul>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
