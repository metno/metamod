<html><head><title>Catalyst::Authentication::Store</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:02 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#MULTIPLE_BACKENDS'>MULTIPLE BACKENDS</a>
  <li class='indexItem indexItem1'><a href='#OLD_STORE_DOCUMENTATION_BELOW'>OLD STORE DOCUMENTATION BELOW</a>
  <li class='indexItem indexItem1'><a href='#WORKING_WITH_USERS'>WORKING WITH USERS</a>
  <li class='indexItem indexItem1'><a href='#WRITING_A_BACKEND'>WRITING A BACKEND</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Integrating_with_Catalyst%3A%3APlugin%3A%3ASession'>Integrating with Catalyst::Plugin::Session</a>
    <li class='indexItem indexItem2'><a href='#Optional_Features'>Optional Features</a>
    <li class='indexItem indexItem2'><a href='#Stores_implying_certain_credentials'>Stores implying certain credentials</a>
    <li class='indexItem indexItem2'><a href='#Writing_a_plugin_to_go_with_the_backend'>Writing a plugin to go with the backend</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Authentication::Store - All about authentication stores</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="MULTIPLE_BACKENDS"
>MULTIPLE BACKENDS</a></h1>

<p><b>NOTE</b> This is documentation for the old store system used in versions of <a href="../../Catalyst/Plugin/Authentication.html" class="podlinkpod"
>Catalyst::Plugin::Authentication</a> prior to 0.10.
This is NOT how the new realm-based stores work.
This is here for reference only.</p>

<p>See <a href="../../Catalyst/Plugin/Authentication/Internals.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::Internals</a> instead.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OLD_STORE_DOCUMENTATION_BELOW"
>OLD STORE DOCUMENTATION BELOW</a></h1>

<p>A key issue to understand about authentication stores is that there are potentially many of them.
Each one is registered into the application,
and has a name.</p>

<p>For most applications,
there is only one,
and in this framework it is called &#39;default&#39;.</p>

<p>When you use a plugin,
like</p>

<pre>    use Catalyst qw/
        Authentication
        Authentication::Store::Foo
    /;</pre>

<p>the Store plugins typically only act at setup time. They rarely do more than check out the configuration, and register e.g. Store::Foo, and set it as the default store.</p>

<pre>    __PACKAGE__-&#62;default_auth_store( $store );

    # the same as

    __PACKAGE__-&#62;register_auth_stores( default =&#62; $store );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="WORKING_WITH_USERS"
>WORKING WITH USERS</a></h1>

<p>All credential verifiers should accept either a user object, or a user ID.</p>

<p>If a user ID is provided, then they will fetch the user object from the default store, and check against it.</p>

<p>This should be pretty much DWIM all the time.</p>

<p>When you need multiple authentication backends per application then you must fetch things yourself. For example:</p>

<pre>    my $user = $c-&#62;get_auth_store(&#34;other_store&#34;)-&#62;get_user($id);

    $c-&#62;login( $user, $supplied_password );</pre>

<p>Instead of just:</p>

<pre>    $c-&#62;login( $id, $supplied_password );</pre>

<p>which will go to the default store.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="WRITING_A_BACKEND"
>WRITING A BACKEND</a></h1>

<p>Writing an authentication storage backend is a very simple matter.</p>

<p>The only method you really need to support is <code>get_user</code>.</p>

<p>This method should accept an arbitrary list of parameters (determined by you or the credential verifyer), and return an object inheriting <a href="../../Catalyst/Authentication/User.html" class="podlinkpod"
>Catalyst::Authentication::User</a>.</p>

<p>For introspection purposes you can also define the <code>user_supports</code> method. See below for optional features. This is not necessary, but might be in the future.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Integrating_with_Catalyst::Plugin::Session"
>Integrating with Catalyst::Plugin::Session</a></h2>

<p>If your users support sessions, your store should also define the <code>from_session</code> method. When the user object is saved in the session the <code>for_session</code> method is called, and that is used as the value in the session (typically a user id). The store is also saved in the hash. If <code>$user-&#62;store</code> returns something registered, that store&#39;s name is used. If not, the user&#39;s class is used as if it were a store (and must also support <code>from_session</code>).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Optional_Features"
>Optional Features</a></h2>

<p>Each user has the <code>supports</code> method. For example:</p>

<pre>    $user-&#62;supports(qw/password clear/);</pre>

<p>should return a true value if this specific user has a clear text password.</p>

<p>This is on a per user (not necessarily a per store) basis. To make assumptions about the store as a whole,</p>

<pre>    $store-&#62;user_supports(qw/password clear/);</pre>

<p>is supposed to be the lowest common denominator.</p>

<p>The standardization of these values is to be goverened by the community, typically defined by the credential verification plugins.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Stores_implying_certain_credentials"
>Stores implying certain credentials</a></h2>

<p>Sometimes a store is agnostic to the credentials (DB storage, for example), but sometimes it isn&#39;t (like an Htpasswd file).</p>

<p>If you are writing a backend that wraps around a module, like <a href="../../Catalyst/Authentication/Store/Htpasswd.html" class="podlinkpod"
>Catalyst::Authentication::Store::Htpasswd</a> wraps around <a href="../../Authen/Htpasswd.html" class="podlinkpod"
>Authen::Htpasswd</a>, it makes sense to delegate the credential checks.</p>

<p>This particular example caused the following &#34;feature&#34; to be added:</p>

<pre>    $user-&#62;supports(qw/password self_check/);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Writing_a_plugin_to_go_with_the_backend"
>Writing a plugin to go with the backend</a></h2>

<p>Typically the backend will do the heavy lifting, by registering a store.</p>

<p>These plugins should look something like this:</p>

<pre>    sub setup {
        my $c = shift;

        $c-&#62;default_auth_store(
            # a store can be an object or a class
            Catalyst::Authentication::Store::Foo::Backend-&#62;new(
                ...
            )
        );

        $c-&#62;NEXT::setup(@_);
    }</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
