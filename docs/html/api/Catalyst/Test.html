<html><head><title>Catalyst::Test</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:03 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#INLINE_TESTS_WILL_NO_LONGER_WORK'>INLINE TESTS WILL NO LONGER WORK</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24content_%3D_get(_..._)'>$content = get( ... )</a>
    <li class='indexItem indexItem2'><a href='#%24res_%3D_request(_..._)%3B'>$res = request( ... );</a>
    <li class='indexItem indexItem2'><a href='#(%24res%2C_%24c)_%3D_ctx_request(_..._)%3B'>($res, $c) = ctx_request( ... );</a>
    <li class='indexItem indexItem2'><a href='#action_ok(%24url_%5B%2C_%24test_name_%5D)'>action_ok($url [, $test_name ])</a>
    <li class='indexItem indexItem2'><a href='#action_redirect(%24url_%5B%2C_%24test_name_%5D)'>action_redirect($url [, $test_name ])</a>
    <li class='indexItem indexItem2'><a href='#action_notfound(%24url_%5B%2C_%24test_name_%5D)'>action_notfound($url [, $test_name ])</a>
    <li class='indexItem indexItem2'><a href='#content_like(_%24url%2C_%24regexp_%5B%2C_%24test_name_%5D_)'>content_like( $url, $regexp [, $test_name ] )</a>
    <li class='indexItem indexItem2'><a href='#contenttype_is(%24url%2C_%24type_%5B%2C_%24test_name_%5D)'>contenttype_is($url, $type [, $test_name ])</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Test - Test Catalyst Applications</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    # Helper
    script/test.pl

    # Tests
    use Catalyst::Test &#39;TestApp&#39;;
    my $content  = get(&#39;index.html&#39;);           # Content as string
    my $response = request(&#39;index.html&#39;);       # HTTP::Response object
    my($res, $c) = ctx_request(&#39;index.html&#39;);      # HTTP::Response &#38; context object

    use HTTP::Request::Common;
    my $response = request POST &#39;/foo&#39;, [
        bar =&#62; &#39;baz&#39;,
        something =&#62; &#39;else&#39;
    ];

    # Run tests against a remote server
    CATALYST_SERVER=&#39;http://localhost:3000/&#39; prove -r -l lib/ t/

    use Catalyst::Test &#39;TestApp&#39;;
    use Test::More tests =&#62; 1;

    ok( get(&#39;/foo&#39;) =~ /bar/ );

    # mock virtual hosts
    use Catalyst::Test &#39;MyApp&#39;, { default_host =&#62; &#39;myapp.com&#39; };
    like( get(&#39;/whichhost&#39;), qr/served by myapp.com/ );
    like( get( &#39;/whichhost&#39;, { host =&#62; &#39;yourapp.com&#39; } ), qr/served by yourapp.com/ );
    {
        local $Catalyst::Test::default_host = &#39;otherapp.com&#39;;
        like( get(&#39;/whichhost&#39;), qr/served by otherapp.com/ );
    }</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module allows you to make requests to a Catalyst application either without a server, by simulating the environment of an HTTP request using <a href="../HTTP/Request/AsCGI.html" class="podlinkpod"
>HTTP::Request::AsCGI</a> or remotely if you define the CATALYST_SERVER environment variable. This module also adds a few Catalyst-specific testing methods as displayed in the method section.</p>

<p>The <a href="#%24content_%3D_get(_..._)" class="podlinkpod"
>get</a> and <a href="#%24res_%3D_request(_..._)%3B" class="podlinkpod"
>request</a> functions take either a URI or an <a href="../HTTP/Request.html" class="podlinkpod"
>HTTP::Request</a> object.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INLINE_TESTS_WILL_NO_LONGER_WORK"
>INLINE TESTS WILL NO LONGER WORK</a></h1>

<p>While it used to be possible to inline a whole test app into a <code>.t</code> file for a distribution, this will no longer work.</p>

<p>The convention is to place your <a href="../Catalyst.html" class="podlinkpod"
>Catalyst</a> test apps into <code>t/lib</code> in your distribution. E.g.: <code>t/lib/TestApp.pm</code>, <code>t/lib/TestApp/Controller/Root.pm</code>, etc.. Multiple test apps can be used in this way.</p>

<p>Then write your <code>.t</code> files like so:</p>

<pre>    use strict;
    use warnings;
    use FindBin &#39;$Bin&#39;;
    use lib &#34;$Bin/lib&#34;;
    use Test::More tests =&#62; 6;
    use Catalyst::Test &#39;TestApp&#39;;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$content_=_get(_..._)"
>$content = get( ... )</a></h2>

<p>Returns the content.</p>

<pre>    my $content = get(&#39;foo/bar?test=1&#39;);</pre>

<p>Note that this method doesn&#39;t follow redirects, so to test for a correctly redirecting page you&#39;ll need to use a combination of this method and the <a href="#%24res_%3D_request(_..._)%3B" class="podlinkpod"
>request</a> method below:</p>

<pre>    my $res = request(&#39;/&#39;); # redirects to /y
    warn $res-&#62;header(&#39;location&#39;);
    use URI;
    my $uri = URI-&#62;new($res-&#62;header(&#39;location&#39;));
    is ( $uri-&#62;path , &#39;/y&#39;);
    my $content = get($uri-&#62;path);</pre>

<p>Note also that the content is returned as raw bytes, without any attempt to decode it into characters.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$res_=_request(_..._);"
>$res = request( ... );</a></h2>

<p>Returns an <a href="../HTTP/Response.html" class="podlinkpod"
>HTTP::Response</a> object. Accepts an optional hashref for request header configuration; currently only supports setting &#39;host&#39; value.</p>

<pre>    my $res = request(&#39;foo/bar?test=1&#39;);
    my $virtual_res = request(&#39;foo/bar?test=1&#39;, {host =&#62; &#39;virtualhost.com&#39;});</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="($res,_$c)_=_ctx_request(_..._);"
>($res, $c) = ctx_request( ... );</a></h2>

<p>Works exactly like <a href="#%24res_%3D_request(_..._)%3B" class="podlinkpod"
>request</a>, except it also returns the Catalyst context object, <code>$c</code>. Note that this only works for local requests.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="action_ok($url_[,_$test_name_])"
>action_ok($url [, $test_name ])</a></h2>

<p>Fetches the given URL and checks that the request was successful. An optional second argument can be given to specify the name of the test.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="action_redirect($url_[,_$test_name_])"
>action_redirect($url [, $test_name ])</a></h2>

<p>Fetches the given URL and checks that the request was a redirect. An optional second argument can be given to specify the name of the test.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="action_notfound($url_[,_$test_name_])"
>action_notfound($url [, $test_name ])</a></h2>

<p>Fetches the given URL and checks that the request was not found. An optional second argument can be given to specify the name of the test.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="content_like(_$url,_$regexp_[,_$test_name_]_)"
>content_like( $url, $regexp [, $test_name ] )</a></h2>

<p>Fetches the given URL and returns whether the content matches the regexp. An optional third argument can be given to specify the name of the test.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="contenttype_is($url,_$type_[,_$test_name_])"
>contenttype_is($url, $type [, $test_name ])</a></h2>

<p>Verify the given URL has a content type of $type and optionally specify a test name.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../Catalyst.html" class="podlinkpod"
>Catalyst</a>, <a href="../Test/WWW/Mechanize/Catalyst.html" class="podlinkpod"
>Test::WWW::Mechanize::Catalyst</a>, <a href="../Test/WWW/Selenium/Catalyst.html" class="podlinkpod"
>Test::WWW::Selenium::Catalyst</a>, <a href="../Test/More.html" class="podlinkpod"
>Test::More</a>, <a href="../HTTP/Request/Common.html" class="podlinkpod"
>HTTP::Request::Common</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>Catalyst Contributors, see Catalyst.pm</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>This library is free software. You can redistribute it and/or modify it under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
