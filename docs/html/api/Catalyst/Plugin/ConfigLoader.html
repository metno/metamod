<html><head><title>Catalyst::Plugin::ConfigLoader</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:03 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#setup(_)'>setup( )</a>
    <li class='indexItem indexItem2'><a href='#load_config'>load_config</a>
    <li class='indexItem indexItem2'><a href='#find_files'>find_files</a>
    <li class='indexItem indexItem2'><a href='#get_config_path'>get_config_path</a>
    <li class='indexItem indexItem2'><a href='#get_config_local_suffix'>get_config_local_suffix</a>
    <li class='indexItem indexItem2'><a href='#finalize_config'>finalize_config</a>
    <li class='indexItem indexItem2'><a href='#config_substitutions(_%24value_)'>config_substitutions( $value )</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#CONTRIBUTORS'>CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Plugin::ConfigLoader - Load config files of various types</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    package MyApp;

    # ConfigLoader should be first in your list so
    # other plugins can get the config information
    use Catalyst qw( ConfigLoader ... );

    # by default myapp.* will be loaded
    # you can specify a file if you&#39;d like
    __PACKAGE__-&#62;config( &#39;Plugin::ConfigLoader&#39; =&#62; { file =&#62; &#39;config.yaml&#39; } );

  In the file, assuming it&#39;s in YAML format:

    foo: bar

  Accessible through the context object, or the class itself

   $c-&#62;config-&#62;{foo}    # bar
   MyApp-&#62;config-&#62;{foo} # bar</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module will attempt to load find and load a configuration file of various types. Currently it supports YAML, JSON, XML, INI and Perl formats. Special configuration for a particular driver format can be stored in <code>MyApp-&#62;config-&#62;{ &#39;Plugin::ConfigLoader&#39; }-&#62;{ driver }</code>. For example, to pass arguments to <a href="../../Config/General.html" class="podlinkpod"
>Config::General</a>, use the following:</p>

<pre>    __PACKAGE__-&#62;config( &#39;Plugin::ConfigLoader&#39; =&#62; {
        driver =&#62; {
            &#39;General&#39; =&#62; { -LowerCaseNames =&#62; 1 }
        }
    } );</pre>

<p>See <a href="../../Config/Any.html" class="podlinkpod"
>Config::Any</a>&#39;s <code>driver_args</code> parameter for more information.</p>

<p>To support the distinction between development and production environments, this module will also attemp to load a local config (e.g. myapp_local.yaml) which will override any duplicate settings. See <a href="#get_config_local_suffix" class="podlinkpod"
>get_config_local_suffix</a> for details on how this is configured.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setup(_)"
>setup( )</a></h2>

<p>This method is automatically called by Catalyst&#39;s setup routine. It will attempt to use each plugin and, once a file has been successfully loaded, set the <code>config()</code> section.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="load_config"
>load_config</a></h2>

<p>This method handles loading the configuration data into the Catalyst context object. It does not return a value.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_files"
>find_files</a></h2>

<p>This method determines the potential file paths to be used for config loading. It returns an array of paths (up to the filename less the extension) to pass to <a href="../../Config/Any.html" class="podlinkpod"
>Config::Any</a> for loading.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_config_path"
>get_config_path</a></h2>

<p>This method determines the path, filename prefix and file extension to be used for config loading. It returns the path (up to the filename less the extension) to check and the specific extension to use (if it was specified).</p>

<p>The order of preference is specified as:</p>

<ul>
<li><code>$ENV{ MYAPP_CONFIG }</code></li>

<li><code>$ENV{ CATALYST_CONFIG }</code></li>

<li><code>$c-&#62;config-&#62;{ &#39;Plugin::ConfigLoader&#39; }-&#62;{ file }</code></li>

<li><code>$c-&#62;path_to( $application_prefix )</code></li>
</ul>

<p>If either of the first two user-specified options are directories, the application prefix will be added on to the end of the path.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_config_local_suffix"
>get_config_local_suffix</a></h2>

<p>Determines the suffix of files used to override the main config. By default this value is <code>local</code>, which will load <code>myapp_local.conf</code>. The suffix can be specified in the following order of preference:</p>

<ul>
<li><code>$ENV{ MYAPP_CONFIG_LOCAL_SUFFIX }</code></li>

<li><code>$ENV{ CATALYST_CONFIG_LOCAL_SUFFIX }</code></li>

<li><code>$c-&#62;config-&#62;{ &#39;Plugin::ConfigLoader&#39; }-&#62;{ config_local_suffix }</code></li>
</ul>

<p>The first one of these values found replaces the default of <code>local</code> in the name of the local config file to be loaded.</p>

<p>For example, if <code> $ENV{ MYAPP_CONFIG_LOCAL_SUFFIX }</code> is set to <code>testing</code>, ConfigLoader will try and load <code>myapp_testing.conf</code> instead of <code>myapp_local.conf</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="finalize_config"
>finalize_config</a></h2>

<p>This method is called after the config file is loaded. It can be used to implement tuning of config values that can only be done at runtime. If you need to do this to properly configure any plugins, it&#39;s important to load ConfigLoader before them. ConfigLoader provides a default finalize_config method which walks through the loaded config hash and calls the <code>config_substitutions</code> sub on any string.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="config_substitutions(_$value_)"
>config_substitutions( $value )</a></h2>

<p>This method substitutes macros found with calls to a function. There are a number of default macros:</p>

<ul>
<li><code>__HOME__</code> - replaced with <code>$c-&#62;path_to(&#39;&#39;)</code></li>

<li><code>__ENV(foo)__</code> - replaced with the value of <code>$ENV{foo}</code></li>

<li><code>__path_to(foo/bar)__</code> - replaced with <code>$c-&#62;path_to(&#39;foo/bar&#39;)</code></li>

<li><code>__literal(__FOO__)__</code> - leaves __FOO__ alone (allows you to use <code>__DATA__</code> as a config value, for example)</li>
</ul>

<p>The parameter list is split on comma (<code>,</code>). You can override this method to do your own string munging, or you can define your own macros in <code>MyApp-&#62;config-&#62;{ &#39;Plugin::ConfigLoader&#39; }-&#62;{ substitutions }</code>. Example:</p>

<pre>    MyApp-&#62;config-&#62;{ &#39;Plugin::ConfigLoader&#39; }-&#62;{ substitutions } = {
        baz =&#62; sub { my $c = shift; qux( @_ ); }
    }</pre>

<p>The above will respond to <code>__baz(x,y)__</code> in config strings.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Brian Cassidy &#60;bricas@cpan.org&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONTRIBUTORS"
>CONTRIBUTORS</a></h1>

<p>The following people have generously donated their time to the development of this module:</p>

<ul>
<li>Joel Bernstein &#60;rataxis@cpan.org&#62; - Rewrite to use <a href="../../Config/Any.html" class="podlinkpod"
>Config::Any</a></li>

<li>David Kamholz &#60;dkamholz@cpan.org&#62; - <a href="../../Data/Visitor.html" class="podlinkpod"
>Data::Visitor</a> integration</li>

<li>Stuart Watt - Addition of ENV macro.</li>
</ul>

<p>Work to this module has been generously sponsored by:</p>

<ul>
<li>Portugal Telecom <a href="http://www.sapo.pt/" class="podlinkurl"
>http://www.sapo.pt/</a> - Work done by Joel Bernstein</li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>Copyright 2006-2010 by Brian Cassidy</p>

<p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<ul>
<li><a href="../../Catalyst.html" class="podlinkpod"
>Catalyst</a></li>

<li><a href="../../Catalyst/Plugin/ConfigLoader/Manual.html" class="podlinkpod"
>Catalyst::Plugin::ConfigLoader::Manual</a></li>

<li><a href="../../Config/Any.html" class="podlinkpod"
>Config::Any</a></li>
</ul>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
