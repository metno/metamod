<html><head><title>Catalyst::Plugin::Authentication</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:02 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#INTRODUCTION'>INTRODUCTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#The_Authentication%2FAuthorization_Process'>The Authentication/Authorization Process</a>
    <li class='indexItem indexItem2'><a href='#The_Components_In_This_Framework'>The Components In This Framework</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Realms'>Realms</a>
      <li class='indexItem indexItem3'><a href='#Credential_Verifiers'>Credential Verifiers</a>
      <li class='indexItem indexItem3'><a href='#Storage_Backends'>Storage Backends</a>
      <li class='indexItem indexItem3'><a href='#The_Core_Plugin'>The Core Plugin</a>
      <li class='indexItem indexItem3'><a href='#Other_Plugins'>Other Plugins</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#EXAMPLE'>EXAMPLE</a>
  <li class='indexItem indexItem1'><a href='#CONFIGURATION'>CONFIGURATION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eauthenticate(_%24userinfo_%5B%2C_%24realm_%5D)'>$c-&#62;authenticate( $userinfo [, $realm ])</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Euser(_)'>$c-&#62;user( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Euser_exists(_)'>$c-&#62;user_exists( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Euser_in_realm(_%24realm_)'>$c-&#62;user_in_realm( $realm )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Elogout(_)'>$c-&#62;logout( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Efind_user(_%24userinfo%2C_%24realm_)'>$c-&#62;find_user( $userinfo, $realm )</a>
    <li class='indexItem indexItem2'><a href='#persist_user()'>persist_user()</a>
    <li class='indexItem indexItem2'><a href='#find_realm_for_persisted_user()'>find_realm_for_persisted_user()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_METHODS'>INTERNAL METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eset_authenticated(_%24user%2C_%24realmname_)'>$c-&#62;set_authenticated( $user, $realmname )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eauth_restore_user(_%24user%2C_%24realmname_)'>$c-&#62;auth_restore_user( $user, $realmname )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eauth_realms(_)'>$c-&#62;auth_realms( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eget_auth_realm(_%24realmname_)'>$c-&#62;get_auth_realm( $realmname )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eupdate_user_in_session'>$c-&#62;update_user_in_session</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Esetup_auth_realm(_)'>$c-&#62;setup_auth_realm( )</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#OVERRIDDEN_METHODS'>OVERRIDDEN METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24c-%3Esetup(_)'>$c-&#62;setup( )</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Realms'>Realms</a>
    <li class='indexItem indexItem2'><a href='#User_Storage_Backends'>User Storage Backends</a>
    <li class='indexItem indexItem2'><a href='#Credential_verification'>Credential verification</a>
    <li class='indexItem indexItem2'><a href='#Authorization'>Authorization</a>
    <li class='indexItem indexItem2'><a href='#Internals_Documentation'>Internals Documentation</a>
    <li class='indexItem indexItem2'><a href='#Misc'>Misc</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#DON%27T_SEE_ALSO'>DON&#39;T SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#INCOMPATABILITIES'>INCOMPATABILITIES</a>
  <li class='indexItem indexItem1'><a href='#COMPATIBILITY_CONFIGURATION'>COMPATIBILITY CONFIGURATION</a>
  <li class='indexItem indexItem1'><a href='#COMPATIBILITY_ROUTINES'>COMPATIBILITY ROUTINES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24c-%3Elogin(_)'>$c-&#62;login( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Edefault_auth_store(_)'>$c-&#62;default_auth_store( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eget_auth_store(_%24name_)'>$c-&#62;get_auth_store( $name )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eget_auth_store_name(_%24store_)'>$c-&#62;get_auth_store_name( $store )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eauth_stores(_)'>$c-&#62;auth_stores( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eregister_auth_stores(_%25stores_by_name_)'>$c-&#62;register_auth_stores( %stores_by_name )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eauth_store_names(_)'>$c-&#62;auth_store_names( )</a>
    <li class='indexItem indexItem2'><a href='#%24c-%3Eget_user(_)'>$c-&#62;get_user( )</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SUPPORT'>SUPPORT</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#PRIMARY_MAINTAINER'>PRIMARY MAINTAINER</a>
  <li class='indexItem indexItem1'><a href='#ADDITIONAL_CONTRIBUTORS'>ADDITIONAL CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_%26_LICENSE'>COPYRIGHT &#38; LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Plugin::Authentication - Infrastructure plugin for the Catalyst authentication framework.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Catalyst qw/
        Authentication
    /;

    # later on ...
    $c-&#62;authenticate({ username =&#62; &#39;myusername&#39;,
                       password =&#62; &#39;mypassword&#39; });
    my $age = $c-&#62;user-&#62;get(&#39;age&#39;);
    $c-&#62;logout;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The authentication plugin provides generic user support for Catalyst apps. It is the basis for both authentication (checking the user is who they claim to be), and authorization (allowing the user to do what the system authorises them to do).</p>

<p>Using authentication is split into two parts. A Store is used to actually store the user information, and can store any amount of data related to the user. Credentials are used to verify users, using information from the store, given data from the frontend. A Credential and a Store are paired to form a &#39;Realm&#39;. A Catalyst application using the authentication framework must have at least one realm, and may have several.</p>

<p>To implement authentication in a Catalyst application you need to add this module, and specify at least one realm in the configuration.</p>

<p>Authentication data can also be stored in a session, if the application is using the <a href="../../Catalyst/Plugin/Session.html" class="podlinkpod"
>Catalyst::Plugin::Session</a> module.</p>

<p><b>NOTE</b> in version 0.10 of this module, the interface to this module changed. Please see <a href="#COMPATIBILITY_ROUTINES" class="podlinkpod"
>&#34;COMPATIBILITY ROUTINES&#34;</a> for more information.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTRODUCTION"
>INTRODUCTION</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Authentication/Authorization_Process"
>The Authentication/Authorization Process</a></h2>

<p>Web applications typically need to identify a user - to tell the user apart from other users. This is usually done in order to display private information that is only that user&#39;s business, or to limit access to the application so that only certain entities can access certain parts.</p>

<p>This process is split up into several steps. First you ask the user to identify themselves. At this point you can&#39;t be sure that the user is really who they claim to be.</p>

<p>Then the user tells you who they are, and backs this claim with some piece of information that only the real user could give you. For example, a password is a secret that is known to both the user and you. When the user tells you this password you can assume they&#39;re in on the secret and can be trusted (ignore identity theft for now). Checking the password, or any other proof is called <b>credential verification</b>.</p>

<p>By this time you know exactly who the user is - the user&#39;s identity is <b>authenticated</b>. This is where this module&#39;s job stops, and your application or other plugins step in.</p>

<p>The next logical step is <b>authorization</b>, the process of deciding what a user is (or isn&#39;t) allowed to do. For example, say your users are split into two main groups - regular users and administrators. You want to verify that the currently logged in user is indeed an administrator before performing the actions in an administrative part of your application. These decisions may be made within your application code using just the information available after authentication, or it may be facilitated by a number of plugins.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="The_Components_In_This_Framework"
>The Components In This Framework</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Realms"
>Realms</a></h3>

<p>Configuration of the Catalyst::Plugin::Authentication framework is done in terms of realms. In simplest terms, a realm is a pairing of a Credential verifier and a User storage (Store) backend. As of version 0.10003, realms are now objects that you can create and customize.</p>

<p>An application can have any number of Realms, each of which operates independent of the others. Each realm has a name, which is used to identify it as the target of an authentication request. This name can be anything, such as &#39;users&#39; or &#39;members&#39;. One realm must be defined as the default_realm, which is used when no realm name is specified. More information about configuring realms is available in the configuration section.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Credential_Verifiers"
>Credential Verifiers</a></h3>

<p>When user input is transferred to the <a href="../../Catalyst.html" class="podlinkpod"
>Catalyst</a> application (typically via form inputs) the application may pass this information into the authentication system through the <code>$c-&#62;authenticate()</code> method. From there, it is passed to the appropriate Credential verifier.</p>

<p>These plugins check the data, and ensure that it really proves the user is who they claim to be.</p>

<p>Credential verifiers compatible with versions of this module 0.10x and upwards should be in the namespace <code>Catalyst::Authentication::Credential</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Storage_Backends"
>Storage Backends</a></h3>

<p>The authentication data also identifies a user, and the Storage backend modules use this data to locate and return a standardized object-oriented representation of a user.</p>

<p>When a user is retrieved from a store it is not necessarily authenticated. Credential verifiers accept a set of authentication data and use this information to retrieve the user from the store they are paired with.</p>

<p>Storage backends compatible with versions of this module 0.10x and upwards should be in the namespace <code>Catalyst::Authentication::Store</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="The_Core_Plugin"
>The Core Plugin</a></h3>

<p>This plugin on its own is the glue, providing realm configuration, session integration, and other goodness for the other plugins.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Other_Plugins"
>Other Plugins</a></h3>

<p>More layers of plugins can be stacked on top of the authentication code. For example, <a href="../../Catalyst/Plugin/Session/PerUser.html" class="podlinkpod"
>Catalyst::Plugin::Session::PerUser</a> provides an abstraction of browser sessions that is more persistent per user. <a href="../../Catalyst/Plugin/Authorization/Roles.html" class="podlinkpod"
>Catalyst::Plugin::Authorization::Roles</a> provides an accepted way to separate and group users into categories, and then check which categories the current user belongs to.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLE"
>EXAMPLE</a></h1>

<p>Let&#39;s say we were storing users in a simple Perl hash. Users are verified by supplying a password which is matched within the hash.</p>

<p>This means that our application will begin like this:</p>

<pre>    package MyApp;

    use Catalyst qw/
        Authentication
    /;

    __PACKAGE__-&#62;config( &#39;Plugin::Authentication&#39; =&#62;
                {
                    default =&#62; {
                        credential =&#62; {
                            class =&#62; &#39;Password&#39;,
                            password_field =&#62; &#39;password&#39;,
                            password_type =&#62; &#39;clear&#39;
                        },
                        store =&#62; {
                            class =&#62; &#39;Minimal&#39;,
                            users =&#62; {
                                bob =&#62; {
                                    password =&#62; &#34;s00p3r&#34;,
                                    editor =&#62; &#39;yes&#39;,
                                    roles =&#62; [qw/edit delete/],
                                },
                                william =&#62; {
                                    password =&#62; &#34;s3cr3t&#34;,
                                    roles =&#62; [qw/comment/],
                                }
                            }
                        }
                    }
                }
    );</pre>

<p>This tells the authentication plugin what realms are available, which credential and store modules are used, and the configuration of each. With this code loaded, we can now attempt to authenticate users.</p>

<p>To show an example of this, let&#39;s create an authentication controller:</p>

<pre>    package MyApp::Controller::Auth;

    sub login : Local {
        my ( $self, $c ) = @_;

        if (    my $user     = $c-&#62;req-&#62;params-&#62;{user}
            and my $password = $c-&#62;req-&#62;params-&#62;{password} )
        {
            if ( $c-&#62;authenticate( { username =&#62; $user,
                                     password =&#62; $password } ) ) {
                $c-&#62;res-&#62;body( &#34;hello &#34; . $c-&#62;user-&#62;get(&#34;name&#34;) );
            } else {
                # login incorrect
            }
        }
        else {
            # invalid form input
        }
    }</pre>

<p>This code should be self-explanatory. If all the necessary fields are supplied, call the <code>authenticate</code> method on the context object. If it succeeds the user is logged in.</p>

<p>The credential verifier will attempt to retrieve the user whose details match the authentication information provided to <code>$c-&#62;authenticate()</code>. Once it fetches the user the password is checked and if it matches the user will be <b>authenticated</b> and <code>$c-&#62;user</code> will contain the user object retrieved from the store.</p>

<p>In the above case, the default realm is checked, but we could just as easily check an alternate realm. If this were an admin login, for example, we could authenticate on the admin realm by simply changing the <code>$c-&#62;authenticate()</code> call:</p>

<pre>    if ( $c-&#62;authenticate( { username =&#62; $user,
                             password =&#62; $password }, &#39;admin&#39; ) ) {
        $c-&#62;res-&#62;body( &#34;hello &#34; . $c-&#62;user-&#62;get(&#34;name&#34;) );
    } ...</pre>

<p>Now suppose we want to restrict the ability to edit to a user with an &#39;editor&#39; value of yes.</p>

<p>The restricted action might look like this:</p>

<pre>    sub edit : Local {
        my ( $self, $c ) = @_;

        $c-&#62;detach(&#34;unauthorized&#34;)
          unless $c-&#62;user_exists
          and $c-&#62;user-&#62;get(&#39;editor&#39;) eq &#39;yes&#39;;

        # do something restricted here
    }</pre>

<p>(Note that if you have multiple realms, you can use <code>$c-&#62;user_in_realm(&#39;realmname&#39;)</code> in place of <code>$c-&#62;user_exists();</code> This will essentially perform the same verification as user_exists, with the added requirement that if there is a user, it must have come from the realm specified.)</p>

<p>The above example is somewhat similar to role based access control. <a href="../../Catalyst/Authentication/Store/Minimal.html" class="podlinkpod"
>Catalyst::Authentication::Store::Minimal</a> treats the roles field as an array of role names. Let&#39;s leverage this. Add the role authorization plugin:</p>

<pre>    use Catalyst qw/
        ...
        Authorization::Roles
    /;

    sub edit : Local {
        my ( $self, $c ) = @_;

        $c-&#62;detach(&#34;unauthorized&#34;) unless $c-&#62;check_user_roles(&#34;edit&#34;);

        # do something restricted here
    }</pre>

<p>This is somewhat simpler and will work if you change your store, too, since the role interface is consistent.</p>

<p>Let&#39;s say your app grows, and you now have 10,000 users. It&#39;s no longer efficient to maintain a hash of users, so you move this data to a database. You can accomplish this simply by installing the <a href="../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> Store and changing your config:</p>

<pre>    __PACKAGE__-&#62;config( &#39;Plugin::Authentication&#39; =&#62;
                    {
                        default_realm =&#62; &#39;members&#39;,
                        members =&#62; {
                            credential =&#62; {
                                class =&#62; &#39;Password&#39;,
                                password_field =&#62; &#39;password&#39;,
                                password_type =&#62; &#39;clear&#39;
                            },
                            store =&#62; {
                                class =&#62; &#39;DBIx::Class&#39;,
                                user_model =&#62; &#39;MyApp::Users&#39;,
                                role_column =&#62; &#39;roles&#39;,
                            }
                        }
                    }
    );</pre>

<p>The authentication system works behind the scenes to load your data from the new source. The rest of your application is completely unchanged.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONFIGURATION"
>CONFIGURATION</a></h1>

<pre>    # example
    __PACKAGE__-&#62;config( &#39;Plugin::Authentication&#39; =&#62;
                {
                    default_realm =&#62; &#39;members&#39;,

                    members =&#62; {
                        credential =&#62; {
                            class =&#62; &#39;Password&#39;,
                            password_field =&#62; &#39;password&#39;,
                            password_type =&#62; &#39;clear&#39;
                        },
                        store =&#62; {
                            class =&#62; &#39;DBIx::Class&#39;,
                            user_model =&#62; &#39;MyApp::Users&#39;,
                            role_column =&#62; &#39;roles&#39;,
                        }
                    },
                    admins =&#62; {
                        credential =&#62; {
                            class =&#62; &#39;Password&#39;,
                            password_field =&#62; &#39;password&#39;,
                            password_type =&#62; &#39;clear&#39;
                        },
                        store =&#62; {
                            class =&#62; &#39;+MyApp::Authentication::Store::NetAuth&#39;,
                            authserver =&#62; &#39;192.168.10.17&#39;
                        }
                    }
                }
    );</pre>

<p>NOTE: Until version 0.10008 of this module, you would need to put all the realms inside a &#34;realms&#34; key in the configuration. Please see <a href="#COMPATIBILITY_CONFIGURATION" class="podlinkpod"
>&#34;COMPATIBILITY CONFIGURATION&#34;</a> for more information</p>

<dl>
<dt><a name="use_session"
>use_session</a></dt>

<dd>
<p>Whether or not to store the user&#39;s logged in state in the session, if the application is also using <a href="../../Catalyst/Plugin/Session.html" class="podlinkpod"
>Catalyst::Plugin::Session</a>. This value is set to true per default.</p>

<p>However, even if use_session is disabled, if any code touches $c-&#62;session, a session object will be auto-vivified and session Cookies will be sent in the headers. To prevent accidental session creation, check if a session already exists with if ($c-&#62;sessionid) { ... }. If the session doesn&#39;t exist, then don&#39;t place anything in the session to prevent an unecessary session from being created.</p>

<dt><a name="default_realm"
>default_realm</a></dt>

<dd>
<p>This defines which realm should be used as when no realm is provided to methods that require a realm such as authenticate or find_user.</p>

<dt><a name="realm_refs"
>realm refs</a></dt>

<dd>
<p>The Plugin::Authentication config hash contains the series of realm configurations you want to use for your app. The only rule here is that there must be at least one. A realm consists of a name, which is used to reference the realm, a credential and a store. You may also put your realm configurations within a subelement called &#39;realms&#39; if you desire to separate them from the remainder of your configuration. Note that if you use a &#39;realms&#39; subelement, you must put ALL of your realms within it.</p>

<p>You can also specify a realm class to instantiate instead of the default <a href="../../Catalyst/Authentication/Realm.html" class="podlinkpod"
>Catalyst::Authentication::Realm</a> class using the &#39;class&#39; element within the realm config.</p>

<p>Each realm config contains two hashes, one called &#39;credential&#39; and one called &#39;store&#39;, each of which provide configuration details to the respective modules. The contents of these hashes is specific to the module being used, with the exception of the &#39;class&#39; element, which tells the core Authentication module the classname to instantiate.</p>

<p>The &#39;class&#39; element follows the standard Catalyst mechanism of class specification. If a class is prefixed with a +, it is assumed to be a complete class name. Otherwise it is considered to be a portion of the class name. For credentials, the classname &#39;<b>Password</b>&#39;, for example, is expanded to Catalyst::Authentication::Credential::<b>Password</b>. For stores, the classname &#39;<b>storename</b>&#39; is expanded to: Catalyst::Authentication::Store::<b>storename</b>.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;authenticate(_$userinfo_[,_$realm_])"
>$c-&#62;authenticate( $userinfo [, $realm ])</a></h2>

<p>Attempts to authenticate the user using the information in the $userinfo hash reference using the realm $realm. $realm may be omitted, in which case the default realm is checked.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;user(_)"
>$c-&#62;user( )</a></h2>

<p>Returns the currently logged in user, or undef if there is none. Normally the user is re-retrieved from the store. For <a href="../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>Catalyst::Authentication::Store::DBIx::Class</a> the user is re-restored using the primary key of the user table. Thus <b>user</b> can throw an error even though <b>user_exists</b> returned true.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;user_exists(_)"
>$c-&#62;user_exists( )</a></h2>

<p>Returns true if a user is logged in right now. The difference between <b>user_exists</b> and <b>user</b> is that user_exists will return true if a user is logged in, even if it has not been yet retrieved from the storage backend. If you only need to know if the user is logged in, depending on the storage mechanism this can be much more efficient. <b>user_exists</b> only looks into the session while <b>user</b> is trying to restore the user.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;user_in_realm(_$realm_)"
>$c-&#62;user_in_realm( $realm )</a></h2>

<p>Works like user_exists, except that it only returns true if a user is both logged in right now and was retrieved from the realm provided.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;logout(_)"
>$c-&#62;logout( )</a></h2>

<p>Logs the user out. Deletes the currently logged in user from <code>$c-&#62;user</code> and the session. It does not delete the session.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;find_user(_$userinfo,_$realm_)"
>$c-&#62;find_user( $userinfo, $realm )</a></h2>

<p>Fetch a particular users details, matching the provided user info, from the realm specified in $realm.</p>

<pre>    $user = $c-&#62;find_user({ id =&#62; $id });
    $c-&#62;set_authenticated($user); # logs the user in and calls persist_user</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="persist_user()"
>persist_user()</a></h2>

<p>Under normal circumstances the user data is only saved to the session during initial authentication. This call causes the auth system to save the currently authenticated user&#39;s data across requests. Useful if you have changed the user data and want to ensure that future requests reflect the most current data. Assumes that at the time of this call, $c-&#62;user contains the most current data.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_realm_for_persisted_user()"
>find_realm_for_persisted_user()</a></h2>

<p>Private method, do not call from user code!</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_METHODS"
>INTERNAL METHODS</a></h1>

<p>These methods are for Catalyst::Plugin::Authentication <b>INTERNAL USE</b> only. Please do not use them in your own code, whether application or credential / store modules. If you do, you will very likely get the nasty shock of having to fix / rewrite your code when things change. They are documented here only for reference.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;set_authenticated(_$user,_$realmname_)"
>$c-&#62;set_authenticated( $user, $realmname )</a></h2>

<p>Marks a user as authenticated. This is called from within the authenticate routine when a credential returns a user. $realmname defaults to &#39;default&#39;. You can use find_user to get $user</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;auth_restore_user(_$user,_$realmname_)"
>$c-&#62;auth_restore_user( $user, $realmname )</a></h2>

<p>Used to restore a user from the session. In most cases this is called without arguments to restore the user via the session. Can be called with arguments when restoring a user from some other method. Currently not used in this way.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;auth_realms(_)"
>$c-&#62;auth_realms( )</a></h2>

<p>Returns a hashref containing realmname -&#62; realm instance pairs. Realm instances contain an instantiated store and credential object as the &#39;store&#39; and &#39;credential&#39; elements, respectively</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;get_auth_realm(_$realmname_)"
>$c-&#62;get_auth_realm( $realmname )</a></h2>

<p>Retrieves the realm instance for the realmname provided.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;update_user_in_session"
>$c-&#62;update_user_in_session</a></h2>

<p>This was a short-lived method to update user information - you should use persist_user instead.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;setup_auth_realm(_)"
>$c-&#62;setup_auth_realm( )</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OVERRIDDEN_METHODS"
>OVERRIDDEN METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;setup(_)"
>$c-&#62;setup( )</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>This list might not be up to date. Below are modules known to work with the updated API of 0.10 and are therefore compatible with realms.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Realms"
>Realms</a></h2>

<p><a href="../../Catalyst/Authentication/Realm.html" class="podlinkpod"
>Catalyst::Authentication::Realm</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="User_Storage_Backends"
>User Storage Backends</a></h2>

<dl>
<dt><a name="Catalyst::Authentication::Store::Minimal"
><a href="../../Catalyst/Authentication/Store/Minimal.html" class="podlinkpod"
>Catalyst::Authentication::Store::Minimal</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::DBIx::Class"
><a href="../../Catalyst/Authentication/Store/DBIx/Class.html" class="podlinkpod"
>Catalyst::Authentication::Store::DBIx::Class</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::LDAP"
><a href="../../Catalyst/Authentication/Store/LDAP.html" class="podlinkpod"
>Catalyst::Authentication::Store::LDAP</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::RDBO"
><a href="../../Catalyst/Authentication/Store/RDBO.html" class="podlinkpod"
>Catalyst::Authentication::Store::RDBO</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::Model::KiokuDB"
><a href="../../Catalyst/Authentication/Store/Model/KiokuDB.html" class="podlinkpod"
>Catalyst::Authentication::Store::Model::KiokuDB</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::Jifty::DBI"
><a href="../../Catalyst/Authentication/Store/Jifty/DBI.html" class="podlinkpod"
>Catalyst::Authentication::Store::Jifty::DBI</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Store::Htpasswd"
><a href="../../Catalyst/Authentication/Store/Htpasswd.html" class="podlinkpod"
>Catalyst::Authentication::Store::Htpasswd</a></a></dt>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Credential_verification"
>Credential verification</a></h2>

<dl>
<dt><a name="Catalyst::Authentication::Credential::Password"
><a href="../../Catalyst/Authentication/Credential/Password.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Password</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::HTTP"
><a href="../../Catalyst/Authentication/Credential/HTTP.html" class="podlinkpod"
>Catalyst::Authentication::Credential::HTTP</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::OpenID"
><a href="../../Catalyst/Authentication/Credential/OpenID.html" class="podlinkpod"
>Catalyst::Authentication::Credential::OpenID</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::Authen::Simple"
><a href="../../Catalyst/Authentication/Credential/Authen/Simple.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Authen::Simple</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::Flickr"
><a href="../../Catalyst/Authentication/Credential/Flickr.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Flickr</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::Testing"
><a href="../../Catalyst/Authentication/Credential/Testing.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Testing</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::AuthTkt"
><a href="../../Catalyst/Authentication/Credential/AuthTkt.html" class="podlinkpod"
>Catalyst::Authentication::Credential::AuthTkt</a></a></dt>

<dd>
<dt><a name="Catalyst::Authentication::Credential::Kerberos"
><a href="../../Catalyst/Authentication/Credential/Kerberos.html" class="podlinkpod"
>Catalyst::Authentication::Credential::Kerberos</a></a></dt>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Authorization"
>Authorization</a></h2>

<p><a href="../../Catalyst/Plugin/Authorization/ACL.html" class="podlinkpod"
>Catalyst::Plugin::Authorization::ACL</a>, <a href="../../Catalyst/Plugin/Authorization/Roles.html" class="podlinkpod"
>Catalyst::Plugin::Authorization::Roles</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Internals_Documentation"
>Internals Documentation</a></h2>

<p><a href="../../Catalyst/Plugin/Authentication/Internals.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::Internals</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Misc"
>Misc</a></h2>

<p><a href="../../Catalyst/Plugin/Session.html" class="podlinkpod"
>Catalyst::Plugin::Session</a>, <a href="../../Catalyst/Plugin/Session/PerUser.html" class="podlinkpod"
>Catalyst::Plugin::Session::PerUser</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DON&#39;T_SEE_ALSO"
>DON&#39;T SEE ALSO</a></h1>

<p>This module along with its sub plugins deprecate a great number of other modules. These include <a href="../../Catalyst/Plugin/Authentication/Simple.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::Simple</a>, <a href="../../Catalyst/Plugin/Authentication/CDBI.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::CDBI</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INCOMPATABILITIES"
>INCOMPATABILITIES</a></h1>

<p>The realms-based configuration and functionality of the 0.10 update of <a href="../../Catalyst/Plugin/Authentication.html" class="podlinkpod"
>Catalyst::Plugin::Authentication</a> required a change in the API used by credentials and stores. It has a compatibility mode which allows use of modules that have not yet been updated. This, however, completely mimics the older api and disables the new realm-based features. In other words you cannot mix the older credential and store modules with realms, or realm-based configs. The changes required to update modules are relatively minor and are covered in <a href="../../Catalyst/Plugin/Authentication/Internals.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::Internals</a>. We hope that most modules will move to the compatible list above very quickly.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COMPATIBILITY_CONFIGURATION"
>COMPATIBILITY CONFIGURATION</a></h1>

<p>Until version 0.10008 of this module, you needed to put all the realms inside a &#34;realms&#34; key in the configuration.</p>

<pre>    # example
    __PACKAGE__-&#62;config( &#39;Plugin::Authentication&#39; =&#62;
                {
                    default_realm =&#62; &#39;members&#39;,
                    realms =&#62; {
                        members =&#62; {
                            ...
                        },
                    },
                }
    );</pre>

<p>If you use the old, deprecated <code>__PACKAGE__-&#62;config( &#39;authentication&#39; )</code> configuration key, then the realms key is still required.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COMPATIBILITY_ROUTINES"
>COMPATIBILITY ROUTINES</a></h1>

<p>In version 0.10 of <a href="../../Catalyst/Plugin/Authentication.html" class="podlinkpod"
>Catalyst::Plugin::Authentication</a>, the API changed. For app developers, this change is fairly minor, but for Credential and Store authors, the changes are significant.</p>

<p>Please see the documentation in version 0.09 of Catalyst::Plugin::Authentication for a better understanding of how the old API functioned.</p>

<p>The items below are still present in the plugin, though using them is deprecated. They remain only as a transition tool, for those sites which can not yet be upgraded to use the new system due to local customizations or use of Credential / Store modules that have not yet been updated to work with the new API.</p>

<p>These routines should not be used in any application using realms functionality or any of the methods described above. These are for reference purposes only.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;login(_)"
>$c-&#62;login( )</a></h2>

<p>This method is used to initiate authentication and user retrieval. Technically this is part of the old Password credential module and it still resides in the <a href="../../Catalyst/Plugin/Authentication/Credential/Password.html" class="podlinkpod"
>Password</a> class. It is included here for reference only.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;default_auth_store(_)"
>$c-&#62;default_auth_store( )</a></h2>

<p>Return the store whose name is &#39;default&#39;.</p>

<p>This is set to <code>$c-&#62;config( &#39;Plugin::Authentication&#39; =&#62; { store =&#62; # Store} )</code> if that value exists, or by using a Store plugin:</p>

<pre>    # load the Minimal authentication store.
    use Catalyst qw/Authentication Authentication::Store::Minimal/;</pre>

<p>Sets the default store to <a href="../../Catalyst/Plugin/Authentication/Store/Minimal.html" class="podlinkpod"
>Catalyst::Plugin::Authentication::Store::Minimal</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;get_auth_store(_$name_)"
>$c-&#62;get_auth_store( $name )</a></h2>

<p>Return the store whose name is $name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;get_auth_store_name(_$store_)"
>$c-&#62;get_auth_store_name( $store )</a></h2>

<p>Return the name of the store $store.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;auth_stores(_)"
>$c-&#62;auth_stores( )</a></h2>

<p>A hash keyed by name, with the stores registered in the app.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;register_auth_stores(_%stores_by_name_)"
>$c-&#62;register_auth_stores( %stores_by_name )</a></h2>

<p>Register stores into the application.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;auth_store_names(_)"
>$c-&#62;auth_store_names( )</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$c-&#62;get_user(_)"
>$c-&#62;get_user( )</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SUPPORT"
>SUPPORT</a></h1>

<p>Please use the rt.cpan.org bug tracker, and git patches are wecome.</p>

<p>Questions on usage should be directed to the Catalyst mailing list or the #catalyst irc channel.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>Yuval Kogman, <code>nothingmuch@woobling.org</code> - original author</p>

<p>Jay Kuri, <code>jayk@cpan.org</code> - Large rewrite</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIMARY_MAINTAINER"
>PRIMARY MAINTAINER</a></h1>

<p>Tomas Doran (t0m), <code>bobtfish@bobtfish.net</code></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ADDITIONAL_CONTRIBUTORS"
>ADDITIONAL CONTRIBUTORS</a></h1>

<dl>
<dt><a name="Jess_Robinson"
>Jess Robinson</a></dt>

<dd>
<dt><a name="David_Kamholz"
>David Kamholz</a></dt>

<dd>
<dt><a name="kmx"
>kmx</a></dt>

<dd>
<dt><a name="Nigel_Metheringham"
>Nigel Metheringham</a></dt>

<dd>
<dt><a name="Florian_Ragwitz_rafl@debian.org"
>Florian Ragwitz <code>rafl@debian.org</code></a></dt>

<dd>
<dt><a name="Stephan_Jauernick_stephanj@cpan.org"
>Stephan Jauernick <code>stephanj@cpan.org</code></a></dt>

<dd>
<dt><a name="Oskari_Ojala_(Okko),_perl@okko.net"
>Oskari Ojala (Okko), <code>perl@okko.net</code></a></dt>

<dd>
<dt><a name="John_Napiorkowski_(jnap)_jjnapiork@cpan.org"
>John Napiorkowski (jnap) <code>jjnapiork@cpan.org</code></a></dt>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_&#38;_LICENSE"
>COPYRIGHT &#38; LICENSE</a></h1>

<p>Copyright (c) 2005 - 2012 the Catalyst::Plugin::Authentication <a href="#AUTHORS" class="podlinkpod"
>&#34;AUTHORS&#34;</a>, <a href="#PRIMARY_MAINTAINER" class="podlinkpod"
>&#34;PRIMARY MAINTAINER&#34;</a> and <a href="#ADDITIONAL_CONTRIBUTORS" class="podlinkpod"
>&#34;ADDITIONAL CONTRIBUTORS&#34;</a> as listed above.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
