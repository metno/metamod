<html><head><title>Catalyst::Plugin::Static::Simple</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:03 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#DEFAULT_BEHAVIOUR'>DEFAULT BEHAVIOUR</a>
  <li class='indexItem indexItem1'><a href='#ADVANCED_CONFIGURATION'>ADVANCED CONFIGURATION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Enabling_request_logging'>Enabling request logging</a>
    <li class='indexItem indexItem2'><a href='#Forcing_directories_into_static_mode'>Forcing directories into static mode</a>
    <li class='indexItem indexItem2'><a href='#Including_additional_directories'>Including additional directories</a>
    <li class='indexItem indexItem2'><a href='#Ignoring_certain_types_of_files'>Ignoring certain types of files</a>
    <li class='indexItem indexItem2'><a href='#Ignoring_entire_directories'>Ignoring entire directories</a>
    <li class='indexItem indexItem2'><a href='#Custom_MIME_types'>Custom MIME types</a>
    <li class='indexItem indexItem2'><a href='#Controlling_caching_with_Expires_header'>Controlling caching with Expires header</a>
    <li class='indexItem indexItem2'><a href='#Compatibility_with_other_plugins'>Compatibility with other plugins</a>
    <li class='indexItem indexItem2'><a href='#Debugging_information'>Debugging information</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#USING_WITH_APACHE'>USING WITH APACHE</a>
  <li class='indexItem indexItem1'><a href='#PUBLIC_METHODS'>PUBLIC METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#serve_static_file_%24file_path'>serve_static_file $file_path</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_EXTENDED_METHODS'>INTERNAL EXTENDED METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#prepare_action'>prepare_action</a>
    <li class='indexItem indexItem2'><a href='#dispatch'>dispatch</a>
    <li class='indexItem indexItem2'><a href='#finalize'>finalize</a>
    <li class='indexItem indexItem2'><a href='#setup'>setup</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#CONTRIBUTORS'>CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#THANKS'>THANKS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Catalyst::Plugin::Static::Simple - Make serving static pages painless.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    package MyApp;
    use Catalyst qw/ Static::Simple /;
    MyApp-&#62;setup;
    # that&#39;s it; static content is automatically served by Catalyst
    # from the application&#39;s root directory, though you can configure
    # things or bypass Catalyst entirely in a production environment
    #
    # one caveat: the files must be served from an absolute path
    # (i.e. /images/foo.png)</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The Static::Simple plugin is designed to make serving static content in your application during development quick and easy, without requiring a single line of code from you.</p>

<p>This plugin detects static files by looking at the file extension in the URL (such as <b>.css</b> or <b>.png</b> or <b>.js</b>). The plugin uses the lightweight <a href="../../../MIME/Types.html" class="podlinkpod"
>MIME::Types</a> module to map file extensions to IANA-registered MIME types, and will serve your static files with the correct MIME type directly to the browser, without being processed through Catalyst.</p>

<p>Note that actions mapped to paths using periods (.) will still operate properly.</p>

<p>If the plugin can not find the file, the request is dispatched to your application instead. This means you are responsible for generating a <code>404</code> error if your applicaton can not process the request:</p>

<pre>   # handled by static::simple, not dispatched to your application
   /images/exists.png

   # static::simple will not find the file and let your application
   # handle the request. You are responsible for generating a file
   # or returning a 404 error
   /images/does_not_exist.png</pre>

<p>Though Static::Simple is designed to work out-of-the-box, you can tweak the operation by adding various configuration options. In a production environment, you will probably want to use your webserver to deliver static content; for an example see <a href="#USING_WITH_APACHE" class="podlinkpod"
>&#34;USING WITH APACHE&#34;</a>, below.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DEFAULT_BEHAVIOUR"
>DEFAULT BEHAVIOUR</a></h1>

<p>By default, Static::Simple will deliver all files having extensions (that is, bits of text following a period (<code>.</code>)), <i>except</i> files having the extensions <code>tmpl</code>, <code>tt</code>, <code>tt2</code>, <code>html</code>, and <code>xhtml</code>. These files, and all files without extensions, will be processed through Catalyst. If <a href="../../../MIME/Types.html" class="podlinkpod"
>MIME::Types</a> doesn&#39;t recognize an extension, it will be served as <code>text/plain</code>.</p>

<p>To restate: files having the extensions <code>tmpl</code>, <code>tt</code>, <code>tt2</code>, <code>html</code>, and <code>xhtml</code> <i>will not</i> be served statically by default, they will be processed by Catalyst. Thus if you want to use <code>.html</code> files from within a Catalyst app as static files, you need to change the configuration of Static::Simple. Note also that files having any other extension <i>will</i> be served statically, so if you&#39;re using any other extension for template files, you should also change the configuration.</p>

<p>Logging of static files is turned off by default.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ADVANCED_CONFIGURATION"
>ADVANCED CONFIGURATION</a></h1>

<p>Configuration is completely optional and is specified within <code>MyApp-&#62;config-&#62;{Plugin::Static::Simple}</code>. If you use any of these options, this module will probably feel less &#34;simple&#34; to you!</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Enabling_request_logging"
>Enabling request logging</a></h2>

<p>Since Catalyst 5.50, logging of static requests is turned off by default; static requests tend to clutter the log output and rarely reveal anything useful. However, if you want to enable logging of static requests, you can do so by setting <code>MyApp-&#62;config-&#62;{Plugin::Static::Simple}-&#62;{logging}</code> to 1.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Forcing_directories_into_static_mode"
>Forcing directories into static mode</a></h2>

<p>Define a list of top-level directories beneath your &#39;root&#39; directory that should always be served in static mode. Regular expressions may be specified using <code>qr//</code>.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            dirs =&#62; [
                &#39;static&#39;,
                qr/^(images|css)/,
            ],
        }
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Including_additional_directories"
>Including additional directories</a></h2>

<p>You may specify a list of directories in which to search for your static files. The directories will be searched in order and will return the first file found. Note that your root directory is <b>not</b> automatically added to the search path when you specify an <code>include_path</code>. You should use <code>MyApp-&#62;config-&#62;{root}</code> to add it.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            include_path =&#62; [
                &#39;/path/to/overlay&#39;,
                \&#38;incpath_generator,
                MyApp-&#62;config-&#62;{root},
            ],
        },
    );</pre>

<p>With the above setting, a request for the file <code>/images/logo.jpg</code> will search for the following files, returning the first one found:</p>

<pre>    /path/to/overlay/images/logo.jpg
    /dynamic/path/images/logo.jpg
    /your/app/home/root/images/logo.jpg</pre>

<p>The include path can contain a subroutine reference to dynamically return a list of available directories. This method will receive the <code>$c</code> object as a parameter and should return a reference to a list of directories. Errors can be reported using <code>die()</code>. This method will be called every time a file is requested that appears to be a static file (i.e. it has an extension).</p>

<p>For example:</p>

<pre>    sub incpath_generator {
        my $c = shift;

        if ( $c-&#62;session-&#62;{customer_dir} ) {
            return [ $c-&#62;session-&#62;{customer_dir} ];
        } else {
            die &#34;No customer dir defined.&#34;;
        }
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Ignoring_certain_types_of_files"
>Ignoring certain types of files</a></h2>

<p>There are some file types you may not wish to serve as static files. Most important in this category are your raw template files. By default, files with the extensions <code>tmpl</code>, <code>tt</code>, <code>tt2</code>, <code>html</code>, and <code>xhtml</code> will be ignored by Static::Simple in the interest of security. If you wish to define your own extensions to ignore, use the <code>ignore_extensions</code> option:</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            ignore_extensions =&#62; [ qw/html asp php/ ],
        },
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Ignoring_entire_directories"
>Ignoring entire directories</a></h2>

<p>To prevent an entire directory from being served statically, you can use the <code>ignore_dirs</code> option. This option contains a list of relative directory paths to ignore. If using <code>include_path</code>, the path will be checked against every included path.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            ignore_dirs =&#62; [ qw/tmpl css/ ],
        },
    );</pre>

<p>For example, if combined with the above <code>include_path</code> setting, this <code>ignore_dirs</code> value will ignore the following directories if they exist:</p>

<pre>    /path/to/overlay/tmpl
    /path/to/overlay/css
    /dynamic/path/tmpl
    /dynamic/path/css
    /your/app/home/root/tmpl
    /your/app/home/root/css</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Custom_MIME_types"
>Custom MIME types</a></h2>

<p>To override or add to the default MIME types set by the <a href="../../../MIME/Types.html" class="podlinkpod"
>MIME::Types</a> module, you may enter your own extension to MIME type mapping.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            mime_types =&#62; {
                jpg =&#62; &#39;image/jpg&#39;,
                png =&#62; &#39;image/png&#39;,
            },
        },
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Controlling_caching_with_Expires_header"
>Controlling caching with Expires header</a></h2>

<p>The files served by Static::Simple will have a Last-Modified header set, which allows some browsers to cache them for a while. However if you want to explicitly set an Expires header, such as to allow proxies to cache your static content, then you can do so by setting the &#34;expires&#34; config option.</p>

<p>The value indicates the number of seconds after access time to allow caching. So a value of zero really means &#34;don&#39;t cache at all&#34;, and any higher values will keep the file around for that long.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            expires =&#62; 3600, # Caching allowed for one hour.
        },
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Compatibility_with_other_plugins"
>Compatibility with other plugins</a></h2>

<p>Since version 0.12, Static::Simple plays nice with other plugins. It no longer short-circuits the <code>prepare_action</code> stage as it was causing too many compatibility issues with other plugins.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Debugging_information"
>Debugging information</a></h2>

<p>Enable additional debugging information printed in the Catalyst log. This is automatically enabled when running Catalyst in -Debug mode.</p>

<pre>    MyApp-&#62;config(
        &#39;Plugin::Static::Simple&#39; =&#62; {
            debug =&#62; 1,
        },
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USING_WITH_APACHE"
>USING WITH APACHE</a></h1>

<p>While Static::Simple will work just fine serving files through Catalyst in mod_perl, for increased performance you may wish to have Apache handle the serving of your static files directly. To do this, simply use a dedicated directory for your static files and configure an Apache Location block for that directory This approach is recommended for production installations.</p>

<pre>    &#60;Location /myapp/static&#62;
        SetHandler default-handler
    &#60;/Location&#62;</pre>

<p>Using this approach Apache will bypass any handling of these directories through Catalyst. You can leave Static::Simple as part of your application, and it will continue to function on a development server, or using Catalyst&#39;s built-in server.</p>

<p>In practice, your Catalyst application is probably (i.e. should be) structured in the recommended way (i.e., that generated by bootstrapping the application with the <code>catalyst.pl</code> script, with a main directory under which is a <code>lib/</code> directory for module files and a <code>root/</code> directory for templates and static files). Thus, unless you break up this structure when deploying your app by moving the static files to a different location in your filesystem, you will need to use an Alias directive in Apache to point to the right place. You will then need to add a Directory block to give permission for Apache to serve these files. The final configuration will look something like this:</p>

<pre>    Alias /myapp/static /filesystem/path/to/MyApp/root/static
    &#60;Directory /filesystem/path/to/MyApp/root/static&#62;
        allow from all
    &#60;/Directory&#62;
    &#60;Location /myapp/static&#62;
        SetHandler default-handler
    &#60;/Location&#62;</pre>

<p>If you are running in a VirtualHost, you can just set the DocumentRoot location to the location of your root directory; see <a href="../../../Catalyst/Engine/Apache2/MP20.html" class="podlinkpod"
>Catalyst::Engine::Apache2::MP20</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_METHODS"
>PUBLIC METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="serve_static_file_$file_path"
>serve_static_file $file_path</a></h2>

<p>Will serve the file located in $file_path statically. This is useful when you need to autogenerate them if they don&#39;t exist, or they are stored in a model.</p>

<pre>    package MyApp::Controller::User;

    sub curr_user_thumb : PathPart(&#34;my_thumbnail.png&#34;) {
        my ( $self, $c ) = @_;
        my $file_path = $c-&#62;user-&#62;picture_thumbnail_path;
        $c-&#62;serve_static_file($file_path);
    }</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_EXTENDED_METHODS"
>INTERNAL EXTENDED METHODS</a></h1>

<p>Static::Simple extends the following steps in the Catalyst process.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="prepare_action"
>prepare_action</a></h2>

<p><code>prepare_action</code> is used to first check if the request path is a static file. If so, we skip all other <code>prepare_action</code> steps to improve performance.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dispatch"
>dispatch</a></h2>

<p><code>dispatch</code> takes the file found during <code>prepare_action</code> and writes it to the output.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="finalize"
>finalize</a></h2>

<p><code>finalize</code> serves up final header information and displays any log messages.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="setup"
>setup</a></h2>

<p><code>setup</code> initializes all default values.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../../Catalyst.html" class="podlinkpod"
>Catalyst</a>, <a href="../../../Catalyst/Plugin/Static.html" class="podlinkpod"
>Catalyst::Plugin::Static</a>, <a href="http://www.iana.org/assignments/media-types/" class="podlinkurl"
>http://www.iana.org/assignments/media-types/</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Andy Grundman, &#60;andy@hybridized.org&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONTRIBUTORS"
>CONTRIBUTORS</a></h1>

<p>Marcus Ramberg, &#60;mramberg@cpan.org&#62;</p>

<p>Jesse Sheidlower, &#60;jester@panix.com&#62;</p>

<p>Guillermo Roditi, &#60;groditi@cpan.org&#62;</p>

<p>Florian Ragwitz, &#60;rafl@debian.org&#62;</p>

<p>Tomas Doran, &#60;bobtfish@bobtfish.net&#62;</p>

<p>Justin Wheeler (dnm)</p>

<p>Matt S Trout, &#60;mst@shadowcat.co.uk&#62;</p>

<p>Toby Corkindale, &#60;tjc@wintrmute.net&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="THANKS"
>THANKS</a></h1>

<p>The authors of Catalyst::Plugin::Static:</p>

<pre>    Sebastian Riedel
    Christian Hansen
    Marcus Ramberg</pre>

<p>For the include_path code from Template Toolkit:</p>

<pre>    Andy Wardley</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (c) 2005 - 2011 the Catalyst::Plugin::Static::Simple <a href="#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34;</a> and <a href="#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34;</a> as listed above.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>This program is free software, you can redistribute it and/or modify it under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
