<html><head><title>Template::Manual::VMethods</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:27 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#Scalar_Virtual_Methods'>Scalar Virtual Methods</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#chunk(size)'>chunk(size)</a>
    <li class='indexItem indexItem2'><a href='#collapse'>collapse</a>
    <li class='indexItem indexItem2'><a href='#defined'>defined</a>
    <li class='indexItem indexItem2'><a href='#dquote'>dquote</a>
    <li class='indexItem indexItem2'><a href='#hash'>hash</a>
    <li class='indexItem indexItem2'><a href='#lcfirst'>lcfirst</a>
    <li class='indexItem indexItem2'><a href='#length'>length</a>
    <li class='indexItem indexItem2'><a href='#list'>list</a>
    <li class='indexItem indexItem2'><a href='#lower'>lower</a>
    <li class='indexItem indexItem2'><a href='#match(pattern%2C_global)'>match(pattern, global)</a>
    <li class='indexItem indexItem2'><a href='#repeat(n)'>repeat(n)</a>
    <li class='indexItem indexItem2'><a href='#replace(search%2C_replace)'>replace(search, replace)</a>
    <li class='indexItem indexItem2'><a href='#remove(pattern)'>remove(pattern)</a>
    <li class='indexItem indexItem2'><a href='#search(pattern)'>search(pattern)</a>
    <li class='indexItem indexItem2'><a href='#size'>size</a>
    <li class='indexItem indexItem2'><a href='#split(pattern)'>split(pattern)</a>
    <li class='indexItem indexItem2'><a href='#substr(offset%2C_length%2C_replacement)'>substr(offset, length, replacement)</a>
    <li class='indexItem indexItem2'><a href='#squote'>squote</a>
    <li class='indexItem indexItem2'><a href='#trim'>trim</a>
    <li class='indexItem indexItem2'><a href='#ucfirst'>ucfirst</a>
    <li class='indexItem indexItem2'><a href='#upper'>upper</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Hash_Virtual_Methods'>Hash Virtual Methods</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#keys'>keys</a>
    <li class='indexItem indexItem2'><a href='#values'>values</a>
    <li class='indexItem indexItem2'><a href='#items'>items</a>
    <li class='indexItem indexItem2'><a href='#each'>each</a>
    <li class='indexItem indexItem2'><a href='#pairs'>pairs</a>
    <li class='indexItem indexItem2'><a href='#list'>list</a>
    <li class='indexItem indexItem2'><a href='#sort%2C_nsort'>sort, nsort</a>
    <li class='indexItem indexItem2'><a href='#import'>import</a>
    <li class='indexItem indexItem2'><a href='#defined%2C_exists'>defined, exists</a>
    <li class='indexItem indexItem2'><a href='#delete'>delete</a>
    <li class='indexItem indexItem2'><a href='#size'>size</a>
    <li class='indexItem indexItem2'><a href='#item'>item</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#List_Virtual_Methods'>List Virtual Methods</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#first%2C_last'>first, last</a>
    <li class='indexItem indexItem2'><a href='#size%2C_max'>size, max</a>
    <li class='indexItem indexItem2'><a href='#defined'>defined</a>
    <li class='indexItem indexItem2'><a href='#reverse'>reverse</a>
    <li class='indexItem indexItem2'><a href='#join'>join</a>
    <li class='indexItem indexItem2'><a href='#grep'>grep</a>
    <li class='indexItem indexItem2'><a href='#sort%2C_nsort'>sort, nsort</a>
    <li class='indexItem indexItem2'><a href='#unshift(item)%2C_push(item)'>unshift(item), push(item)</a>
    <li class='indexItem indexItem2'><a href='#shift%2C_pop'>shift, pop</a>
    <li class='indexItem indexItem2'><a href='#unique'>unique</a>
    <li class='indexItem indexItem2'><a href='#import'>import</a>
    <li class='indexItem indexItem2'><a href='#merge'>merge</a>
    <li class='indexItem indexItem2'><a href='#slice(from%2C_to)'>slice(from, to)</a>
    <li class='indexItem indexItem2'><a href='#splice(offset%2C_length%2C_list)'>splice(offset, length, list)</a>
    <li class='indexItem indexItem2'><a href='#hash'>hash</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#Automagic_Promotion_of_Scalar_to_List_for_Virtual_Methods'>Automagic Promotion of Scalar to List for Virtual Methods</a>
  <li class='indexItem indexItem1'><a href='#Defining_Custom_Virtual_Methods'>Defining Custom Virtual Methods</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Template::Manual::VMethods - Virtual Methods</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Scalar_Virtual_Methods"
>Scalar Virtual Methods</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="chunk(size)"
>chunk(size)</a></h2>

<p>Splits the value into a list of chunks of a certain size.</p>

<pre>    [% ccard_no = &#34;1234567824683579&#34;;
       ccard_no.chunk(4).join
    %]</pre>

<p>Output:</p>

<pre>    1234 5678 2468 3579</pre>

<p>If the size is specified as a negative number then the text will be chunked from right-to-left. This gives the correct grouping for numbers, for example.</p>

<pre>    [% number = 1234567;
       number.chunk(-3).join(&#39;,&#39;)
    %]</pre>

<p>Output:</p>

<pre>    1,234,567</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="collapse"
>collapse</a></h2>

<p>Returns the text with any leading and trailing whitespace removed and any internal sequences of whitespace converted to a single space</p>

<pre>    [% text = &#34;  The bird\n  is the word&#34; %]
    [% text.collapse %]       # The bird is the word</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="defined"
>defined</a></h2>

<p>Returns true if the value is defined.</p>

<pre>    [% user = get_user(uid) IF uid.defined %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dquote"
>dquote</a></h2>

<p>Returns the text with any double quote characters escaped with a backslash prefix. Any newline characters in the text will be replaced with &#34;\n&#34;.</p>

<pre>    [% quote = &#39;He said &#34;Oh really?&#34;&#39; %]
    [% quote.dquote %]        # He said \&#34;Oh really?\&#34;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="hash"
>hash</a></h2>

<p>Return the value as a hash reference containing a single entry with the key <code>value</code> indicating the original scalar value. As with the <code>list</code> virtual method, this is generally used to help massage data into different formats.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="lcfirst"
>lcfirst</a></h2>

<p>Returns the text with the first letter converted to lower case.</p>

<pre>    [% word = &#39;BIRD&#39; %]
    [% word.lcfirst %]        # bIRD</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="length"
>length</a></h2>

<p>Returns the length of the string representation of the item:</p>

<pre>    [% IF password.length &#60; 8 %]
       Password too short, dumbass!
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="list"
>list</a></h2>

<p>Return the value as a single element list. This can be useful if you have a variable which may contain a single item or a list and you want to treat them equally. The <code>list</code> method can be called against a list reference and will simply return the original reference, effectively a no-op.</p>

<pre>    [% thing.list.size %]     # thing can be a scalar or a list</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="lower"
>lower</a></h2>

<p>Returns the text in lower case.</p>

<pre>    [% word = &#39;BIRD&#39; %]
    [% word.lower %]          # bird</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="match(pattern,_global)"
>match(pattern, global)</a></h2>

<p>Performs a regular expression match on the string using the pattern passed as an argument. If the pattern matches the string then the method returns a reference to a list of any strings captured within parenthesis in the pattern.</p>

<pre>    [% name = &#39;Larry Wall&#39; %]
    [% matches = name.match(&#39;(\w+) (\w+)&#39;) %]
    [% matches.1 %], [% matches.0 %]    # Wall, Larry</pre>

<p>If the pattern does not match then the method returns false, rather than returning an empty list which Perl and the Template Toolkit both consider to be a true value. This allows you to write expression like this.</p>

<pre>    [% &#34;We&#39;re not worthy!&#34; IF name.match(&#39;Larry Wall&#39;) %]

    [% IF (matches = name.match(&#39;(\w+) (\w+)&#39;)) %]
       pattern matches: [% matches.join(&#39;, &#39;) %]
    [% ELSE %]
       pattern does not match
    [% END %]</pre>

<p>Any regex modifiers, like <code>/s</code>, should be added in the regex using the <code>(?s)</code> syntax. For example, to modify the regex to disregard whitespace (the <code>/x</code> switch), use:</p>

<pre>    [% re = &#39;(?x)
               (\w+)
               [ ]
               (\w+)
             &#39;;
      matches = name.match(re);
    %]</pre>

<p>To perform a global search to match the pattern as many times as it appears in the source string, provide a true value for the <code>global</code> argument following the pattern.</p>

<pre>    [% text = &#39;bandanna&#39;;
       text.match(&#39;an+&#39;, 1).join(&#39;, )      # an, ann
    %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="repeat(n)"
>repeat(n)</a></h2>

<p>Repeat the string a specified number of times.</p>

<pre>    [% name = &#39;foo&#39; %]
    [% name.repeat(3) %]                # foofoofoo</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="replace(search,_replace)"
>replace(search, replace)</a></h2>

<p>Outputs the string with all instances of the first argument (specified as a Perl regular expression) with the second.</p>

<pre>    [% name = &#39;foo, bar &#38; baz&#39; %]
    [% name.replace(&#39;\W+&#39;, &#39;_&#39;) %]        # foo_bar_baz</pre>

<p>You can use <code>$1</code>, <code>$2</code>, etc., to reference captured parts (in parentheses) in the regular expression. Just be careful to <i>single</i> quote the replacement string. If you use <i>double</i> quotes then TT will try and interpolate the variables before passing the string to the <code>replace</code> vmethod.</p>

<pre>    [% name = &#39;FooBarBaz&#39; %]
    [% name.replace(&#39;([A-Z])&#39;, &#39; $1&#39;) %]  # Foo Bar Baz</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remove(pattern)"
>remove(pattern)</a></h2>

<p>Outputs the string with all instances of the pattern (specified as a Perl regular expression) removed.</p>

<pre>    [% name = &#39;foo, bar &#38; baz&#39; %]
    [% name.remove(&#39;\W+&#39;) %]    # foobarbaz</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="search(pattern)"
>search(pattern)</a></h2>

<p>Performs a similar function to <a href="../../match.html" class="podlinkpod"
>match</a> but simply returns true if the string matches the regular expression pattern passed as an argument.</p>

<pre>    [% name = &#39;foo bar baz&#39; %]
    [% name.search(&#39;bar&#39;) ? &#39;bar&#39; : &#39;no bar&#39; %]     # bar</pre>

<p>This virtual method is now deprecated in favour of <a href="../../match.html" class="podlinkpod"
>match</a>. Move along now, there&#39;s nothing more to see here.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="size"
>size</a></h2>

<p>Always returns 1 for scalar values. This method is provided for consistency with the hash and list size methods.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="split(pattern)"
>split(pattern)</a></h2>

<p>Calls Perl&#39;s <code>split()</code> function to split a string into a list of strings.</p>

<pre>    [% FOREACH dir IN mypath.split(&#39;:&#39;) %]
       [% dir %]
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="substr(offset,_length,_replacement)"
>substr(offset, length, replacement)</a></h2>

<p>Returns a substring starting at <code>offset</code>, for <code>length</code> characters.</p>

<pre>    [% str &#39;foo bar baz wiz waz woz&#39;) %]
    [% str.substr(4, 3) %]    # bar</pre>

<p>If <code>length</code> is not specified then it returns everything from the <code>offset</code> to the end of the string.</p>

<pre>    [% str.substr(12) %]      # wiz waz woz</pre>

<p>If both <code>length</code> and <code>replacement</code> are specified, then the method replaces everything from <code>offset</code> for <code>length</code> characters with <code>$replacement</code>. The substring removed from the string is then returned.</p>

<pre>    [% str.substr(0, 11, &#39;FOO&#39;) %]   # foo bar baz
    [% str %]                        # FOO wiz waz woz</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="squote"
>squote</a></h2>

<p>Returns the text with any single quote characters escaped with a backslash prefix.</p>

<pre>    [% tim = &#34;Tim O&#39;Reilly&#34; %]
    [% tim.squote %]          # Tim O\&#39;Reilly</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="trim"
>trim</a></h2>

<p>Returns the text with any leading and trailing whitespace removed.</p>

<pre>    [% text = &#39;  hello  world  &#39; %]
    [% text.trim %]           # hello  world</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ucfirst"
>ucfirst</a></h2>

<p>Returns the text with the first letter converted to upper case.</p>

<pre>    [% word = &#39;bird&#39; %]
    [% word.ucfirst %]        # Bird</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="upper"
>upper</a></h2>

<p>Returns the text in upper case.</p>

<pre>    [% word = &#39;bird&#39; %]
    [% word.upper %]          # BIRD</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Hash_Virtual_Methods"
>Hash Virtual Methods</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="keys"
>keys</a></h2>

<p>Returns a list of keys in the hash. They are not returned in any particular order, but the order is the same as for the corresponding values method.</p>

<pre>    [% FOREACH key IN hash.keys %]
       * [% key %]
    [% END %]</pre>

<p>If you want the keys in sorted order, use the list <code>sort</code> method.</p>

<pre>    [% FOREACH key IN hash.keys.sort %]
       * [% key %]
    [% END %]</pre>

<p>Having got the keys in sorted order, you can then use variable interpolation to fetch the value. This is shown in the following example by the use of <code>$key</code> to fetch the item from <code>hash</code> whose key is stored in the <code>key</code> variable.</p>

<pre>    [% FOREACH key IN hash.keys.sort %]
       * [% key %] = [% hash.$key %]
    [% END %]</pre>

<p>Alternately, you can use the <code>pairs</code> method to get a list of key/value pairs in sorted order.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="values"
>values</a></h2>

<p>Returns a list of the values in the hash. As with the <code>keys</code> method, they are not returned in any particular order, although it is the same order that the keys are returned in.</p>

<pre>    [% hash.values.join(&#39;, &#39;) %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="items"
>items</a></h2>

<p>Returns a list of both the keys and the values expanded into a single list.</p>

<pre>    [% hash = {
          a = 10
          b = 20
       };

       hash.items.join(&#39;, &#39;)    # a, 10, b, 20
    %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="each"
>each</a></h2>

<p>This method currently returns the same thing as the <code>items</code> method.</p>

<p>However, please note that this method will change in the next major version of the Template Toolkit (v3) to return the same thing as the <code>pairs</code> method. This will be done in an effort to make these virtual method more consistent with each other and how Perl works.</p>

<p>In anticipation of this, we recommend that you stop using <code>hash.each</code> and instead use <code>hash.items</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="pairs"
>pairs</a></h2>

<p>This method returns a list of key/value pairs. They are returned in sorted order according to the keys.</p>

<pre>    [% FOREACH pair IN product.pairs %]
       * [% pair.key %] is [% pair.value %]
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="list"
>list</a></h2>

<p>Returns the contents of the hash in list form. An argument can be passed to indicate the desired items required in the list: <code>keys</code> to return a list of the keys (same as <code>hash.keys</code>), <code>values</code> to return a list of the values (same as <code>hash.values</code>), <code>each</code> to return as list of key and values (same as <code>hash.each</code>), or <code>pairs</code> to return a list of key/value pairs (same as <code>hash.pairs</code>).</p>

<pre>    [% keys   = hash.list(&#39;keys&#39;) %]
    [% values = hash.list(&#39;values&#39;) %]
    [% items  = hash.list(&#39;each&#39;) %]
    [% pairs  = hash.list(&#39;pairs&#39;) %]</pre>

<p>When called without an argument it currently returns the same thing as the <code>pairs</code> method. However, please note that this method will change in the next major version of the Template Toolkit (v3) to return a reference to a list containing the single hash reference (as per the scalar list method).</p>

<p>In anticipation of this, we recommend that you stop using <code>hash.list</code> and instead use <code>hash.pairs</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sort,_nsort"
>sort, nsort</a></h2>

<p>Return a list of the keys, sorted alphabetically (<code>sort</code>) or numerically (<code>nsort</code>) according to the corresponding values in the hash.</p>

<pre>    [% FOREACH n IN phones.sort %]
       [% phones.$n %] is [% n %],
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="import"
>import</a></h2>

<p>The <code>import</code> method can be called on a hash array to import the contents of another hash array.</p>

<pre>    [% hash1 = {
         foo = &#39;Foo&#39;
         bar = &#39;Bar&#39;
       }
       hash2 = {
           wiz = &#39;Wiz&#39;
           woz = &#39;Woz&#39;
       }
    %]

    [% hash1.import(hash2) %]
    [% hash1.wiz %]             # Wiz</pre>

<p>You can also call the <code>import()</code> method by itself to import a hash array into the current namespace hash.</p>

<pre>    [% user = { id =&#62; &#39;lwall&#39;, name =&#62; &#39;Larry Wall&#39; } %]
    [% import(user) %]
    [% id %]: [% name %]        # lwall: Larry Wall</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="defined,_exists"
>defined, exists</a></h2>

<p>Returns a true or false value if an item in the hash denoted by the key passed as an argument is defined or exists, respectively.</p>

<pre>    [% hash.defined(&#39;somekey&#39;) ? &#39;yes&#39; : &#39;no&#39; %]
    [% hash.exists(&#39;somekey&#39;) ? &#39;yes&#39; : &#39;no&#39; %]</pre>

<p>When called without any argument, <code>hash.defined</code> returns true if the hash itself is defined (e.g. the same effect as <code>scalar.defined</code>).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="delete"
>delete</a></h2>

<p>Delete one or more items from the hash.</p>

<pre>    [% hash.delete(&#39;foo&#39;, &#39;bar&#39;) %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="size"
>size</a></h2>

<p>Returns the number of key/value pairs in the hash.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="item"
>item</a></h2>

<p>Returns an item from the hash using a key passed as an argument.</p>

<pre>    [% hash.item(&#39;foo&#39;) %]  # same as hash.foo</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="List_Virtual_Methods"
>List Virtual Methods</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="first,_last"
>first, last</a></h2>

<p>Returns the first/last item in the list. The item is not removed from the list.</p>

<pre>    [% results.first %] to [% results.last %]</pre>

<p>If either is given a numeric argument <code>n</code>, they return the first or last <code>n</code> elements:</p>

<pre>    The first 5 results are [% results.first(5).join(&#34;, &#34;) %].</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="size,_max"
>size, max</a></h2>

<p>Returns the size of a list (number of elements) and the maximum index number (size - 1), respectively.</p>

<pre>    [% results.size %] search results matched your query</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="defined"
>defined</a></h2>

<p>Returns a true or false value if the item in the list denoted by the argument is defined.</p>

<pre>    [% list.defined(3) ? &#39;yes&#39; : &#39;no&#39; %]</pre>

<p>When called without any argument, <code>list.defined</code> returns true if the list itself is defined (e.g. the same effect as <code>scalar.defined</code>).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="reverse"
>reverse</a></h2>

<p>Returns the items of the list in reverse order.</p>

<pre>    [% FOREACH s IN scores.reverse %]
       ...
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="join"
>join</a></h2>

<p>Joins the items in the list into a single string, using Perl&#39;s <code>join()</code> function.</p>

<pre>    [% items.join(&#39;, &#39;) %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="grep"
>grep</a></h2>

<p>Returns a list of the items in the list that match a regular expression pattern.</p>

<pre>    [% FOREACH directory.files.grep(&#39;\.txt$&#39;) %]
       ...
    [% END %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sort,_nsort"
>sort, nsort</a></h2>

<p>Returns the items in alpha (<code>sort</code>) or numerical (<code>nsort</code>) order.</p>

<pre>    [% library = books.sort %]</pre>

<p>An argument can be provided to specify a search key. Where an item in the list is a hash reference, the search key will be used to retrieve a value from the hash which will then be used as the comparison value. Where an item is an object which implements a method of that name, the method will be called to return a comparison value.</p>

<pre>    [% library = books.sort(&#39;author&#39;) %]</pre>

<p>In the example, the <code>books</code> list can contains hash references with an <code>author</code> key or objects with an <code>author</code> method.</p>

<p>You can also specify multiple sort keys.</p>

<pre>    [% library = books.sort(&#39;author&#39;, &#39;title&#39;) %]</pre>

<p>In this case the books will be sorted primarily by author. If two or more books have authors with the same name then they will be sorted by title.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="unshift(item),_push(item)"
>unshift(item), push(item)</a></h2>

<p>The <code>push()</code> method adds an item or items to the end of list.</p>

<pre>    [% mylist.push(foo) %]
    [% mylist.push(foo, bar) %]</pre>

<p>The <code>unshift()</code> method adds an item or items to the start of a list.</p>

<pre>    [% mylist.unshift(foo) %]
    [% mylist.push(foo, bar)    %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="shift,_pop"
>shift, pop</a></h2>

<p>Removes the first/last item from the list and returns it.</p>

<pre>    [% first = mylist.shift %]
    [% last  = mylist.pop   %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="unique"
>unique</a></h2>

<p>Returns a list of the unique elements in a list, in the same order as in the list itself.</p>

<pre>    [% mylist = [ 1, 2, 3, 2, 3, 4, 1, 4, 3, 4, 5 ] %]
    [% numbers = mylist.unique %]</pre>

<p>While this can be explicitly sorted, it is not required that the list be sorted before the unique elements are pulled out (unlike the Unix command line utility).</p>

<pre>    [% numbers = mylist.unique.sort %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="import"
>import</a></h2>

<p>Appends the contents of one or more other lists to the end of the current list.</p>

<pre>    [% one   = [ 1 2 3 ];
       two   = [ 4 5 6 ];
       three = [ 7 8 9 ];
       one.import(two, three);
       one.join(&#39;, );     # 1, 2, 3, 4, 5, 6, 7, 8, 9
    %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="merge"
>merge</a></h2>

<p>Returns a list composed of zero or more other lists:</p>

<pre>    [% list_one = [ 1 2 3 ];
       list_two = [ 4 5 6 ];
       list_three = [ 7 8 9 ];
       list_four = list_one.merge(list_two, list_three);
    %]</pre>

<p>The original lists are not modified.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="slice(from,_to)"
>slice(from, to)</a></h2>

<p>Returns a slice of items in the list between the bounds passed as arguments. If the second argument, <code>to</code>, isn&#39;t specified, then it defaults to the last item in the list. The original list is not modified.</p>

<pre>    [% first_three = list.slice(0,2) %]
    [% last_three  = list.slice(-3, -1) %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="splice(offset,_length,_list)"
>splice(offset, length, list)</a></h2>

<p>Behaves just like Perl&#39;s <code>splice()</code> function allowing you to selectively remove and/or replace elements in a list. It removes <code>length</code> items from the list, starting at <code>offset</code> and replaces them with the items in <code>list</code>.</p>

<pre>    [% play_game = [ &#39;play&#39;, &#39;scrabble&#39; ];
       ping_pong = [ &#39;ping&#39;, &#39;pong&#39; ];
       redundant = play_game.splice(1, 1, ping_pong);
       redundant.join;     # scrabble
       play_game.join;     # play ping pong
    %]</pre>

<p>The method returns a list of the items removed by the splice. You can use the <code>CALL</code> directive to ignore the output if you&#39;re not planning to do anything with it.</p>

<pre>    [% CALL play_game.splice(1, 1, ping_pong) %]</pre>

<p>As well as providing a reference to a list of replacement values, you can pass in a list of items.</p>

<pre>    [% CALL list.splice(-1, 0, &#39;foo&#39;, &#39;bar&#39;) %]</pre>

<p>Be careful about passing just one item in as a replacement value. If it is a reference to a list then the contents of the list will be used. If it&#39;s not a list, then it will be treated as a single value. You can use square brackets around a single item if you need to be explicit:</p>

<pre>    [% # push a single item, an_item
       CALL list.splice(-1, 0, an_item);

       # push the items from another_list
       CALL list.splice(-1, 0, another_list);

       # push a reference to another_list
       CALL list.splice(-1, 0, [ another_list ]);
    %]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="hash"
>hash</a></h2>

<p>Returns a reference to a hash array comprised of the elements in the list. The even-numbered elements (0, 2, 4, etc) become the keys and the odd-numbered elements (1, 3, 5, etc) the values.</p>

<pre>    [% list = [&#39;pi&#39;, 3.14, &#39;e&#39;, 2.718] %]
    [% hash = list.hash %]
    [% hash.pi %]               # 3.14
    [% hash.e  %]               # 2.718</pre>

<p>If a numerical argument is provided then the hash returned will have keys generated for each item starting at the number specified.</p>

<pre>    [% list = [&#39;beer&#39;, &#39;peanuts&#39;] %]
    [% hash = list.hash(1) %]
    [% hash.1  %]               # beer
    [% hash.2  %]               # peanuts</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Automagic_Promotion_of_Scalar_to_List_for_Virtual_Methods"
>Automagic Promotion of Scalar to List for Virtual Methods</a></h1>

<p>In addition to the scalar virtual methods listed in the previous section, you can also call any list virtual method against a scalar. The item will be automagically promoted to a single element list and the appropriate list virtual method will be called.</p>

<p>One particular benefit of this comes when calling subroutines or object methods that return a list of items, rather than the preferred reference to a list of items. In this case, the Template Toolkit automatically folds the items returned into a list.</p>

<p>The upshot is that you can continue to use existing Perl modules or code that returns lists of items, without having to refactor it just to keep the Template Toolkit happy (by returning references to list). <code>Class::DBI</code> module is just one example of a particularly useful module which returns values this way.</p>

<p>If only a single item is returned from a subroutine then the Template Toolkit assumes it meant to return a single item (rather than a list of 1 item) and leaves it well alone, returning the single value as it is. If you&#39;re executing a database query, for example, you might get 1 item returned, or perhaps many items which are then folded into a list.</p>

<p>The <code>FOREACH</code> directive will happily accept either a list or a single item which it will treat as a list. So it&#39;s safe to write directives like this, where we assume that the <code>something</code> variable is bound to a subroutine which may return one or more items:</p>

<pre>    [% FOREACH item IN something %]
       ...
    [% END %]</pre>

<p>The automagic promotion of scalars to single item lists means that you can also use list virtual methods safely, even if you only get one item returned. For example:</p>

<pre>    [% something.first   %]
    [% something.join    %]
    [% something.reverse.join(&#39;, &#39;) %]</pre>

<p>Note that this is very much a last-ditch behaviour. If the single item return is an object with a <code>first</code> method, for example, then that will be called, as expected, in preference to the list virtual method.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Defining_Custom_Virtual_Methods"
>Defining Custom Virtual Methods</a></h1>

<p>You can define your own virtual methods for scalars, lists and hash arrays. The <a href="../../Template/Stash.html" class="podlinkpod"
>Template::Stash</a> package variables <code>$SCALAR_OPS</code>, <code>$LIST_OPS</code> and <code>$HASH_OPS</code> are references to hash arrays that define these virtual methods. <code>HASH_OPS</code> and <code>LIST_OPS</code> methods are subroutines that accept a hash/list reference as the first item. <code>SCALAR_OPS</code> are subroutines that accept a scalar value as the first item. Any other arguments specified when the method is called will be passed to the subroutine.</p>

<pre>    # load Template::Stash to make method tables visible
    use Template::Stash;

    # define list method to return new list of odd numbers only
    $Template::Stash::LIST_OPS-&#62;{ odd } = sub {
        my $list = shift;
        return [ grep { $_ % 2 } @$list ];
    };</pre>

<p>Example template:</p>

<pre>    [% primes = [ 2, 3, 5, 7, 9 ] %]
    [% primes.odd.join(&#39;, &#39;) %]         # 3, 5, 7, 9</pre>

<p>TODO: document the define_vmethod() method which makes this even easier</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
