<html><head><title>Template::Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:27 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new(%5C%25config)'>new(\%config)</a>
    <li class='indexItem indexItem2'><a href='#process(%24context)'>process($context)</a>
    <li class='indexItem indexItem2'><a href='#block()'>block()</a>
    <li class='indexItem indexItem2'><a href='#blocks()'>blocks()</a>
    <li class='indexItem indexItem2'><a href='#variables()'>variables()</a>
    <li class='indexItem indexItem2'><a href='#AUTOLOAD'>AUTOLOAD</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#CLASS_METHODS'>CLASS METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#as_perl(%24content)'>as_perl($content)</a>
    <li class='indexItem indexItem2'><a href='#write_perl_file(%5C%25config)'>write_perl_file(\%config)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_FUNCTIONS'>INTERNAL FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#catch_warnings()'>catch_warnings()</a>
    <li class='indexItem indexItem2'><a href='#is_utf8()'>is_utf8()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Template::Document - Compiled template document object</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Template::Document;
    
    $doc = Template::Document-&#62;new({
        BLOCK =&#62; sub { # some perl code; return $some_text },
        DEFBLOCKS =&#62; {
            header =&#62; sub { # more perl code; return $some_text },
            footer =&#62; sub { # blah blah blah; return $some_text },
        },
        METADATA =&#62; {
            author  =&#62; &#39;Andy Wardley&#39;,
            version =&#62; 3.14,
        }
    }) || die $Template::Document::ERROR;
    
    print $doc-&#62;process($context);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module defines an object class whose instances represent compiled template documents. The <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a> module creates a <code>Template::Document</code> instance to encapsulate a template as it is compiled into Perl code.</p>

<p>The constructor method, <a href="../new().html" class="podlinkpod"
>new()</a>, expects a reference to a hash array containing the <code>BLOCK</code>, <code>DEFBLOCKS</code> and <code>METADATA</code> items.</p>

<p>The <code>BLOCK</code> item should contain a reference to a Perl subroutine or a textual representation of Perl code, as generated by the <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a> module. This is then evaluated into a subroutine reference using <code>eval()</code>.</p>

<p>The <code>DEFLOCKS</code> item should reference a hash array containing further named <code>BLOCK</code>s which may be defined in the template. The keys represent <code>BLOCK</code> names and the values should be subroutine references or text strings of Perl code as per the main <code>BLOCK</code> item.</p>

<p>The <code>METADATA</code> item should reference a hash array of metadata items relevant to the document.</p>

<p>The <a href="../process().html" class="podlinkpod"
>process()</a> method can then be called on the instantiated <code>Template::Document</code> object, passing a reference to a <a href="../Template/Context.html" class="podlinkpod"
>Template::Context</a> object as the first parameter. This will install any locally defined blocks (<code>DEFBLOCKS</code>) in the <code>BLOCKS</code> cache in the context (via a call to <a href="../Template/Context%23visit().html" class="podlinkpod"
>visit()</a>) so that they may be subsequently resolved by the context. The main <code>BLOCK</code> subroutine is then executed, passing the context reference on as a parameter. The text returned from the template subroutine is then returned by the <a href="../process().html" class="podlinkpod"
>process()</a> method, after calling the context <a href="../Template/Context%23leave().html" class="podlinkpod"
>leave()</a> method to permit cleanup and de-registration of named <code>BLOCKS</code> previously installed.</p>

<p>An <code>AUTOLOAD</code> method provides access to the <code>METADATA</code> items for the document. The <a href="../Template/Service.html" class="podlinkpod"
>Template::Service</a> module installs a reference to the main <code>Template::Document</code> object in the stash as the <code>template</code> variable. This allows metadata items to be accessed from within templates, including <code>PRE_PROCESS</code> templates.</p>

<p>header:</p>

<pre>    &#60;html&#62;
    &#60;head&#62;
    &#60;title&#62;[% template.title %]
    &#60;/head&#62;
    ...</pre>

<p><code>Template::Document</code> objects are usually created by the <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a> but can be manually instantiated or sub-classed to provide custom template components.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new(\%config)"
>new(\%config)</a></h2>

<p>Constructor method which accept a reference to a hash array containing the structure as shown in this example:</p>

<pre>    $doc = Template::Document-&#62;new({
        BLOCK =&#62; sub { # some perl code; return $some_text },
        DEFBLOCKS =&#62; {
            header =&#62; sub { # more perl code; return $some_text },
            footer =&#62; sub { # blah blah blah; return $some_text },
        },
        METADATA =&#62; {
            author  =&#62; &#39;Andy Wardley&#39;,
            version =&#62; 3.14,
        }
    }) || die $Template::Document::ERROR;</pre>

<p><code>BLOCK</code> and <code>DEFBLOCKS</code> items may be expressed as references to Perl subroutines or as text strings containing Perl subroutine definitions, as is generated by the <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a> module. These are evaluated into subroutine references using <code>eval()</code>.</p>

<p>Returns a new <code>Template::Document</code> object or <code>undef</code> on error. The <a href="../Template/Base%23error().html" class="podlinkpod"
>error()</a> class method can be called, or the <code>$ERROR</code> package variable inspected to retrieve the relevant error message.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="process($context)"
>process($context)</a></h2>

<p>Main processing routine for the compiled template document. A reference to a <a href="../Template/Context.html" class="podlinkpod"
>Template::Context</a> object should be passed as the first parameter. The method installs any locally defined blocks via a call to the context <a href="../Template/Context%23visit().html" class="podlinkpod"
>visit()</a> method, processes its own template, (passing the context reference as a parameter) and then calls <a href="../Template/Context%23leave().html" class="podlinkpod"
>leave()</a> in the context to allow cleanup.</p>

<pre>    print $doc-&#62;process($context);</pre>

<p>Returns a text string representing the generated output for the template. Errors are thrown via <code>die()</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="block()"
>block()</a></h2>

<p>Returns a reference to the main <code>BLOCK</code> subroutine.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="blocks()"
>blocks()</a></h2>

<p>Returns a reference to the hash array of named <code>DEFBLOCKS</code> subroutines.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="variables()"
>variables()</a></h2>

<p>Returns a reference to a hash of variables used in the template. This requires the <a href="../Template/Manual/Config%23TRACE_VARS.html" class="podlinkpod"
>TRACE_VARS</a> option to be enabled.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AUTOLOAD"
>AUTOLOAD</a></h2>

<p>An autoload method returns <code>METADATA</code> items.</p>

<pre>    print $doc-&#62;author();</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CLASS_METHODS"
>CLASS METHODS</a></h1>

<p>These methods are used internally.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="as_perl($content)"
>as_perl($content)</a></h2>

<p>This method generate a Perl representation of the template.</p>

<pre>    my $perl = Template::Document-&#62;as_perl({
        BLOCK     =&#62; $main_block,
        DEFBLOCKS =&#62; {
            foo   =&#62; $foo_block,
            bar   =&#62; $bar_block,
        },
        METADATA  =&#62; {
            name  =&#62; &#39;my_template&#39;,
        }
    });</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="write_perl_file(\%config)"
>write_perl_file(\%config)</a></h2>

<p>This method is used to write compiled Perl templates to disk. If the <code>COMPILE_EXT</code> option (to indicate a file extension for saving compiled templates) then the <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a> module calls this subroutine before calling the <a href="../new().html" class="podlinkpod"
>new()</a> constructor. At this stage, the parser has a representation of the template as text strings containing Perl code. We can write that to a file, enclosed in a small wrapper which will allow us to susequently <code>require()</code> the file and have Perl parse and compile it into a <code>Template::Document</code>. Thus we have persistence of compiled templates.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_FUNCTIONS"
>INTERNAL FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="catch_warnings()"
>catch_warnings()</a></h2>

<p>This is a simple handler used to catch any errors that arise when the compiled Perl template is first evaluated (that is, evaluated by Perl to create a template subroutine at compile, rather than the template being processed at runtime).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_utf8()"
>is_utf8()</a></h2>

<p>This is mapped to <code>utf8::is_utf8</code> for versions of Perl that have it (&#62; 5.008) or to <code>Encode::is_utf8</code> for Perl 5.008. Earlier versions of Perl are not supported.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Andy Wardley &#60;abw@wardley.org&#62; <a href="http://wardley.org/" class="podlinkurl"
>http://wardley.org/</a></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (C) 1996-2012 Andy Wardley. All Rights Reserved.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../Template.html" class="podlinkpod"
>Template</a>, <a href="../Template/Parser.html" class="podlinkpod"
>Template::Parser</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
