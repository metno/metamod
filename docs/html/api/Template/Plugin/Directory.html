<html><head><title>Template::Plugin::Directory</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:27 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#AUTHORS'>AUTHORS</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Template::Plugin::Directory - Plugin for generating directory listings</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    [% USE dir = Directory(dirpath) %]
    
    # files returns list of regular files
    [% FOREACH file = dir.files %]
       [% file.name %] [% file.path %] ...
    [% END %]
    
    # dirs returns list of sub-directories
    [% FOREACH subdir = dir.dirs %]
       [% subdir.name %] [% subdir.path %] ...
    [% END %]
    
    # list returns both interleaved in order
    [% FOREACH item = dir.list %]
       [% IF item.isdir %]
          Directory: [% item.name %]
       [% ELSE %]
          File: [% item.name %]
       [% END %]
    [% END %]
    
    # define a VIEW to display dirs/files
    [% VIEW myview %]
       [% BLOCK file %]
       File: [% item.name %]
       [% END %]
       
       [% BLOCK directory %]
       Directory: [% item.name %] 
       [% item.content(myview) | indent -%]
       [% END %]
    [% END %]
    
    # display directory content using view
    [% myview.print(dir) %]</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This Template Toolkit plugin provides a simple interface to directory listings. It is derived from the <a href="../../Template/Plugin/File.html" class="podlinkpod"
>Template::Plugin::File</a> module and uses <a href="../../Template/Plugin/File.html" class="podlinkpod"
>Template::Plugin::File</a> object instances to represent files within a directory. Sub-directories within a directory are represented by further <code>Template::Plugin::Directory</code> instances.</p>

<p>The constructor expects a directory name as an argument.</p>

<pre>    [% USE dir = Directory(&#39;/tmp&#39;) %]</pre>

<p>It then provides access to the files and sub-directories contained within the directory.</p>

<pre>    # regular files (not directories)
    [% FOREACH file IN dir.files %]
       [% file.name %]
    [% END %]

    # directories only
    [% FOREACH file IN dir.dirs %]
       [% file.name %]
    [% END %]

    # files and/or directories
    [% FOREACH file IN dir.list %]
       [% file.name %] ([% file.isdir ? &#39;directory&#39; : &#39;file&#39; %])
    [% END %]</pre>

<p>The plugin constructor will throw a <code>Directory</code> error if the specified path does not exist, is not a directory or fails to <code>stat()</code> (see <a href="../../Template/Plugin/File.html" class="podlinkpod"
>Template::Plugin::File</a>). Otherwise, it will scan the directory and create lists named &#39;<code>files</code>&#39; containing files, &#39;<code>dirs</code>&#39; containing directories and &#39;<code>list</code>&#39; containing both files and directories combined. The <code>nostat</code> option can be set to disable all file/directory checks and directory scanning.</p>

<p>Each file in the directory will be represented by a <a href="../../Template/Plugin/File.html" class="podlinkpod"
>Template::Plugin::File</a> object instance, and each directory by another <code>Template::Plugin::Directory</code>. If the <code>recurse</code> flag is set, then those directories will contain further nested entries, and so on. With the <code>recurse</code> flag unset, as it is by default, then each is just a place marker for the directory and does not contain any further content unless its <code>scan()</code> method is explicitly called. The <code>isdir</code> flag can be tested against files and/or directories, returning true if the item is a directory or false if it is a regular file.</p>

<pre>    [% FOREACH file = dir.list %]
       [% IF file.isdir %]
          * Directory: [% file.name %]
       [% ELSE %]
          * File: [% file.name %]
       [% END %]
    [% END %]</pre>

<p>This example shows how you might walk down a directory tree, displaying content as you go. With the recurse flag disabled, as is the default, we need to explicitly call the <code>scan()</code> method on each directory, to force it to lookup files and further sub-directories contained within.</p>

<pre>    [% USE dir = Directory(dirpath) %]
    * [% dir.path %]
    [% INCLUDE showdir %]
    
    [% BLOCK showdir -%]
      [% FOREACH file = dir.list -%]
        [% IF file.isdir -%]
        * [% file.name %]
          [% file.scan -%]
          [% INCLUDE showdir dir=file FILTER indent(4) -%]
        [% ELSE -%]
        - [% f.name %]
        [% END -%]
      [% END -%]
     [% END %]</pre>

<p>This example is adapted (with some re-formatting for clarity) from a test in <em>t/directry.t</em> which produces the following output:</p>

<pre>    * test/dir
        - file1
        - file2
        * sub_one
            - bar
            - foo
        * sub_two
            - waz.html
            - wiz.html
        - xyzfile</pre>

<p>The <code>recurse</code> flag can be set (disabled by default) to cause the constructor to automatically recurse down into all sub-directories, creating a new <code>Template::Plugin::Directory</code> object for each one and filling it with any further content. In this case there is no need to explicitly call the <code>scan()</code> method.</p>

<pre>    [% USE dir = Directory(dirpath, recurse=1) %]
       ...
       
        [% IF file.isdir -%]
        * [% file.name %]
          [% INCLUDE showdir dir=file FILTER indent(4) -%]
        [% ELSE -%]
           ...</pre>

<p>The directory plugin also provides support for views. A view can be defined as a <code>VIEW ... END</code> block and should contain <code>BLOCK</code> definitions for files (&#39;<code>file</code>&#39;) and directories (&#39;<code>directory</code>&#39;).</p>

<pre>    [% VIEW myview %]
    [% BLOCK file %]
       - [% item.name %]
    [% END %]
    
    [% BLOCK directory %]
       * [% item.name %]
         [% item.content(myview) FILTER indent %]
    [% END %]
    [% END %]</pre>

<p>The view <code>print()</code> method can then be called, passing the <code>Directory</code> object as an argument.</p>

<pre>    [% USE dir = Directory(dirpath, recurse=1) %]
    [% myview.print(dir) %]</pre>

<p>When a directory is presented to a view, either as <code>[% myview.print(dir) %]</code> or <code>[% dir.present(view) %]</code>, then the <code>directory</code> <code>BLOCK</code> within the <code>myview</code> <code>VIEW</code> is processed. The <code>item</code> variable will be set to alias the <code>Directory</code> object.</p>

<pre>    [% BLOCK directory %]
       * [% item.name %]
         [% item.content(myview) FILTER indent %]
    [% END %]</pre>

<p>In this example, the directory name is first printed and the content(view) method is then called to present each item within the directory to the view. Further directories will be mapped to the <code>directory</code> block, and files will be mapped to the <code>file</code> block.</p>

<p>With the recurse option disabled, as it is by default, the <code>directory</code> block should explicitly call a <code>scan()</code> on each directory.</p>

<pre>    [% VIEW myview %]
    [% BLOCK file %]
       - [% item.name %]
    [% END %]
    
    [% BLOCK directory %]
       * [% item.name %]
         [% item.scan %]
         [% item.content(myview) FILTER indent %]
    [% END %]
    [% END %]
    
    [% USE dir = Directory(dirpath) %]
    [% myview.print(dir) %]</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHORS"
>AUTHORS</a></h1>

<p>Michael Stevens wrote the original Directory plugin on which this is based. Andy Wardley split it into separate <a href="../../Template/Plugin/File.html" class="podlinkpod"
>File</a> and <a href="../../Template/Plugin/Directory.html" class="podlinkpod"
>Directory</a> plugins, added some extra code and documentation for <code>VIEW</code> support, and made a few other minor tweaks.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<p>Copyright (C) 2000-2007 Michael Stevens, Andy Wardley.</p>

<p>This module is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../Template/Plugin.html" class="podlinkpod"
>Template::Plugin</a>, <a href="../../Template/Plugin/File.html" class="podlinkpod"
>Template::Plugin::File</a>, <a href="../../Template/View.html" class="podlinkpod"
>Template::View</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
