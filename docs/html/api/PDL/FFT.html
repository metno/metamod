<html><head><title>PDL::FFT</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:23 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DATA_TYPES'>DATA TYPES</a>
  <li class='indexItem indexItem1'><a href='#FREQUENCIES'>FREQUENCIES</a>
  <li class='indexItem indexItem1'><a href='#ALTERNATIVE_FFT_PACKAGES'>ALTERNATIVE FFT PACKAGES</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#fft()'>fft()</a>
    <li class='indexItem indexItem2'><a href='#ifft()'>ifft()</a>
    <li class='indexItem indexItem2'><a href='#realfft()'>realfft()</a>
    <li class='indexItem indexItem2'><a href='#realifft()'>realifft()</a>
    <li class='indexItem indexItem2'><a href='#fftnd()'>fftnd()</a>
    <li class='indexItem indexItem2'><a href='#ifftnd()'>ifftnd()</a>
    <li class='indexItem indexItem2'><a href='#fftconvolve()'>fftconvolve()</a>
    <li class='indexItem indexItem2'><a href='#convmath'>convmath</a>
    <li class='indexItem indexItem2'><a href='#cmul'>cmul</a>
    <li class='indexItem indexItem2'><a href='#cdiv'>cdiv</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#BUGS'>BUGS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>PDL::FFT - FFTs for PDL</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>FFTs for PDL.
These work for arrays of any dimension,
although ones with small prime factors are likely to be the quickest.</p>

<p>For historical reasons,
these routines work in-place and do not recognize the in-place flag.
That should be fixed.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>        use PDL::FFT qw/:Func/;

        fft($real, $imag);
        ifft($real, $imag);
        realfft($real);
        realifft($real);

        fftnd($real,$imag);
        ifftnd($real,$imag);

        $kernel = kernctr($image,$smallk);
        fftconvolve($image,$kernel);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DATA_TYPES"
>DATA TYPES</a></h1>

<p>The underlying C library upon which this module is based performs FFTs on both single precision and double precision floating point piddles. Performing FFTs on integer data types is not reliable. Consider the following FFT on piddles of type &#39;double&#39;:</p>

<pre>        $r = pdl(0,1,0,1);
        $i = zeroes($r);
        fft($r,$i);
        print $r,$i;
        [2 0 -2 0] [0 0 0 0]</pre>

<p>But if $r and $i are unsigned short integers (ushorts):</p>

<pre>        $r = pdl(ushort,0,1,0,1);
        $i = zeroes($r);
        fft($r,$i);
        print $r,$i;
        [2 0 65534 0] [0 0 0 0]</pre>

<p>This used to occur because <a href="../PDL/PP.html" class="podlinkpod"
>PDL::PP</a> converts the ushort piddles to floats or doubles, performs the FFT on them, and then converts them back to ushort, causing the overflow where the amplitude of the frequency should be -2.</p>

<p>Therefore, if you pass in a piddle of integer datatype (byte, short, ushort, long) to any of the routines in PDL::FFT, your data will be promoted to a double-precision piddle. If you pass in a float, the single-precision FFT will be performed.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FREQUENCIES"
>FREQUENCIES</a></h1>

<p>For even-sized input arrays, the frequencies are packed like normal for FFTs (where N is the size of the array and D is the physical step size between elements):</p>

<pre> 0, 1/ND, 2/ND, ..., (N/2-1)/ND, 1/2D, -(N/2-1)/ND, ..., -1/ND.</pre>

<p>which can easily be obtained (taking the Nyquist frequency to be positive) using</p>

<p><code>$kx = $real-&#62;xlinvals(-($N/2-1)/$N/$D,1/2/$D)-&#62;rotate(-($N/2 -1));</code></p>

<p>For odd-sized input arrays the Nyquist frequency is not directly acessible, and the frequencies are</p>

<pre> 0, 1/ND, 2/ND, ..., (N/2-0.5)/ND, -(N/2-0.5)/ND, ..., -1/ND.</pre>

<p>which can easily be obtained using</p>

<p><code>$kx = $real-&#62;xlinvals(-($N/2-0.5)/$N/$D,($N/2-0.5)/$N/$D)-&#62;rotate(-($N-1)/2);</code></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ALTERNATIVE_FFT_PACKAGES"
>ALTERNATIVE FFT PACKAGES</a></h1>

<p>Various other modules - such as <a href="../PDL/FFTW.html" class="podlinkpod"
>PDL::FFTW</a> and <a href="../PDL/Slatec.html" class="podlinkpod"
>PDL::Slatec</a> - contain FFT routines. However, unlike PDL::FFT, these modules are optional, and so may not be installed.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="fft()"
>fft()</a></h2>

<p>Complex FFT of the &#34;real&#34; and &#34;imag&#34; arrays [inplace].</p>

<p>fft($real,$imag);</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ifft()"
>ifft()</a></h2>

<p>Complex inverse FFT of the &#34;real&#34; and &#34;imag&#34; arrays [inplace].</p>

<p>ifft($real,$imag);</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="realfft()"
>realfft()</a></h2>

<p>One-dimensional FFT of real function [inplace].</p>

<p>The real part of the transform ends up in the first half of the array and the imaginary part of the transform ends up in the second half of the array.</p>

<pre>        realfft($real);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="realifft()"
>realifft()</a></h2>

<p>Inverse of one-dimensional realfft routine [inplace].</p>

<pre>        realifft($real);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="fftnd()"
>fftnd()</a></h2>

<p>N-dimensional FFT (inplace)</p>

<pre>        fftnd($real,$imag);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ifftnd()"
>ifftnd()</a></h2>

<p>N-dimensional inverse FFT</p>

<pre>        ifftnd($real,$imag);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="fftconvolve()"
>fftconvolve()</a></h2>

<p>N-dimensional convolution with periodic boundaries (FFT method)</p>

<pre>        $kernel = kernctr($image,$smallk);
        fftconvolve($image,$kernel);</pre>

<p>fftconvolve works inplace, and returns an error array in kernel as an accuracy check -- all the values in it should be negligible.</p>

<p>See also <a href="../PDL/ImageND.html#convolveND" class="podlinkpod"
>PDL::ImageND::convolveND</a>, which performs speed-optimized convolution with a variety of boundary conditions.</p>

<p>The sizes of the image and the kernel must be the same. <a href="../PDL/ImageND.html#kernctr" class="podlinkpod"
>kernctr</a> centres a small kernel to emulate the behaviour of the direct convolution routines.</p>

<p>The speed cross-over between using straight convolution (<a href="../PDL/Image2D.html#conv2d" class="podlinkpod"
>PDL::Image2D::conv2d()</a>) and these fft routines is for kernel sizes roughly 7x7.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="convmath"
>convmath</a></h2>

<pre>  Signature: ([o,nc]a(m); [o,nc]b(m))</pre>

<p>Internal routine doing maths for convolution</p>

<p>convmath does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="cmul"
>cmul</a></h2>

<pre>  Signature: (ar(); ai(); br(); bi(); [o]cr(); [o]ci())</pre>

<p>Complex multiplication</p>

<p>cmul does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="cdiv"
>cdiv</a></h2>

<pre>  Signature: (ar(); ai(); br(); bi(); [o]cr(); [o]ci())</pre>

<p>Complex division</p>

<p>cdiv does not process bad values. It will set the bad-value flag of all output piddles if the flag is set for any of the input piddles.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS</a></h1>

<p>Where the source is marked `FIX&#39;, could re-implement using phase-shift factors on the transforms and some real-space bookkeeping, to save some temporary space and redundant transforms.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>This file copyright (C) 1997, 1998 R.J.R. Williams (rjrw@ast.leeds.ac.uk), Karl Glazebrook (kgb@aaoepp.aao.gov.au), Tuomas J. Lukka, (lukka@husc.harvard.edu). All rights reserved. There is no warranty. You are allowed to redistribute this software / documentation under certain conditions. For details, see the file COPYING in the PDL distribution. If this file is separated from the PDL distribution, the copyright notice should be included in the file.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
