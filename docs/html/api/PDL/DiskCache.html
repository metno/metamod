<html><head><title>PDL::DiskCache</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:23 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#Shortcomings_%26_caveats'>Shortcomings &#38; caveats</a>
  <li class='indexItem indexItem1'><a href='#Author%2C_license%2C_no_warranty'>Author, license, no warranty</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#diskcache'>diskcache</a>
    <li class='indexItem indexItem2'><a href='#TIEARRAY'>TIEARRAY</a>
    <li class='indexItem indexItem2'><a href='#purge'>purge</a>
    <li class='indexItem indexItem2'><a href='#sync'>sync</a>
    <li class='indexItem indexItem2'><a href='#DESTROY'>DESTROY</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>PDL::DiskCache -- Non-memory-resident array object</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>NON-OO:</p>

<pre>   use PDL::DiskCache;
   tie @a,&#39;PDL::DiskCache&#39;, \@files, \%options;
   imag $a[3];</pre>

<p>OO:</p>

<pre>   use PDL::DiskCache;
   $a = diskcache(\@files,\%options);
   imag $a-&#62;[3];</pre>

<p>or</p>

<pre>   use PDL::DiskCache;
   $a = new PDL::DiskCache(\@files,\%options);
   imag $a-&#62;[4];</pre>

<dl>
<dt><a name="\@files"
>\@files</a></dt>

<dd>
<p>an array ref containing a list of file names</p>

<dt><a name="\%options"
>\%options</a></dt>

<dd>
<p>a hash ref containing options for the PDL::DiskCache object (see &#34;TIEARRAY&#34; below for details)</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>A PDL::DiskCache object is a perl <a href="../perltie.html" class="podlinkpod"
>&#34;tied array&#34;</a> that is useful for operations where you have to look at a large collection of PDLs one or a few at a time (such as tracking features through an image sequence). You can write prototype code that uses a perl list of a few PDLs, then scale up to to millions of PDLs simply by handing the prototype code a DiskCache tied array instead of a native perl array. The individual PDLs are stored on disk and a few of them are swapped into memory on a FIFO basis. You can set whether the data are read-only or writeable.</p>

<p>By default, PDL::DiskCache uses FITS files to represent the PDLs, but you can use any sort of file at all -- the read/write routines are the only place where it examines the underlying data, and you can specify the routines to use at construction time (or, of course, subclass PDL::DiskCache).</p>

<p>Items are swapped out on a FIFO basis, so if you have 10 slots and an expression with 10 items in it then you&#39;re OK (but you probably want more slots than that); but if you use more items in an expression than there are slots, thrashing will occur!</p>

<p>The hash ref interface is kept for historical reasons; you can access the sync() and purge() method calls directly from the returned array ref.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Shortcomings_&#38;_caveats"
>Shortcomings &#38; caveats</a></h1>

<p>There&#39;s no file locking, so you could really hose yourself by having two of these things going at once on the same files.</p>

<p>Since this is a tied array, things like Dumper traverse it transparently. That is sort-of good but also sort-of dangerous. You wouldn&#39;t want to PDL::Dumper::sdump() a large PDL::DiskCache, for example -- that would defeat the purpose of using a PDL::DiskCache in the first place.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Author,_license,_no_warranty"
>Author, license, no warranty</a></h1>

<p>Copyright 2001, Craig DeForest</p>

<p>This code may be distributed under the same terms as Perl itself (license available at <a href="http://www.perl.org" class="podlinkurl"
>http://www.perl.org</a>). Copying, reverse engineering, distribution, and modification are explicitly allowed so long as this notice is preserved intact and modified versions are clearly marked as such.</p>

<p>If you modify the code and it&#39;s useful, please send a copy of the modified version to cdeforest@solar.stanford.edu.</p>

<p>This package comes with NO WARRANTY.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="diskcache"
>diskcache</a></h2>

<p>Object constructor.</p>

<pre>  $a = diskcache(\@f,\%options);</pre>

<p>Options</p>

<ul>
<li>See the TIEARRAY options,below.</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="TIEARRAY"
>TIEARRAY</a></h2>

<p>Tied-array constructor; invoked by perl during object construction.</p>

<pre>  TIEARRAY(class,\@f,\%options)</pre>

<p>Options</p>

<dl>
<dt><a name="ro_(default_0)"
>ro (default 0)</a></dt>

<dd>
<p>If set, treat the files as read-only (modifications to the tied array will only persist until the changed elements are swapped out)</p>

<dt><a name="rw_(default_1)"
>rw (default 1)</a></dt>

<dd>
<p>If set, allow reading and writing to the files. Because there&#39;s currently no way to determine reliably whether a PDL has been modified, rw files are always written to disk when they&#39;re swapped out -- this causes a slight performance hit.</p>

<dt><a name="mem_(default_20)"
>mem (default 20)</a></dt>

<dd>
<p>Number of files to be cached in memory at once.</p>

<dt><a name="read_(default_\&#38;rfits)"
>read (default \&#38;rfits)</a></dt>

<dd>
<p>A function ref pointing to code that will read list objects from disk. The function must have the same syntax as rfits: $object = rfits(filename).</p>

<dt><a name="write_(default_\&#38;wfits)"
>write (default \&#38;wfits)</a></dt>

<dd>
<p>A function ref pointing to code that will write list objects to disk. The function must have the same syntax as wfits: func(object,filename).</p>

<dt><a name="bless_(default_0)"
>bless (default 0)</a></dt>

<dd>
<p>If set to a nonzero value, then the array ref gets blessed into the DiskCache class for for easier access to the &#34;purge&#34; and &#34;sync&#34; methods. This means that you can say <code>$a-&#62;sync</code> instead of the more complex <code>(%{tied @$a})-&#62;sync</code>, but <code>ref $a</code> will return &#34;PDL::DiskCache&#34; instead of &#34;ARRAY&#34;, which could break some code.</p>

<dt><a name="verbose_(default_0)"
>verbose (default 0)</a></dt>

<dd>
<p>Get chatty.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="purge"
>purge</a></h2>

<p>Remove an item from the oldest slot in the cache, writing to disk as necessary. You also send in how many slots to purge (default 1; sending in -1 purges everything.)</p>

<p>For most uses, a nice MODIFIED flag in the data structure could save some hassle here. But PDLs can get modified out from under us with slicing and .= -- so for now we always assume everything is tainted and must be written to disk.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sync"
>sync</a></h2>

<p>In a rw cache, flush all items out to disk but retain them in the cache. This is useful primarily for cache protection and could be slow. Because we have no way of knowing what&#39;s modified and what&#39;s not in the cache, all elements are always flushed from an rw cache. For ro caches, this is a not-too-slow (but safe) no-op.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DESTROY"
>DESTROY</a></h2>

<p>This is the perl hook for object destruction. It just makes a call to &#34;sync&#34;, to flush the cache out to disk. Destructor calls from perl don&#39;t happen at a guaranteed time, so be sure to call &#34;sync&#34; if you need to ensure that the files get flushed out, e.g. to use &#39;em somewhere else.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
