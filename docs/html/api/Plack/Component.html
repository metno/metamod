<html><head><title>Plack::Component</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:25 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#REQUIRED_METHOD'>REQUIRED METHOD</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <li class='indexItem indexItem1'><a href='#OBJECT_LIFECYCLE'>OBJECT LIFECYCLE</a>
  <li class='indexItem indexItem1'><a href='#BACKWARDS_COMPATIBILITY'>BACKWARDS COMPATIBILITY</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Plack::Component - Base class for PSGI endpoints</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  package Plack::App::Foo;
  use parent qw( Plack::Component );

  sub call {
      my($self, $env) = @_;
      # Do something with $env

      my $res = ...; # create a response ...

      # return the response
      return $res;
  }</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Plack::Component is the base class shared between <a href="../Plack/Middleware.html" class="podlinkpod"
>Plack::Middleware</a> and <code>Plack::App::*</code> modules. If you are writing middleware, you should inherit from <a href="../Plack/Middleware.html" class="podlinkpod"
>Plack::Middleware</a>, but if you are writing a Plack::App::* you should inherit from this directly.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="REQUIRED_METHOD"
>REQUIRED METHOD</a></h1>

<dl>
<dt><a name="call_($env)"
>call ($env)</a></dt>

<dd>
<p>You are expected to implement a <code>call</code> method in your component. This is where all the work gets done. It receives the PSGI <code>$env</code> hash-ref as an argument and is expected to return a proper PSGI response value.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<dl>
<dt><a name="new_(%opts_|_\%opts)"
>new (%opts | \%opts)</a></dt>

<dd>
<p>The constructor accepts either a hash or a hashref and uses that to create the instance. It will call no other methods and simply return the instance that is created.</p>

<dt><a name="prepare_app"
>prepare_app</a></dt>

<dd>
<p>This method is called by <code>to_app</code> and is meant as a hook to be used to prepare your component before it is packaged as a PSGI <code>$app</code>.</p>

<dt><a name="to_app"
>to_app</a></dt>

<dd>
<p>This is the method used in several parts of the Plack infrastructure to convert your component into a PSGI <code>$app</code>. You should not ever need to override this method; it is recommended to use <code>prepare_app</code> and <code>call</code> instead.</p>

<dt><a name="response_cb"
>response_cb</a></dt>

<dd>
<p>This is a wrapper for <code>response_cb</code> in <a href="../Plack/Util.html" class="podlinkpod"
>Plack::Util</a>. See <a href="../Plack/Middleware.html#RESPONSE_CALLBACK" class="podlinkpod"
>&#34;RESPONSE CALLBACK&#34; in Plack::Middleware</a> for details.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OBJECT_LIFECYCLE"
>OBJECT LIFECYCLE</a></h1>

<p>Objects for the derived classes (Plack::App::* or Plack::Middleware::*) are created at the PSGI application compile phase using <code>new</code>, <code>prepare_app</code> and <code>to_app</code>, and the created object persists during the web server lifecycle, unless it is running on the non-persistent environment like CGI. <code>call</code> is invoked against the same object whenever a new request comes in.</p>

<p>You can check if it is running in a persistent environment by checking <code>psgi.run_once</code> key in the <code>$env</code> being true (non-persistent) or false (persistent), but it is best for you to write your middleware safely for a persistent environment. To accomplish that, you should avoid saving per-request data like <code>$env</code> in your object.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BACKWARDS_COMPATIBILITY"
>BACKWARDS COMPATIBILITY</a></h1>

<p>The <a href="../Plack/Middleware.html" class="podlinkpod"
>Plack::Middleware</a> module used to inherit from <a href="../Class/Accessor/Fast.html" class="podlinkpod"
>Class::Accessor::Fast</a>, which has been removed in favor of the <a href="../Plack/Util/Accessor.html" class="podlinkpod"
>Plack::Util::Accessor</a> module. When developing new components it is recommended to use <a href="../Plack/Util/Accessor.html" class="podlinkpod"
>Plack::Util::Accessor</a> like so:</p>

<pre>  use Plack::Util::Accessor qw( foo bar baz );</pre>

<p>However, in order to keep backwards compatibility this module provides a <code>mk_accessors</code> method similar to <a href="../Class/Accessor/Fast.html" class="podlinkpod"
>Class::Accessor::Fast</a>. New code should not use this and use <a href="../Plack/Util/Accessor.html" class="podlinkpod"
>Plack::Util::Accessor</a> instead.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../Plack.html" class="podlinkpod"
>Plack</a> <a href="../Plack/Builder.html" class="podlinkpod"
>Plack::Builder</a> <a href="../Plack/Middleware.html" class="podlinkpod"
>Plack::Middleware</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
