<html><head><title>Plack::Handler::FCGI</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:25 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#OPTIONS'>OPTIONS</a>
    <li class='indexItem indexItem2'><a href='#WEB_SERVER_CONFIGURATIONS'>WEB SERVER CONFIGURATIONS</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#nginx'>nginx</a>
      <li class='indexItem indexItem3'><a href='#Apache_mod_fastcgi'>Apache mod_fastcgi</a>
      <li class='indexItem indexItem3'><a href='#lighttpd'>lighttpd</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Authorization'>Authorization</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Plack::Handler::FCGI - FastCGI handler for Plack</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  # Run as a standalone daemon
  plackup -s FCGI --listen /tmp/fcgi.sock --daemonize --nproc 10

  # Run from your web server like mod_fastcgi
  #!/usr/bin/env plackup -s FCGI
  my $app = sub { ... };

  # Roll your own
  my $server = Plack::Handler::FCGI-&#62;new(
      nproc  =&#62; $num_proc,
      listen =&#62; [ $port_or_socket ],
      detach =&#62; 1,
  );
  $server-&#62;run($app);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This is a handler module to run any PSGI application as a standalone FastCGI daemon or a .fcgi script.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h2>

<dl>
<dt><a name="listen"
>listen</a></dt>

<dd>
<pre>    listen =&#62; [ &#39;/path/to/socket&#39; ]
    listen =&#62; [ &#39;:8080&#39; ]</pre>

<p>Listen on a socket path, hostname:port, or :port.</p>

<dt><a name="port"
>port</a></dt>

<dd>
<p>listen via TCP on port on all interfaces (Same as <code>listen =&#62; &#34;:$port&#34;</code>)</p>

<dt><a name="leave-umask"
>leave-umask</a></dt>

<dd>
<p>Set to 1 to disable setting umask to 0 for socket open</p>

<dt><a name="nointr"
>nointr</a></dt>

<dd>
<p>Do not allow the listener to be interrupted by Ctrl+C</p>

<dt><a name="nproc"
>nproc</a></dt>

<dd>
<p>Specify a number of processes for FCGI::ProcManager</p>

<dt><a name="pid"
>pid</a></dt>

<dd>
<p>Specify a filename for the pid file</p>

<dt><a name="manager"
>manager</a></dt>

<dd>
<p>Specify a FCGI::ProcManager sub-class</p>

<dt><a name="daemonize"
>daemonize</a></dt>

<dd>
<p>Daemonize the process.</p>

<dt><a name="proc-title"
>proc-title</a></dt>

<dd>
<p>Specify process title</p>

<dt><a name="keep-stderr"
>keep-stderr</a></dt>

<dd>
<p>Send STDERR to STDOUT instead of the webserver</p>

<dt><a name="backlog"
>backlog</a></dt>

<dd>
<p>Maximum length of the queue of pending connections</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WEB_SERVER_CONFIGURATIONS"
>WEB SERVER CONFIGURATIONS</a></h2>

<p>In all cases, you will want to install <a href="../../FCGI.html" class="podlinkpod"
>FCGI</a> and <a href="../../FCGI/ProcManager.html" class="podlinkpod"
>FCGI::ProcManager</a>. You may find it most convenient to simply install <a href="../../Task/Plack.html" class="podlinkpod"
>Task::Plack</a> which includes both of these.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="nginx"
>nginx</a></h3>

<p>This is an example nginx configuration to run your FCGI daemon on a Unix domain socket and run it at the server&#39;s root URL (/).</p>

<pre>  http {
    server {
      listen 3001;
      location / {
        set $script &#34;&#34;;
        set $path_info $uri;
        fastcgi_pass unix:/tmp/fastcgi.sock;
        fastcgi_param  SCRIPT_NAME      $script;
        fastcgi_param  PATH_INFO        $path_info;
        fastcgi_param  QUERY_STRING     $query_string;
        fastcgi_param  REQUEST_METHOD   $request_method;
        fastcgi_param  CONTENT_TYPE     $content_type;
        fastcgi_param  CONTENT_LENGTH   $content_length;
        fastcgi_param  REQUEST_URI      $request_uri;
        fastcgi_param  SERVER_PROTOCOL  $server_protocol;
        fastcgi_param  REMOTE_ADDR      $remote_addr;
        fastcgi_param  REMOTE_PORT      $remote_port;
        fastcgi_param  SERVER_ADDR      $server_addr;
        fastcgi_param  SERVER_PORT      $server_port;
        fastcgi_param  SERVER_NAME      $server_name;
      }
    }
  }</pre>

<p>If you want to host your application in a non-root path, then you should mangle this configuration to set the path to <code>SCRIPT_NAME</code> and the rest of the path in <code>PATH_INFO</code>.</p>

<p>See <a href="http://wiki.nginx.org/NginxFcgiExample" class="podlinkurl"
>http://wiki.nginx.org/NginxFcgiExample</a> for more details.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Apache_mod_fastcgi"
>Apache mod_fastcgi</a></h3>

<p>After installing <code>mod_fastcgi</code>, you should add the <code>FastCgiExternalServer</code> directive to your Apache config:</p>

<pre>  FastCgiExternalServer /tmp/myapp.fcgi -socket /tmp/fcgi.sock

  ## Then set up the location that you want to be handled by fastcgi:

  # EITHER from a given path
  Alias /myapp/ /tmp/myapp.fcgi/

  # OR at the root
  Alias / /tmp/myapp.fcgi/</pre>

<p>Now you can use plackup to listen to the socket that you&#39;ve just configured in Apache.</p>

<pre>  $  plackup -s FCGI --listen /tmp/myapp.sock psgi/myapp.psgi</pre>

<p>The above describes the &#34;standalone&#34; method, which is usually appropriate. There are other methods, described in more detail at <a href="../../Catalyst/Engine/FastCGI.html#Standalone_server_mode" class="podlinkpod"
>&#34;Standalone_server_mode&#34; in Catalyst::Engine::FastCGI</a> (with regards to Catalyst, but which may be set up similarly for Plack).</p>

<p>See also <a href="http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiExternalServer" class="podlinkurl"
>http://www.fastcgi.com/mod_fastcgi/docs/mod_fastcgi.html#FastCgiExternalServer</a> for more details.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="lighttpd"
>lighttpd</a></h3>

<p>To host the app in the root path, you&#39;re recommended to use lighttpd 1.4.23 or newer with <code>fix-root-scriptname</code> flag like below.</p>

<pre>  fastcgi.server = ( &#34;/&#34; =&#62;
     ((
       &#34;socket&#34; =&#62; &#34;/tmp/fcgi.sock&#34;,
       &#34;check-local&#34; =&#62; &#34;disable&#34;,
       &#34;fix-root-scriptname&#34; =&#62; &#34;enable&#34;,
     ))</pre>

<p>If you use lighttpd older than 1.4.22 where you don&#39;t have <code>fix-root-scriptname</code>, mouting apps under the root causes wrong <code>SCRIPT_NAME</code> and <code>PATH_INFO</code> set. Also, mouting under the empty root (<code>&#34;&#34;</code>) or a path that has a trailing slash would still cause weird values set even with <code>fix-root-scriptname</code>. In such cases you can use <a href="../../Plack/Middleware/LighttpdScriptNameFix.html" class="podlinkpod"
>Plack::Middleware::LighttpdScriptNameFix</a> to fix it.</p>

<p>To mount in the non-root path over TCP:</p>

<pre>  fastcgi.server = ( &#34;/foo&#34; =&#62;
     ((
       &#34;host&#34; = &#34;127.0.0.1&#34;,
       &#34;port&#34; = &#34;5000&#34;,
       &#34;check-local&#34; =&#62; &#34;disable&#34;,
     ))</pre>

<p>It&#39;s recommended that your mount path does <b>NOT</b> have the trailing slash. If you <i>really</i> need to have one, you should consider using <a href="../../Plack/Middleware/LighttpdScriptNameFix.html" class="podlinkpod"
>Plack::Middleware::LighttpdScriptNameFix</a> to fix the wrong <b>PATH_INFO</b> values set by lighttpd.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Authorization"
>Authorization</a></h2>

<p>Most fastcgi configuration does not pass <code>Authorization</code> headers to <code>HTTP_AUTHORIZATION</code> environment variable by default for security reasons. Authentication middleware such as <a href="../../Plack/Middleware/Auth/Basic.html" class="podlinkpod"
>Plack::Middleware::Auth::Basic</a> or <a href="../../Catalyst/Authentication/Credential/HTTP.html" class="podlinkpod"
>Catalyst::Authentication::Credential::HTTP</a> requires the variable to be set up. Plack::Handler::FCGI supports extracting the <code>Authorization</code> environment variable when it is configured that way.</p>

<p>Apache2 with mod_fastcgi:</p>

<pre>  --pass-header Authorization</pre>

<p>mod_fcgid:</p>

<pre>  FcgiPassHeader Authorization</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../Plack.html" class="podlinkpod"
>Plack</a></p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
