<html><head><title>Test::Files</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue May 27 09:39:30 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#ABSTRACT'>ABSTRACT</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#BUGS'>BUGS</a>
    <li class='indexItem indexItem2'><a href='#EXPORT'>EXPORT</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#DEPENDENCIES'>DEPENDENCIES</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT_AND_LICENSE'>COPYRIGHT AND LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Test::Files - A Test::Builder based module to ease testing with files and dirs</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Test::More tests =&#62; 5;
    use Test::Files;
    use File::Spec;

    my $some_file  = File::Spec-&#62;catfile( qw/ path to some file / );
    my $other_file = File::Spec-&#62;catfile( qw/ path to other file / );
    my $some_dir   = File::Spec-&#62;catdir ( qw/ some dir / );
    my $other_dir  = File::Spec-&#62;catdir ( qw/ dir with same stuff / );

    file_ok($some_file, &#34;contents\nof file&#34;, &#34;some file has contents&#34;);

    file_filter_ok(
        $some_file,
        &#34;filtered contents\nof file&#34;,
        \&#38;filter,
        &#34;some file has contents&#34;
    );

    compare_ok($some_file, $other_file, &#34;files are the same&#34;);
    compare_filter_ok(
            $file1, $file2, \&#38;filter, &#34;they&#39;re almost the same&#34;
    );

    dir_contains_ok(
            $some_dir,
            [qw(files some_dir must contain)],
            &#34;$some_dir has all files in list&#34;
    );

    dir_only_contains_ok(
        $some_dir,
        [qw(files some_dir should contain)],
        &#34;$some_dir has exactly the files in the list&#34;
    );

    compare_dirs_ok($some_dir, $other_dir);
    compare_dirs_filter_ok($some_dir, $other_dir, \&#38;filter_fcn);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ABSTRACT"
>ABSTRACT</a></h1>

<pre>  Test::Builder based test helper for file and directory contents.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module is like Test::More, in fact you should use that first as shown above. It exports</p>

<dl>
<dt><a name="file_ok"
>file_ok</a></dt>

<dd>
<p>compare the contents of a file to a string</p>

<dt><a name="file_filter_ok"
>file_filter_ok</a></dt>

<dd>
<p>compare the contents of a file to a string, but filter the file first. (You must filter your own string if needed.)</p>

<dt><a name="compare_ok"
>compare_ok</a></dt>

<dd>
<p>compare the contents of two files</p>

<dt><a name="compare_filter_ok"
>compare_filter_ok</a></dt>

<dd>
<p>compare the contents of two files, but sends each line through a filter so things that shouldn&#39;t count against success can be stripped</p>

<dt><a name="dir_contains_ok"
>dir_contains_ok</a></dt>

<dd>
<p>checks a directory for the presence of a list files</p>

<dt><a name="dir_contains_only_ok"
>dir_contains_only_ok</a></dt>

<dd>
<p>checks a directory to ensure that the listed files are present and that they are the only ones present</p>

<dt><a name="compare_dirs_ok"
>compare_dirs_ok</a></dt>

<dd>
<p>compares all text files in two directories reporting any differences</p>

<dt><a name="compare_dirs_filter_ok"
>compare_dirs_filter_ok</a></dt>

<dd>
<p>works like compare_dirs_ok, but calls a filter function on each line of input, allowing you to exclude or alter some text to avoid spurious failures (like timestamp disagreements).</p>
</dd>
</dl>

<p>Though the SYNOPSIS examples don&#39;t all have names, you can and should provide a name for each test. Names are omitted above only to reduce clutter and line widths.</p>

<p>You should follow the lead of the SYNOPSIS examples and use File::Spec. This makes it much more likely that your tests will pass on a different operating system.</p>

<p>All of the content comparison routines provide diff diagnostic output when they report failure. Currently that diff output is always in table form and can&#39;t be changed.</p>

<p>Most of the functions are self explanatory. One exception is <code>compare_dirs_filter_ok</code> which compares two directory trees, like <code>compare_dirs_ok</code> but with a twist. The twist is a filter which each line is fed through before comparison. I wanted this because some files are really the same, but look different textually. In particular, I was comparing files with machine generated dates. Everything in them was identical, except those dates.</p>

<p>The filter function receives each line of each file. It may perform any necessary transformations (like excising dates), then it must return the line in (possibly) transformed state. For example, my first filter was</p>

<pre>    sub chop_dates {
        my $line = shift;
        $line =~ s/\d{4}(.\d\d){5}//;
        return $line;
    }</pre>

<p>This removes all strings like 2003.10.14.14.17.37. Everything else is unchanged and my failing tests started passing when they shold. If you want to exclude the line from consideration, return &#34;&#34; (do not return undef, that makes it harder to chain filters together and might lead to warnings).</p>

<p><code>compare_filter_ok</code> works in a similar manner for a single file comparison, while <code>file_filter_ok</code> filters the file before comparing it to your unfiltered string.</p>

<p>The test suite has examples of the use of each function and what the output looks like on failure, though it that doesn&#39;t necessarily make them easy to read.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS</a></h2>

<p><code>compare_dirs_ok</code> and <code>compare_dirs_filter_ok</code> do not test for whether the first directory has all the files that are in the second. If you care about missing files in the first direcotry, you must also call <code>dir_contains_ok</code> or <code>dir_contains_only_ok</code>. The <code>compare_dirs_*</code> routines do notice when the second directory does not have a files that the first one has.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="EXPORT"
>EXPORT</a></h2>

<pre>    file_ok
    file_filter_ok
    compare_ok
    compare_filter_ok
    dir_contains_ok
    dir_only_contains_ok
    compare_dirs_ok
    compare_dirs_filter_ok</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DEPENDENCIES"
>DEPENDENCIES</a></h1>

<pre>    Test::Builder
    Test::More
    Text::Diff
    Algorithm::Diff
    Test::Builder::Tester (used only during testing)</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>Consult Test::Simple, Test::More, and Test::Builder for more testing help. This module really just adds functions to what Test::More does.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Phil Crow, &#60;philcrow2000@yahoo.com&#60;gt&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT_AND_LICENSE"
>COPYRIGHT AND LICENSE</a></h1>

<p>Copyright 2003-2007 by Phil Crow</p>

<p>This library is free software; you can redistribute it and/or modify it under the same terms as Perl 5.8.1 itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
