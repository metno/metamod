<html><head><title>Test::PerformanceRegression</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue May 27 09:39:30 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS%2FMETHODS'>FUNCTIONS/METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new(_%24params_hash_)'>new( $params_hash )</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eaccepted_error(%24accepted_error)'>$self-&#62;accepted_error($accepted_error)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Estatistic_error(%24statistic_error)'>$self-&#62;statistic_error($statistic_error)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Estatistic_confidence(%24statistic_confidence)'>$self-&#62;statistic_confidence($statistic_confidence)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Estatistic_minimum(%24statistic_minimum)'>$self-&#62;statistic_minimum($statistic_minimum)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eprevious_result(%24previous_result)'>$self-&#62;previous_result($previous_result)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Eperf_ok(%24code%2C_%24pre_test%2C_%24tag%2C_%24testname)'>$self-&#62;perf_ok($code, $pre_test, $tag, $testname)</a>
    <li class='indexItem indexItem2'><a href='#%24self-%3Estatistic_perf_ok(%24code%2C_%24pre_test%2C_%24tag%2C_%24testname)'>$self-&#62;statistic_perf_ok($code, $pre_test, $tag, $testname)</a>
    <li class='indexItem indexItem2'><a href='#(Class)_remove_performance_log(_%24filename_)'>(Class) remove_performance_log( $filename )</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Test::PerformanceRegression - Test::Builder based module for doing regression testing of performance.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre> my $perf = Test::PerformanceRegression-&#62;new();

 my $sub_to_perf_test = sub { my $result = run_some_code() };

 my $check_of_result = sub { my (@result) = @_; #is result as expected };

 # check that a single run of the function has ok performance.
 perf_ok($sub_to_perf, $check_of_result, &#39;A unique tag for the test&#39;);

 # run the sub enough times that we a statistically certain that we have achieved a the real
 # mean runtime for the sub and then check if the performance is ok.
 statistic_perf_ok</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module provides functionality for doing regression test of performance. It is built using Test::Builder so it is compatible with the standard Perl testing libraries.</p>

<p>The purpose of this module is <b>NOT</b> to measure the actual performance of a piece of code, but instead to ensure that a change does not introduce reduced performance without it being reported to the developer.</p>

<p>Since running times can vary greatly between different machines and it can be difficult to measure the speed of some code against a fixed number. For this reason this module will instead compare the current performance against a previous performance on the same machine. The first time a performance test is run for a piece of code it will be stored in a file. On later runs the performance will be compared with the stored version.</p>

<p>If you want to update all the performance benchmarks for a test script you can just delete the file containing the cached performance results.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS/METHODS"
>FUNCTIONS/METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new(_$params_hash_)"
>new( $params_hash )</a></h2>

<dl>
<dt><a name="accepted_error_(optional,_default_=_10)"
>accepted_error (optional, default = 10)</a></dt>

<dd>
<p>The percentage that you accepted the measured running time to deviate from the previously recorded running time.</p>

<dt><a name="result_file_(optional)"
>result_file (optional)</a></dt>

<dd>
<p>The name of the file that stores the previous running times. By default it will name the result file after the test script ending with &#34;-perf.log&#34;</p>

<dt><a name="statistic_confidence_(optional,_default_=_95)"
>statistic_confidence (optional, default = 95)</a></dt>

<dd>
<p>The statistical confidence that you are have now achieced the real running time within a margin of error. Used when running <code>statistic_perf_ok</code>.</p>

<dt><a name="statistic_error_(optional,_default_=_10)"
>statistic_error (optional, default = 10)</a></dt>

<dd>
<p>The statistical error accepted when running <code>statistic_perf_ok</code>. See <code>Benchmark::Timer</code> for more information.</p>

<dt><a name="statistic_minimum_(optional,_default_=_5)"
>statistic_minimum (optional, default = 5)</a></dt>

<dd>
<p>The minimum number of iterations to execute code when using <code>statistic_perf_ok</code>. If this parameter is set to 1 the tested code will only run once and it that is likely not what you want. Then you should instead use <code>perf_ok</code>.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;accepted_error($accepted_error)"
>$self-&#62;accepted_error($accepted_error)</a></h2>

<p>Set/get the accepted error (see constructor for details).</p>

<dl>
<dt><a name="$accepted_error_(optional)"
>$accepted_error (optional)</a></dt>

<dd>
<p>If provided will set the accepted error to the provided value.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns the accepted error value.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;statistic_error($statistic_error)"
>$self-&#62;statistic_error($statistic_error)</a></h2>

<p>Set/get the statistic error (see constructor for details).</p>

<dl>
<dt><a name="$statistic_error_(optional)"
>$statistic_error (optional)</a></dt>

<dd>
<p>If provided will set the statistic error to the provided value.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns the statistic error value.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;statistic_confidence($statistic_confidence)"
>$self-&#62;statistic_confidence($statistic_confidence)</a></h2>

<p>Set/get the statistic confidence (see constructor for details).</p>

<dl>
<dt><a name="$statistic_confidence_(optional)"
>$statistic_confidence (optional)</a></dt>

<dd>
<p>If provided will set the statistic confidence to the provided value.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns the statistic confidence value.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;statistic_minimum($statistic_minimum)"
>$self-&#62;statistic_minimum($statistic_minimum)</a></h2>

<p>Set/get the statistic minimum (see constructor for details).</p>

<dl>
<dt><a name="$statistic_minimum_(optional)"
>$statistic_minimum (optional)</a></dt>

<dd>
<p>If provided will set the statistic minimum to the provided value.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns the statistic minimum value.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;previous_result($previous_result)"
>$self-&#62;previous_result($previous_result)</a></h2>

<p>Set/get the previous result.</p>

<dl>
<dt><a name="$previous_result_(optional)"
>$previous_result (optional)</a></dt>

<dd>
<p>If provided will set previous result to the value provided. The value should be a hash reference with tags as keys and times as values.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns the previous result.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;perf_ok($code,_$pre_test,_$tag,_$testname)"
>$self-&#62;perf_ok($code, $pre_test, $tag, $testname)</a></h2>

<p>Check the performance of a sub by running it once, optionally performing an additional test first about the correctness of the result returned by the sub.</p>

<p>If the previous running time of the sub has not been recorded the test will be skipped, but the sub will still be run and the running time recorded for the next time the test is run.</p>

<dl>
<dt><a name="$code"
>$code</a></dt>

<dd>
<p>A reference to the sub to execute.</p>

<dt><a name="$pre_test"
>$pre_test</a></dt>

<dd>
<p>Either a reference to sub to be execute or a value that will be tested for true/false.</p>

<p>If a reference to sub is supplied the sub will be executed and the return value used to determine if the test should be performed.</p>

<p>If the return value is false or the supplied value is false the test will be skipped using the Test::Builder-&#62;skip() function.</p>

<dt><a name="$tag"
>$tag</a></dt>

<dd>
<p>A tag that is used to identify the current test. This tag must be unique within the test script since it is used to compare the running time of the sub with the previous running times.</p>

<dt><a name="$testname_(optional)"
>$testname (optional)</a></dt>

<dd>
<p>The name of the test. If not supplied a default test name based on the <code>$tag</code> will be created for you.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns false if the test was not run either because $pre_test failed, because a previous running time was available or because the test failed. Otherwise it returns 1.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$self-&#62;statistic_perf_ok($code,_$pre_test,_$tag,_$testname)"
>$self-&#62;statistic_perf_ok($code, $pre_test, $tag, $testname)</a></h2>

<p>Check the performance of a sub by running it enough times that we are certain that the recorded running time is within a margin of error of the real running time. Optionally performing an additional test first about the correctness of the result returned by the sub.</p>

<p>If the previous running time of the sub has not been recorded the test will be skipped, but the sub will still be run and the running time recorded for the next time the test is run.</p>

<dl>
<dt><a name="$code"
>$code</a></dt>

<dd>
<p>A reference to the sub to execute.</p>

<dt><a name="$pre_test"
>$pre_test</a></dt>

<dd>
<p>Either a reference to sub to be execute or a value that will be tested for true/false.</p>

<p>If a reference to sub is supplied the sub will be executed and the return value used to determine if the test should be performed.</p>

<p>If the return value is false or the supplied value is false the test will be skipped using the Test::Builder-&#62;skip() function.</p>

<dt><a name="$tag"
>$tag</a></dt>

<dd>
<p>A tag that is used to identify the current test. This tag must be unique within the test script since it is used to compare the running time of the sub with the previous running times.</p>

<dt><a name="$testname_(optional)"
>$testname (optional)</a></dt>

<dd>
<p>The name of the test. If not supplied a default test name based on the <code>$tag</code> will be created for you.</p>

<dt><a name="return"
>return</a></dt>

<dd>
<p>Returns false if the test was not run either because $pre_test failed, because a previous running time was available or because the test failed. Otherwise it returns 1.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="(Class)_remove_performance_log(_$filename_)"
>(Class) remove_performance_log( $filename )</a></h2>

<p>Removes the specified files.</p>

<dl>
<dt><a name="$filename_(optional)"
>$filename (optional)</a></dt>

<dd>
<p>The name of the file to remove. If a file is not specified it will remove the default file.</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
