<html><head><title>DBIx::Class::Manual::FAQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:15 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FAQs'>FAQs</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Getting_started'>Getting started</a>
    <li class='indexItem indexItem2'><a href='#Relationships'>Relationships</a>
    <li class='indexItem indexItem2'><a href='#Searching'>Searching</a>
    <li class='indexItem indexItem2'><a href='#Fetching_data'>Fetching data</a>
    <li class='indexItem indexItem2'><a href='#Inserting_and_updating_data'>Inserting and updating data</a>
    <li class='indexItem indexItem2'><a href='#Custom_methods_in_Result_classes'>Custom methods in Result classes</a>
    <li class='indexItem indexItem2'><a href='#Misc'>Misc</a>
    <li class='indexItem indexItem2'><a href='#Notes_for_CDBI_users'>Notes for CDBI users</a>
    <li class='indexItem indexItem2'><a href='#Troubleshooting'>Troubleshooting</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Manual::FAQ - Frequently Asked Questions (in theory)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This document is intended as an anti-map of the documentation.
If you know what you want to do,
but not how to do it in <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a>,
then look here.
It does <b>not</b> contain much code or examples,
it just gives explanations and pointers to the correct pieces of documentation to read.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FAQs"
>FAQs</a></h1>

<p>How Do I:</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Getting_started"
>Getting started</a></h2>

<dl>
<dt><a name=".._create_a_database_to_use?"
>..
create a database to use?</a></dt>

<dd>
<p>First,
choose a database.
For testing/experimenting,
we recommend <a href="../../../DBD/SQLite.html" class="podlinkpod"
>DBD::SQLite</a>,
which is a self-contained small database (i.e.
all you need to do is to install <a href="../../../DBD/SQLite.html" class="podlinkpod"
>DBD::SQLite</a> from CPAN,
and it works).</p>

<p>Next,
spend some time defining which data you need to store,
and how it relates to the other data you have.
For some help on normalisation,
go to <a href="http://b62.tripod.com/doc/dbbase.htm" class="podlinkurl"
>http://b62.tripod.com/doc/dbbase.htm</a>.</p>

<p>Now,
decide whether you want to have the database itself be the definitive source of information about the data layout,
or your DBIx::Class schema.
If it&#39;s the former,
look up the documentation for your database,
eg.
<a href="http://sqlite.org/lang_createtable.html" class="podlinkurl"
>http://sqlite.org/lang_createtable.html</a>,
on how to create tables,
and start creating them.
For a nice universal interface to your database,
you can try <a href="../../../DBI/Shell.html" class="podlinkpod"
>DBI::Shell</a>.
If you decided on the latter choice,
read the FAQ on setting up your classes manually,
and the one on creating tables from your schema.</p>

<dt><a name=".._use_DBIx::Class_with_Catalyst?"
>..
use DBIx::Class with <a href="../../../Catalyst.html" class="podlinkpod"
>Catalyst</a>?</a></dt>

<dd>
<p>Install <a href="../../../Catalyst/Model/DBIC/Schema.html" class="podlinkpod"
>Catalyst::Model::DBIC::Schema</a> from CPAN.
See its documentation,
or below,
for further details.</p>

<dt><a name=".._set_up_my_DBIx::Class_classes_automatically_from_my_database?"
>..
set up my DBIx::Class classes automatically from my database?</a></dt>

<dd>
<p>Install <a href="../../../DBIx/Class/Schema/Loader.html" class="podlinkpod"
>DBIx::Class::Schema::Loader</a> from CPAN,
and read its documentation.</p>

<dt><a name=".._set_up_my_DBIx::Class_classes_manually?"
>..
set up my DBIx::Class classes manually?</a></dt>

<dd>
<p>Look at the <a href="../../../DBIx/Class/Manual/Example.html" class="podlinkpod"
>DBIx::Class::Manual::Example</a> and come back here if you get lost.</p>

<dt><a name=".._create_my_database_tables_from_my_DBIx::Class_schema?"
>..
create my database tables from my DBIx::Class schema?</a></dt>

<dd>
<p>Create your classes manually,
as above.
Write a script that calls <a href="../../../DBIx/Class/Schema.html#deploy" class="podlinkpod"
>&#34;deploy&#34; in DBIx::Class::Schema</a>.
See there for details,
or the <a href="../../../DBIx/Class/Manual/Cookbook.html" class="podlinkpod"
>DBIx::Class::Manual::Cookbook</a>.</p>

<dt><a name=".._store/retrieve_Unicode_data_in_my_database?"
>..
store/retrieve Unicode data in my database?</a></dt>

<dd>
<p>Make sure you database supports Unicode and set the connect attributes appropriately - see <a href="../../../DBIx/Class/Manual/Cookbook.html#Using_Unicode" class="podlinkpod"
>&#34;Using Unicode&#34; in DBIx::Class::Manual::Cookbook</a></p>

<dt><a name=".._connect_to_my_database?"
>..
connect to my database?</a></dt>

<dd>
<p>Once you have created all the appropriate table/source classes,
and an overall <a href="../../../DBIx/Class/Schema.html" class="podlinkpod"
>Schema</a> class,
you can start using them in an application.
To do this,
you need to create a central Schema object,
which is used to access all the data in the various tables.
See <a href="../../../DBIx/Class/Schema.html#connect" class="podlinkpod"
>&#34;connect&#34; in DBIx::Class::Schema</a> for details.
The actual connection does not happen until you actually request data,
so don&#39;t be alarmed if the error from incorrect connection details happens a lot later.</p>

<dt><a name=".._use_DBIx::Class_across_multiple_databases?"
>..
use DBIx::Class across multiple databases?</a></dt>

<dd>
<p>If your database server allows you to run querys across multiple databases at once,
then so can DBIx::Class.
All you need to do is make sure you write the database name as part of the <a href="../../../DBIx/Class/ResultSource.html#table" class="podlinkpod"
>&#34;table&#34; in DBIx::Class::ResultSource</a> call.
Eg:</p>

<pre>  __PACKAGE__-&#62;table(&#39;mydb.mytablename&#39;);</pre>

<p>And load all the Result classes for both / all databases using one <a href="../../../DBIx/Class/Schema.html#load_namespaces" class="podlinkpod"
>&#34;load_namespaces&#34; in DBIx::Class::Schema</a> call.</p>

<dt><a name=".._use_DBIx::Class_across_PostgreSQL/DB2/Oracle_schemas?"
>.. use DBIx::Class across PostgreSQL/DB2/Oracle schemas?</a></dt>

<dd>
<p>Add the name of the schema to the <a href="../../../DBIx/Class/ResultSource.html#table" class="podlinkpod"
>&#34;table&#34; in DBIx::Class::ResultSource</a> as part of the name, and make sure you give the one user you are going to connect with has permissions to read/write all the schemas/tables as necessary.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Relationships"
>Relationships</a></h2>

<dl>
<dt><a name=".._tell_DBIx::Class_about_relationships_between_my_tables?"
>.. tell DBIx::Class about relationships between my tables?</a></dt>

<dd>
<p>There are a variety of relationship types that come pre-defined for you to use. These are all listed in <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a>. If you need a non-standard type, or more information, look in <a href="../../../DBIx/Class/Relationship/Base.html" class="podlinkpod"
>DBIx::Class::Relationship::Base</a>.</p>

<dt><a name=".._define_a_one-to-many_relationship?"
>.. define a one-to-many relationship?</a></dt>

<dd>
<p>This is called a <code>has_many</code> relationship on the one side, and a <code>belongs_to</code> relationship on the many side. Currently these need to be set up individually on each side. See <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a> for details.</p>

<dt><a name=".._define_a_relationship_where_this_table_contains_another_table&#39;s_primary_key?_(foreign_key)"
>.. define a relationship where this table contains another table&#39;s primary key? (foreign key)</a></dt>

<dd>
<p>Create a <code>belongs_to</code> relationship for the field containing the foreign key. See <a href="../../../DBIx/Class/Relationship.html#belongs_to" class="podlinkpod"
>&#34;belongs_to&#34; in DBIx::Class::Relationship</a>.</p>

<dt><a name=".._define_a_foreign_key_relationship_where_the_key_field_may_contain_NULL?"
>.. define a foreign key relationship where the key field may contain NULL?</a></dt>

<dd>
<p>Just create a <code>belongs_to</code> relationship, as above. If the column is NULL then the inflation to the foreign object will not happen. This has a side effect of not always fetching all the relevant data, if you use a nullable foreign-key relationship in a JOIN, then you probably want to set the <code>join_type</code> to <code>left</code>.</p>

<dt><a name=".._define_a_relationship_where_the_key_consists_of_more_than_one_column?"
>.. define a relationship where the key consists of more than one column?</a></dt>

<dd>
<p>Instead of supplying a single column name, all relationship types also allow you to supply a hashref containing the condition across which the tables are to be joined. The condition may contain as many fields as you like. See <a href="../../../DBIx/Class/Relationship/Base.html" class="podlinkpod"
>DBIx::Class::Relationship::Base</a>.</p>

<dt><a name=".._define_a_relationship_bridge_across_an_intermediate_table?_(many-to-many)"
>.. define a relationship bridge across an intermediate table? (many-to-many)</a></dt>

<dd>
<p>The term &#39;relationship&#39; is used loosely with many_to_many as it is not considered a relationship in the fullest sense. For more info, read the documentation on <a href="../../../DBIx/Class/Relationship.html#many_to_many" class="podlinkpod"
>&#34;many_to_many&#34; in DBIx::Class::Relationship</a>.</p>

<dt><a name=".._stop_DBIx::Class_from_attempting_to_cascade_deletes_on_my_has_many_and_might_have_relationships?"
>.. stop DBIx::Class from attempting to cascade deletes on my has_many and might_have relationships?</a></dt>

<dd>
<p>By default, DBIx::Class cascades deletes and updates across <code>has_many</code> and <code>might_have</code> relationships. You can disable this behaviour on a per-relationship basis by supplying <code>cascade_delete =&#62; 0</code> in the relationship attributes.</p>

<p>The cascaded operations are performed after the requested delete or update, so if your database has a constraint on the relationship, it will have deleted/updated the related records or raised an exception before DBIx::Class gets to perform the cascaded operation.</p>

<p>See <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a>.</p>

<dt><a name=".._use_a_relationship?"
>.. use a relationship?</a></dt>

<dd>
<p>Use its name. An accessor is created using the name. See examples in <a href="../../../DBIx/Class/Manual/Cookbook.html#Using_relationships" class="podlinkpod"
>&#34;Using relationships&#34; in DBIx::Class::Manual::Cookbook</a>.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Searching"
>Searching</a></h2>

<dl>
<dt><a name=".._search_for_data?"
>.. search for data?</a></dt>

<dd>
<p>Create a <code>$schema</code> object, as mentioned above in <a href="#.._connect_to_my_database%3F" class="podlinkpod"
>&#34;.. connect to my database?&#34;</a>. Find the <a href="../../../DBIx/Class/Manual/Glossary.html#ResultSet" class="podlinkpod"
>ResultSet</a> that you want to search in, by calling <code>$schema-&#62;resultset(&#39;MySource&#39;)</code> and call <code>search</code> on it. See <a href="../../../DBIx/Class/ResultSet.html#search" class="podlinkpod"
>&#34;search&#34; in DBIx::Class::ResultSet</a>.</p>

<dt><a name=".._search_using_database_functions?"
>.. search using database functions?</a></dt>

<dd>
<p>Supplying something like:</p>

<pre> -&#62;search({&#39;mydatefield&#39; =&#62; &#39;now()&#39;})</pre>

<p>to search, will probably not do what you expect. It will quote the text &#34;now()&#34;, instead of trying to call the function. To provide literal, unquoted text you need to pass in a scalar reference, like so:</p>

<pre> -&#62;search({&#39;mydatefield&#39; =&#62; \&#39;now()&#39;})</pre>

<dt><a name=".._sort_the_results_of_my_search?"
>.. sort the results of my search?</a></dt>

<dd>
<p>Supply a list of columns you want to sort by to the <code>order_by</code> attribute. See <a href="../../../DBIx/Class/ResultSet.html#order_by" class="podlinkpod"
>&#34;order_by&#34; in DBIx::Class::ResultSet</a>.</p>

<dt><a name=".._sort_my_results_based_on_fields_I&#39;ve_aliased_using_as?"
>.. sort my results based on fields I&#39;ve aliased using <code>as</code>?</a></dt>

<dd>
<p>You didn&#39;t alias anything, since <a href="../../../DBIx/Class/ResultSet.html#as" class="podlinkpod"
>as</a> <b>has nothing to do</b> with the produced SQL. See <a href="../../../DBIx/Class/ResultSet.html#select" class="podlinkpod"
>&#34;select&#34; in DBIx::Class::ResultSet</a> for details.</p>

<dt><a name=".._group_the_results_of_my_search?"
>.. group the results of my search?</a></dt>

<dd>
<p>Supply a list of columns you want to group on, to the <code>group_by</code> attribute, see <a href="../../../DBIx/Class/ResultSet.html#group_by" class="podlinkpod"
>&#34;group_by&#34; in DBIx::Class::ResultSet</a>.</p>

<dt><a name=".._group_my_results_based_on_fields_I&#39;ve_aliased_using_as?"
>.. group my results based on fields I&#39;ve aliased using <code>as</code>?</a></dt>

<dd>
<p>You don&#39;t. See the explanation on ordering by an alias above.</p>

<dt><a name=".._filter_the_results_of_my_search?"
>.. filter the results of my search?</a></dt>

<dd>
<p>The first argument to <code>search</code> is a hashref of accessor names and values to filter them by, for example:</p>

<pre> -&#62;search({&#39;created_time&#39; =&#62; { &#39;&#62;=&#39;, &#39;2006-06-01 00:00:00&#39; } })</pre>

<p>Note that to use a function here you need to make it a scalar reference:</p>

<pre> -&#62;search({&#39;created_time&#39; =&#62; { &#39;&#62;=&#39;, \&#39;yesterday()&#39; } })</pre>

<dt><a name=".._search_in_several_tables_simultaneously?"
>.. search in several tables simultaneously?</a></dt>

<dd>
<p>To search in two related tables, you first need to set up appropriate relationships between their respective classes. When searching you then supply the name of the relationship to the <code>join</code> attribute in your search, for example when searching in the Books table for all the books by the author &#34;Fred Bloggs&#34;:</p>

<pre> -&#62;search({&#39;authors.name&#39; =&#62; &#39;Fred Bloggs&#39;}, { join =&#62; &#39;authors&#39; })</pre>

<p>The type of join created in your SQL depends on the type of relationship between the two tables, see <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a> for the join used by each relationship.</p>

<dt><a name=".._create_joins_with_conditions_other_than_column_equality?"
>.. create joins with conditions other than column equality?</a></dt>

<dd>
<p>Currently, <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> can only create join conditions using equality, so you&#39;re probably better off creating a <code>view</code> in your database, and using that as your source. A <code>view</code> is a stored SQL query, which can be accessed similarly to a table, see your database documentation for details.</p>

<dt><a name=".._search_with_an_SQL_function_on_the_left_hand_side?"
>.. search with an SQL function on the left hand side?</a></dt>

<dd>
<p>To use an SQL function on the left hand side of a comparison you currently need to resort to literal SQL:</p>

<pre> -&#62;search( \[ &#39;YEAR(date_of_birth) = ?&#39;, 1979 ] );</pre>

<dt><a name=".._find_more_help_on_constructing_searches?"
>.. find more help on constructing searches?</a></dt>

<dd>
<p>Behind the scenes, DBIx::Class uses <a href="../../../SQL/Abstract.html" class="podlinkpod"
>SQL::Abstract</a> to help construct its SQL searches. So if you fail to find help in the <a href="../../../DBIx/Class/Manual/Cookbook.html" class="podlinkpod"
>DBIx::Class::Manual::Cookbook</a>, try looking in the SQL::Abstract documentation.</p>

<dt><a name=".._make_searches_in_Oracle_(10gR2_and_newer)_case-insensitive?"
>.. make searches in Oracle (10gR2 and newer) case-insensitive?</a></dt>

<dd>
<p>To make Oracle behave like most RDBMS use on_connect_do to issue alter session statements on database connection establishment:</p>

<pre> -&#62;on_connect_do(&#34;ALTER SESSION SET NLS_COMP = &#39;LINGUISTIC&#39;&#34;);
 -&#62;on_connect_do(&#34;ALTER SESSION SET NLS_SORT = &#39;&#60;NLS&#62;_CI&#39;&#34;);
 e.g.
 -&#62;on_connect_do(&#34;ALTER SESSION SET NLS_SORT = &#39;BINARY_CI&#39;&#34;);
 -&#62;on_connect_do(&#34;ALTER SESSION SET NLS_SORT = &#39;GERMAN_CI&#39;&#34;);</pre>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Fetching_data"
>Fetching data</a></h2>

<dl>
<dt><a name=".._fetch_as_much_data_as_possible_in_as_few_select_calls_as_possible?"
>.. fetch as much data as possible in as few select calls as possible?</a></dt>

<dd>
<p>See the prefetch examples in the <a href="../../../DBIx/Class/Manual/Cookbook.html" class="podlinkpod"
>Cookbook</a>.</p>

<dt><a name=".._fetch_a_whole_column_of_data_instead_of_a_row?"
>.. fetch a whole column of data instead of a row?</a></dt>

<dd>
<p>Call <code>get_column</code> on a <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a>. This returns a <a href="../../../DBIx/Class/ResultSetColumn.html" class="podlinkpod"
>DBIx::Class::ResultSetColumn</a>. See its documentation and the <a href="../../../DBIx/Class/Manual/Cookbook.html" class="podlinkpod"
>Cookbook</a> for details.</p>

<dt><a name=".._fetch_a_formatted_column?"
>.. fetch a formatted column?</a></dt>

<dd>
<p>In your table schema class, create a &#34;private&#34; column accessor with:</p>

<pre>  __PACKAGE__-&#62;add_columns(my_column =&#62; { accessor =&#62; &#39;_hidden_my_column&#39; });</pre>

<p>Then, in the same class, implement a subroutine called &#34;my_column&#34; that fetches the real value and does the formatting you want.</p>

<p>See the <a href="../../../DBIx/Class/Manual/Cookbook.html" class="podlinkpod"
>Cookbook</a> for more details.</p>

<dt><a name=".._fetch_a_single_(or_topmost)_row?"
>.. fetch a single (or topmost) row?</a></dt>

<dd>
<p>Use the <a href="../../../DBIx/Class/ResultSet.html#rows" class="podlinkpod"
>&#34;rows&#34; in DBIx::Class::ResultSet</a> and <a href="../../../DBIx/Class/ResultSet.html#order_by" class="podlinkpod"
>&#34;order_by&#34; in DBIx::Class::ResultSet</a> attributes to order your data and pick off a single row.</p>

<p>See also <a href="../../../DBIx/Class/Manual/Cookbook.html#Retrieve_one_and_only_one_row_from_a_resultset" class="podlinkpod"
>&#34;Retrieve one and only one row from a resultset&#34; in DBIx::Class::Manual::Cookbook</a>.</p>

<p>A less readable way is to ask a regular search to return 1 row, using <a href="../../../DBIx/Class/ResultSet.html#slice" class="podlinkpod"
>&#34;slice&#34; in DBIx::Class::ResultSet</a>:</p>

<pre>  -&#62;search-&#62;(undef, { order_by =&#62; &#34;id DESC&#34; })-&#62;slice(0)</pre>

<p>which (if supported by the database) will use LIMIT/OFFSET to hint to the database that we really only need one row. This can result in a significant speed improvement. The method using <a href="../../../DBIx/Class/ResultSet.html#single" class="podlinkpod"
>&#34;single&#34; in DBIx::Class::ResultSet</a> mentioned in the cookbook can do the same if you pass a <code>rows</code> attribute to the search.</p>

<dt><a name=".._refresh_a_row_from_storage?"
>.. refresh a row from storage?</a></dt>

<dd>
<p>Use <a href="../../../DBIx/Class/Row.html#discard_changes" class="podlinkpod"
>&#34;discard_changes&#34; in DBIx::Class::Row</a>.</p>

<pre>  $row-&#62;discard_changes</pre>

<p>Discarding changes and refreshing from storage are two sides fo the same coin. When you want to discard your local changes, just re-fetch the row from storage. When you want to get a new, fresh copy of the row, just re-fetch the row from storage. <a href="../../../DBIx/Class/Row.html#discard_changes" class="podlinkpod"
>&#34;discard_changes&#34; in DBIx::Class::Row</a> does just that by re-fetching the row from storage using the row&#39;s primary key.</p>

<dt><a name=".._fetch_my_data_a_&#34;page&#34;_at_a_time?"
>.. fetch my data a &#34;page&#34; at a time?</a></dt>

<dd>
<p>Pass the <code>rows</code> and <code>page</code> attributes to your search, eg:</p>

<pre>  -&#62;search({}, { rows =&#62; 10, page =&#62; 1});</pre>

<dt><a name=".._get_a_count_of_all_rows_even_when_paging?"
>.. get a count of all rows even when paging?</a></dt>

<dd>
<p>Call <code>pager</code> on the paged resultset, it will return a <a href="../../../Data/Page.html" class="podlinkpod"
>Data::Page</a> object. Calling <code>total_entries</code> on the pager will return the correct total.</p>

<p><code>count</code> on the resultset will only return the total number in the page.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Inserting_and_updating_data"
>Inserting and updating data</a></h2>

<dl>
<dt><a name=".._insert_a_row_with_an_auto_incrementing_primary_key?"
>.. insert a row with an auto incrementing primary key?</a></dt>

<dd>
<p>This happens automatically. After <a href="../../../DBIx/Class/ResultSet.html#create" class="podlinkpod"
>creating</a> a result object, the primary key value created by your database can be fetched by calling <code>id</code> (or the access of your primary key column) on the object.</p>

<dt><a name=".._insert_a_row_with_a_primary_key_that_uses_a_sequence?"
>.. insert a row with a primary key that uses a sequence?</a></dt>

<dd>
<p>You need to create a trigger in your database that updates your primary key field from the sequence. To help PK::Auto find the next key value, you can tell it the name of the sequence in the <code>column_info</code> supplied with <code>add_columns</code>.</p>

<pre> -&#62;add_columns({ id =&#62; { sequence =&#62; &#39;mysequence&#39;, auto_nextval =&#62; 1 } });</pre>

<dt><a name=".._insert_many_rows_of_data_efficiently?"
>.. insert many rows of data efficiently?</a></dt>

<dd>
<p>The <code>populate</code> method in <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> provides efficient bulk inserts.</p>

<p><a href="../../../DBIx/Class/Fixtures.html" class="podlinkpod"
>DBIx::Class::Fixtures</a> provides an alternative way to do this.</p>

<dt><a name=".._update_a_collection_of_rows_at_the_same_time?"
>.. update a collection of rows at the same time?</a></dt>

<dd>
<p>Create a resultset using a <code>search</code>, to filter the rows of data you would like to update, then call <code>update</code> on the resultset to change all the rows at once.</p>

<dt><a name=".._use_database_functions_when_updating_rows?"
>.. use database functions when updating rows?</a></dt>

<dd>
<dt><a name=".._update_a_column_using_data_from_another_column?"
>.. update a column using data from another column?</a></dt>

<dd>
<p>To stop the column name from being quoted, you&#39;ll need to tell DBIC that the right hand side is an SQL identifier (it will be quoted properly if you have quoting enabled):</p>

<pre> -&#62;update({ somecolumn =&#62; { -ident =&#62; &#39;othercolumn&#39; } })</pre>

<p>This method will not retrieve the new value and put it in your Row object. To fetch the new value, use the <code>discard_changes</code> method on the Row.</p>

<pre>  # will return the scalar reference:
  $row-&#62;somecolumn()

  # issue a select using the PK to re-fetch the row data:
  $row-&#62;discard_changes();

  # Now returns the correct new value:
  $row-&#62;somecolumn()</pre>

<p>To update and refresh at once, chain your calls:</p>

<pre>  $row-&#62;update({ &#39;somecolumn&#39; =&#62; { -ident =&#62; &#39;othercolumn&#39; } })-&#62;discard_changes;</pre>

<dt><a name=".._store_JSON/YAML_in_a_column_and_have_it_deflate/inflate_automatically?"
>.. store JSON/YAML in a column and have it deflate/inflate automatically?</a></dt>

<dd>
<p>You can use <a href="../../../DBIx/Class/InflateColumn.html" class="podlinkpod"
>DBIx::Class::InflateColumn</a> to accomplish YAML/JSON storage transparently.</p>

<p>If you want to use JSON, then in your table schema class, do the following:</p>

<pre> use JSON;

 __PACKAGE__-&#62;add_columns(qw/ ... my_column ../)
 __PACKAGE__-&#62;inflate_column(&#39;my_column&#39;, {
     inflate =&#62; sub { jsonToObj(shift) },
     deflate =&#62; sub { objToJson(shift) },
 });</pre>

<p>For YAML, in your table schema class, do the following:</p>

<pre> use YAML;

 __PACKAGE__-&#62;add_columns(qw/ ... my_column ../)
 __PACKAGE__-&#62;inflate_column(&#39;my_column&#39;, {
     inflate =&#62; sub { YAML::Load(shift) },
     deflate =&#62; sub { YAML::Dump(shift) },
 });</pre>

<p>This technique is an easy way to store supplemental unstructured data in a table. Be careful not to overuse this capability, however. If you find yourself depending more and more on some data within the inflated column, then it may be time to factor that data out.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Custom_methods_in_Result_classes"
>Custom methods in Result classes</a></h2>

<p>You can add custom methods that do arbitrary things, even to unrelated tables. For example, to provide a <code>$book-&#62;foo()</code> method which searches the cd table, you&#39;d could add this to Book.pm:</p>

<pre>  sub foo {
    my ($self, $col_data) = @_;
    return $self-&#62;result_source-&#62;schema-&#62;resultset(&#39;cd&#39;)-&#62;search($col_data);
  }</pre>

<p>And invoke that on any Book Result object like so:</p>

<pre>  my $rs = $book-&#62;foo({ title =&#62; &#39;Down to Earth&#39; });</pre>

<p>When two tables ARE related, <a href="../../../DBIx/Class/Relationship/Base.html" class="podlinkpod"
>DBIx::Class::Relationship::Base</a> provides many methods to find or create data in related tables for you. But if you want to write your own methods, you can.</p>

<p>For example, to provide a <code>$book-&#62;foo()</code> method to manually implement what create_related() from <a href="../../../DBIx/Class/Relationship/Base.html" class="podlinkpod"
>DBIx::Class::Relationship::Base</a> does, you could add this to Book.pm:</p>

<pre>  sub foo {
    my ($self, $relname, $col_data) = @_;
    return $self-&#62;related_resultset($relname)-&#62;create($col_data);
  }</pre>

<p>Invoked like this:</p>

<pre>  my $author = $book-&#62;foo(&#39;author&#39;, { name =&#62; &#39;Fred&#39; });</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Misc"
>Misc</a></h2>

<dl>
<dt><a name="How_do_I_store_my_own_(non-db)_data_in_my_DBIx::Class_objects?"
>How do I store my own (non-db) data in my DBIx::Class objects?</a></dt>

<dd>
<p>You can add your own data accessors to your Result classes.</p>

<p>One method is to use the built in mk_group_accessors (via <a href="../../../Class/Accessor/Grouped.html" class="podlinkpod"
>Class::Accessor::Grouped</a>)</p>

<pre>        package App::Schema::Result::MyTable;

        use parent &#39;DBIx::Class::Core&#39;;

        __PACKAGE__-&#62;table(&#39;foo&#39;); #etc
        __PACKAGE__-&#62;mk_group_accessors(&#39;simple&#39; =&#62; qw/non_column_data/); # must use simple group</pre>

<p>An another method is to use <a href="../../../Moose.html" class="podlinkpod"
>Moose</a> with your <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> package.</p>

<pre>        package App::Schema::Result::MyTable;

        use Moose; # import Moose
        use Moose::Util::TypeConstraint; # import Moose accessor type constraints

        extends &#39;DBIx::Class::Core&#39;; # Moose changes the way we define our parent (base) package

        has &#39;non_column_data&#39; =&#62; ( is =&#62; &#39;rw&#39;, isa =&#62; &#39;Str&#39; ); # define a simple attribute

        __PACKAGE__-&#62;table(&#39;foo&#39;); # etc</pre>

<p>With either of these methods the resulting use of the accesssor would be</p>

<pre>        my $row;

        # assume that somewhere in here $row will get assigned to a MyTable row

        $row-&#62;non_column_data(&#39;some string&#39;); # would set the non_column_data accessor

        # some other stuff happens here

        $row-&#62;update(); # would not inline the non_column_data accessor into the update</pre>

<dt><a name="How_do_I_use_DBIx::Class_objects_in_my_TT_templates?"
>How do I use DBIx::Class objects in my TT templates?</a></dt>

<dd>
<p>Like normal objects, mostly. However you need to watch out for TT calling methods in list context. When calling relationship accessors you will not get resultsets, but a list of all the related objects.</p>

<p>Use the <a href="../../../DBIx/Class/ResultSet.html#search_rs" class="podlinkpod"
>&#34;search_rs&#34; in DBIx::Class::ResultSet</a> method, or the relationship accessor methods ending with &#34;_rs&#34; to work around this issue.</p>

<p>See also <a href="../../../DBIx/Class/Relationship.html#has_many" class="podlinkpod"
>&#34;has_many&#34; in DBIx::Class::Relationship</a>.</p>

<dt><a name="See_the_SQL_statements_my_code_is_producing?"
>See the SQL statements my code is producing?</a></dt>

<dd>
<p>Set the shell environment variable <code>DBIC_TRACE</code> to a true value.</p>

<p>For more info see <a href="../../../DBIx/Class/Storage.html" class="podlinkpod"
>DBIx::Class::Storage</a> for details of how to turn on debugging in the environment, pass your own filehandle to save debug to, or create your own callback.</p>

<dt><a name="Why_didn&#39;t_my_search_run_any_SQL?"
>Why didn&#39;t my search run any SQL?</a></dt>

<dd>
<p><a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> runs the actual SQL statement as late as possible, thus if you create a resultset using <code>search</code> in scalar context, no query is executed. You can create further resultset refinements by calling search again or relationship accessors. The SQL query is only run when you ask the resultset for an actual result object.</p>

<dt><a name="How_do_I_deal_with_tables_that_lack_a_primary_key?"
>How do I deal with tables that lack a primary key?</a></dt>

<dd>
<p>If your table lacks a primary key, DBIx::Class can&#39;t work out which row it should operate on, for example to delete or update. However, a UNIQUE constraint on one or more columns allows DBIx::Class to uniquely identify the row, so you can tell <a href="../../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> these columns act as a primary key, even if they don&#39;t from the database&#39;s point of view:</p>

<pre> $resultset-&#62;set_primary_key(@column);</pre>

<dt><a name="How_do_I_make_my_program_start_faster?"
>How do I make my program start faster?</a></dt>

<dd>
<p>Look at the tips in <a href="../../../DBIx/Class/Manual/Cookbook.html#STARTUP_SPEED" class="podlinkpod"
>&#34;STARTUP SPEED&#34; in DBIx::Class::Manual::Cookbook</a></p>

<dt><a name="How_do_I_reduce_the_overhead_of_database_queries?"
>How do I reduce the overhead of database queries?</a></dt>

<dd>
<p>You can reduce the overhead of object creation within <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> using the tips in <a href="../../../DBIx/Class/Manual/Cookbook.html#Skip_result_object_creation_for_faster_results" class="podlinkpod"
>&#34;Skip result object creation for faster results&#34; in DBIx::Class::Manual::Cookbook</a> and <a href="../../../DBIx/Class/Manual/Cookbook.html#Get_raw_data_for_blindingly_fast_results" class="podlinkpod"
>&#34;Get raw data for blindingly fast results&#34; in DBIx::Class::Manual::Cookbook</a></p>

<dt><a name="How_do_I_override_a_run_time_method_(e.g._a_relationship_accessor)?"
>How do I override a run time method (e.g. a relationship accessor)?</a></dt>

<dd>
<p>If you need access to the original accessor, then you must &#34;wrap around&#34; the original method. You can do that either with <a href="../../../Moose/Manual/MethodModifiers.html" class="podlinkpod"
>Moose::Manual::MethodModifiers</a> or <a href="../../../Class/Method/Modifiers.html" class="podlinkpod"
>Class::Method::Modifiers</a>. The code example works for both modules:</p>

<pre>    package Your::Schema::Group;
    use Class::Method::Modifiers;

    # ... declare columns ...

    __PACKAGE__-&#62;has_many(&#39;group_servers&#39;, &#39;Your::Schema::GroupServer&#39;, &#39;group_id&#39;);
    __PACKAGE__-&#62;many_to_many(&#39;servers&#39;, &#39;group_servers&#39;, &#39;server&#39;);

    # if the server group is a &#34;super group&#34;, then return all servers
    # otherwise return only servers that belongs to the given group
    around &#39;servers&#39; =&#62; sub {
        my $orig = shift;
        my $self = shift;

        return $self-&#62;$orig(@_) unless $self-&#62;is_super_group;
        return $self-&#62;result_source-&#62;schema-&#62;resultset(&#39;Server&#39;)-&#62;all;
    };</pre>

<p>If you just want to override the original method, and don&#39;t care about the data from the original accessor, then you have two options. Either use <a href="../../../Method/Signatures/Simple.html" class="podlinkpod"
>Method::Signatures::Simple</a> that does most of the work for you, or do it the &#34;dirty way&#34;.</p>

<p><a href="../../../Method/Signatures/Simple.html" class="podlinkpod"
>Method::Signatures::Simple</a> way:</p>

<pre>    package Your::Schema::Group;
    use Method::Signatures::Simple;

    # ... declare columns ...

    __PACKAGE__-&#62;has_many(&#39;group_servers&#39;, &#39;Your::Schema::GroupServer&#39;, &#39;group_id&#39;);
    __PACKAGE__-&#62;many_to_many(&#39;servers&#39;, &#39;group_servers&#39;, &#39;server&#39;);

    # The method keyword automatically injects the annoying my $self = shift; for you.
    method servers {
        return $self-&#62;result_source-&#62;schema-&#62;resultset(&#39;Server&#39;)-&#62;search({ ... });
    }</pre>

<p>The dirty way:</p>

<pre>    package Your::Schema::Group;
    use Sub::Name;

    # ... declare columns ...

    __PACKAGE__-&#62;has_many(&#39;group_servers&#39;, &#39;Your::Schema::GroupServer&#39;, &#39;group_id&#39;);
    __PACKAGE__-&#62;many_to_many(&#39;servers&#39;, &#39;group_servers&#39;, &#39;server&#39;);

    *servers = subname servers =&#62; sub {
        my $self = shift;
        return $self-&#62;result_source-&#62;schema-&#62;resultset(&#39;Server&#39;)-&#62;search({ ... });
    };</pre>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Notes_for_CDBI_users"
>Notes for CDBI users</a></h2>

<dl>
<dt><a 
>Is there a way to make an object auto-stringify itself as a particular column or group of columns (a-la cdbi Stringfy column group, or stringify_self method) ?</a></dt>

<dd>
<p>See <a href="../../../DBIx/Class/Manual/Cookbook.html#Stringification" class="podlinkpod"
>&#34;Stringification&#34; in DBIx::Class::Manual::Cookbook</a></p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Troubleshooting"
>Troubleshooting</a></h2>

<dl>
<dt><a name="Help,_I_can&#39;t_connect_to_postgresql!"
>Help, I can&#39;t connect to postgresql!</a></dt>

<dd>
<p>If you get an error such as:</p>

<pre>  DBI connect(&#39;dbname=dbic&#39;,&#39;user&#39;,...) failed: could not connect to server:
  No such file or directory Is the server running locally and accepting
  connections on Unix domain socket &#34;/var/run/postgresql/.s.PGSQL.5432&#34;?</pre>

<p>Likely you have/had two copies of postgresql installed simultaneously, the second one will use a default port of 5433, while <a href="../../../DBD/Pg.html" class="podlinkpod"
>DBD::Pg</a> is compiled with a default port of 5432.</p>

<p>You can change the port setting in <code>postgresql.conf</code>.</p>

<dt><a name="I&#39;ve_lost_or_forgotten_my_mysql_password"
>I&#39;ve lost or forgotten my mysql password</a></dt>

<dd>
<p>Stop mysqld and restart it with the --skip-grant-tables option.</p>

<p>Issue the following statements in the mysql client.</p>

<pre>  UPDATE mysql.user SET Password=PASSWORD(&#39;MyNewPass&#39;) WHERE User=&#39;root&#39;;
  FLUSH PRIVILEGES;</pre>

<p>Restart mysql.</p>

<p>Taken from:</p>

<p><a href="http://dev.mysql.com/doc/refman/5.1/en/resetting-permissions.html" class="podlinkurl"
>http://dev.mysql.com/doc/refman/5.1/en/resetting-permissions.html</a>.</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
