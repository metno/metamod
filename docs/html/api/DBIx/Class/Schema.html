<html><head><title>DBIx::Class::Schema</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#SETUP_METHODS'>SETUP METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#load_namespaces'>load_namespaces</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Warnings'>Warnings</a>
      <li class='indexItem indexItem3'><a href='#Examples'>Examples</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#load_classes'>load_classes</a>
    <li class='indexItem indexItem2'><a href='#storage_type'>storage_type</a>
    <li class='indexItem indexItem2'><a href='#exception_action'>exception_action</a>
    <li class='indexItem indexItem2'><a href='#stacktrace'>stacktrace</a>
    <li class='indexItem indexItem2'><a href='#sqlt_deploy_hook'>sqlt_deploy_hook</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#connect'>connect</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Overloading'>Overloading</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#resultset'>resultset</a>
    <li class='indexItem indexItem2'><a href='#sources'>sources</a>
    <li class='indexItem indexItem2'><a href='#source'>source</a>
    <li class='indexItem indexItem2'><a href='#class'>class</a>
    <li class='indexItem indexItem2'><a href='#txn_do'>txn_do</a>
    <li class='indexItem indexItem2'><a href='#txn_scope_guard'>txn_scope_guard</a>
    <li class='indexItem indexItem2'><a href='#txn_begin'>txn_begin</a>
    <li class='indexItem indexItem2'><a href='#txn_commit'>txn_commit</a>
    <li class='indexItem indexItem2'><a href='#txn_rollback'>txn_rollback</a>
    <li class='indexItem indexItem2'><a href='#storage'>storage</a>
    <li class='indexItem indexItem2'><a href='#populate'>populate</a>
    <li class='indexItem indexItem2'><a href='#connection'>connection</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#Overloading'>Overloading</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#compose_namespace'>compose_namespace</a>
    <li class='indexItem indexItem2'><a href='#svp_begin'>svp_begin</a>
    <li class='indexItem indexItem2'><a href='#svp_release'>svp_release</a>
    <li class='indexItem indexItem2'><a href='#svp_rollback'>svp_rollback</a>
    <li class='indexItem indexItem2'><a href='#clone'>clone</a>
    <li class='indexItem indexItem2'><a href='#throw_exception'>throw_exception</a>
    <li class='indexItem indexItem2'><a href='#deploy'>deploy</a>
    <li class='indexItem indexItem2'><a href='#deployment_statements'>deployment_statements</a>
    <li class='indexItem indexItem2'><a href='#create_ddl_dir'>create_ddl_dir</a>
    <li class='indexItem indexItem2'><a href='#ddl_filename'>ddl_filename</a>
    <li class='indexItem indexItem2'><a href='#thaw'>thaw</a>
    <li class='indexItem indexItem2'><a href='#freeze'>freeze</a>
    <li class='indexItem indexItem2'><a href='#dclone'>dclone</a>
    <li class='indexItem indexItem2'><a href='#schema_version'>schema_version</a>
    <li class='indexItem indexItem2'><a href='#register_class'>register_class</a>
    <li class='indexItem indexItem2'><a href='#register_source'>register_source</a>
    <li class='indexItem indexItem2'><a href='#unregister_source'>unregister_source</a>
    <li class='indexItem indexItem2'><a href='#register_extra_source'>register_extra_source</a>
    <li class='indexItem indexItem2'><a href='#compose_connection_(DEPRECATED)'>compose_connection (DEPRECATED)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR_AND_CONTRIBUTORS'>AUTHOR AND CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Schema - composable schemas</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  package Library::Schema;
  use base qw/DBIx::Class::Schema/;

  # load all Result classes in Library/Schema/Result/
  __PACKAGE__-&#62;load_namespaces();

  package Library::Schema::Result::CD;
  use base qw/DBIx::Class::Core/;

  __PACKAGE__-&#62;load_components(qw/InflateColumn::DateTime/); # for example
  __PACKAGE__-&#62;table(&#39;cd&#39;);

  # Elsewhere in your code:
  my $schema1 = Library::Schema-&#62;connect(
    $dsn,
    $user,
    $password,
    { AutoCommit =&#62; 1 },
  );

  my $schema2 = Library::Schema-&#62;connect($coderef_returning_dbh);

  # fetch objects using Library::Schema::Result::DVD
  my $resultset = $schema1-&#62;resultset(&#39;DVD&#39;)-&#62;search( ... );
  my @dvd_objects = $schema2-&#62;resultset(&#39;DVD&#39;)-&#62;search( ... );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Creates database classes based on a schema. This is the recommended way to use <a href="../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> and allows you to use more than one concurrent connection with your classes.</p>

<p>NB: If you&#39;re used to <a href="../../Class/DBI.html" class="podlinkpod"
>Class::DBI</a> it&#39;s worth reading the <a href="#SYNOPSIS" class="podlinkpod"
>&#34;SYNOPSIS&#34;</a> carefully, as DBIx::Class does things a little differently. Note in particular which module inherits off which.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SETUP_METHODS"
>SETUP METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="load_namespaces"
>load_namespaces</a></h2>

<dl>
<dt><a name="Arguments:_%options?"
>Arguments: %options?</a></dt>
</dl>

<pre>  __PACKAGE__-&#62;load_namespaces();

  __PACKAGE__-&#62;load_namespaces(
     result_namespace =&#62; &#39;Res&#39;,
     resultset_namespace =&#62; &#39;RSet&#39;,
     default_resultset_class =&#62; &#39;+MyDB::Othernamespace::RSet&#39;,
  );</pre>

<p>With no arguments, this method uses <a href="../../Module/Find.html" class="podlinkpod"
>Module::Find</a> to load all of the Result and ResultSet classes under the namespace of the schema from which it is called. For example, <code>My::Schema</code> will by default find and load Result classes named <code>My::Schema::Result::*</code> and ResultSet classes named <code>My::Schema::ResultSet::*</code>.</p>

<p>ResultSet classes are associated with Result class of the same name. For example, <code>My::Schema::Result::CD</code> will get the ResultSet class <code>My::Schema::ResultSet::CD</code> if it is present.</p>

<p>Both Result and ResultSet namespaces are configurable via the <code>result_namespace</code> and <code>resultset_namespace</code> options.</p>

<p>Another option, <code>default_resultset_class</code> specifies a custom default ResultSet class for Result classes with no corresponding ResultSet.</p>

<p>All of the namespace and classname options are by default relative to the schema classname. To specify a fully-qualified name, prefix it with a literal <code>+</code>. For example, <code>+Other::NameSpace::Result</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Warnings"
>Warnings</a></h3>

<p>You will be warned if ResultSet classes are discovered for which there are no matching Result classes like this:</p>

<pre>  load_namespaces found ResultSet class $classname with no corresponding Result class</pre>

<p>If a Result class is found to already have a ResultSet class set using <a href="#resultset_class" class="podlinkpod"
>&#34;resultset_class&#34;</a> to some other class, you will be warned like this:</p>

<pre>  We found ResultSet class &#39;$rs_class&#39; for &#39;$result&#39;, but it seems
  that you had already set &#39;$result&#39; to use &#39;$rs_set&#39; instead</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Examples"
>Examples</a></h3>

<pre>  # load My::Schema::Result::CD, My::Schema::Result::Artist,
  #    My::Schema::ResultSet::CD, etc...
  My::Schema-&#62;load_namespaces;

  # Override everything to use ugly names.
  # In this example, if there is a My::Schema::Res::Foo, but no matching
  #   My::Schema::RSets::Foo, then Foo will have its
  #   resultset_class set to My::Schema::RSetBase
  My::Schema-&#62;load_namespaces(
    result_namespace =&#62; &#39;Res&#39;,
    resultset_namespace =&#62; &#39;RSets&#39;,
    default_resultset_class =&#62; &#39;RSetBase&#39;,
  );

  # Put things in other namespaces
  My::Schema-&#62;load_namespaces(
    result_namespace =&#62; &#39;+Some::Place::Results&#39;,
    resultset_namespace =&#62; &#39;+Another::Place::RSets&#39;,
  );</pre>

<p>To search multiple namespaces for either Result or ResultSet classes, use an arrayref of namespaces for that option. In the case that the same result (or resultset) class exists in multiple namespaces, later entries in the list of namespaces will override earlier ones.</p>

<pre>  My::Schema-&#62;load_namespaces(
    # My::Schema::Results_C::Foo takes precedence over My::Schema::Results_B::Foo :
    result_namespace =&#62; [ &#39;Results_A&#39;, &#39;Results_B&#39;, &#39;Results_C&#39; ],
    resultset_namespace =&#62; [ &#39;+Some::Place::RSets&#39;, &#39;RSets&#39; ],
  );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="load_classes"
>load_classes</a></h2>

<dl>
<dt><a name="Arguments:_@classes?,_{_$namespace_=&#62;_[_@classes_]_}+"
>Arguments: @classes?, { $namespace =&#62; [ @classes ] }+</a></dt>
</dl>

<p><a href="#load_classes" class="podlinkpod"
>&#34;load_classes&#34;</a> is an alternative method to <a href="#load_namespaces" class="podlinkpod"
>&#34;load_namespaces&#34;</a>, both of which serve similar purposes, each with different advantages and disadvantages. In the general case you should use <a href="#load_namespaces" class="podlinkpod"
>&#34;load_namespaces&#34;</a>, unless you need to be able to specify that only specific classes are loaded at runtime.</p>

<p>With no arguments, this method uses <a href="../../Module/Find.html" class="podlinkpod"
>Module::Find</a> to find all classes under the schema&#39;s namespace. Otherwise, this method loads the classes you specify (using <a href="../../use.html" class="podlinkpod"
>use</a>), and registers them (using <a href="#register_class" class="podlinkpod"
>&#34;register_class&#34;</a>).</p>

<p>It is possible to comment out classes with a leading <code>#</code>, but note that perl will think it&#39;s a mistake (trying to use a comment in a qw list), so you&#39;ll need to add <code>no warnings &#39;qw&#39;;</code> before your load_classes call.</p>

<p>If any classes found do not appear to be Result class files, you will get the following warning:</p>

<pre>   Failed to load $comp_class. Can&#39;t find source_name method. Is
   $comp_class really a full DBIC result class? Fix it, move it elsewhere,
   or make your load_classes call more specific.</pre>

<p>Example:</p>

<pre>  My::Schema-&#62;load_classes(); # loads My::Schema::CD, My::Schema::Artist,
                              # etc. (anything under the My::Schema namespace)

  # loads My::Schema::CD, My::Schema::Artist, Other::Namespace::Producer but
  # not Other::Namespace::LinerNotes nor My::Schema::Track
  My::Schema-&#62;load_classes(qw/ CD Artist #Track /, {
    Other::Namespace =&#62; [qw/ Producer #LinerNotes /],
  });</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="storage_type"
>storage_type</a></h2>

<dl>
<dt><a name="Arguments:_$storage_type|{$storage_type,_\%args}"
>Arguments: $storage_type|{$storage_type, \%args}</a></dt>

<dd>
<dt><a name="Return_Value:_$storage_type|{$storage_type,_\%args}"
>Return Value: $storage_type|{$storage_type, \%args}</a></dt>

<dd>
<dt><a name="Default_value:_DBIx::Class::Storage::DBI"
>Default value: DBIx::Class::Storage::DBI</a></dt>
</dl>

<p>Set the storage class that will be instantiated when <a href="#connect" class="podlinkpod"
>&#34;connect&#34;</a> is called. If the classname starts with <code>::</code>, the prefix <code>DBIx::Class::Storage</code> is assumed by <a href="#connect" class="podlinkpod"
>&#34;connect&#34;</a>.</p>

<p>You want to use this to set subclasses of <a href="../../DBIx/Class/Storage/DBI.html" class="podlinkpod"
>DBIx::Class::Storage::DBI</a> in cases where the appropriate subclass is not autodetected.</p>

<p>If your storage type requires instantiation arguments, those are defined as a second argument in the form of a hashref and the entire value needs to be wrapped into an arrayref or a hashref. We support both types of refs here in order to play nice with your Config::[class] or your choice. See <a href="../../DBIx/Class/Storage/DBI/Replicated.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated</a> for an example of this.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="exception_action"
>exception_action</a></h2>

<dl>
<dt><a name="Arguments:_$code_reference"
>Arguments: $code_reference</a></dt>

<dd>
<dt><a name="Return_Value:_$code_reference"
>Return Value: $code_reference</a></dt>

<dd>
<dt><a name="Default_value:_None"
>Default value: None</a></dt>
</dl>

<p>When <a href="#throw_exception" class="podlinkpod"
>&#34;throw_exception&#34;</a> is invoked and <a href="#exception_action" class="podlinkpod"
>&#34;exception_action&#34;</a> is set to a code reference, this reference will be called instead of <a href="../../DBIx/Class/Exception.html#throw" class="podlinkpod"
>&#34;throw&#34; in DBIx::Class::Exception</a>, with the exception message passed as the only argument.</p>

<p>Your custom throw code <b>must</b> rethrow the exception, as <a href="#throw_exception" class="podlinkpod"
>&#34;throw_exception&#34;</a> is an integral part of DBIC&#39;s internal execution control flow.</p>

<p>Example:</p>

<pre>   package My::Schema;
   use base qw/DBIx::Class::Schema/;
   use My::ExceptionClass;
   __PACKAGE__-&#62;exception_action(sub { My::ExceptionClass-&#62;throw(@_) });
   __PACKAGE__-&#62;load_classes;

   # or:
   my $schema_obj = My::Schema-&#62;connect( .... );
   $schema_obj-&#62;exception_action(sub { My::ExceptionClass-&#62;throw(@_) });</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="stacktrace"
>stacktrace</a></h2>

<dl>
<dt><a name="Arguments:_boolean"
>Arguments: boolean</a></dt>
</dl>

<p>Whether <a href="#throw_exception" class="podlinkpod"
>&#34;throw_exception&#34;</a> should include stack trace information. Defaults to false normally, but defaults to true if <code>$ENV{DBIC_TRACE}</code> is true.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sqlt_deploy_hook"
>sqlt_deploy_hook</a></h2>

<dl>
<dt><a name="Arguments:_$sqlt_schema"
>Arguments: $sqlt_schema</a></dt>
</dl>

<p>An optional sub which you can declare in your own Schema class that will get passed the <a href="../../SQL/Translator/Schema.html" class="podlinkpod"
>SQL::Translator::Schema</a> object when you deploy the schema via <a href="#create_ddl_dir" class="podlinkpod"
>&#34;create_ddl_dir&#34;</a> or <a href="#deploy" class="podlinkpod"
>&#34;deploy&#34;</a>.</p>

<p>For an example of what you can do with this, see <a href="../../DBIx/Class/Manual/Cookbook.html#Adding_Indexes_And_Functions_To_Your_SQL" class="podlinkpod"
>&#34;Adding Indexes And Functions To Your SQL&#34; in DBIx::Class::Manual::Cookbook</a>.</p>

<p>Note that sqlt_deploy_hook is called by <a href="#deployment_statements" class="podlinkpod"
>&#34;deployment_statements&#34;</a>, which in turn is called before <a href="#deploy" class="podlinkpod"
>&#34;deploy&#34;</a>. Therefore the hook can be used only to manipulate the <a href="../../SQL/Translator/Schema.html" class="podlinkpod"
>SQL::Translator::Schema</a> object before it is turned into SQL fed to the database. If you want to execute post-deploy statements which can not be generated by <a href="../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a>, the currently suggested method is to overload <a href="#deploy" class="podlinkpod"
>&#34;deploy&#34;</a> and use <a href="../../DBIx/Class/Storage/DBI.html#dbh_do" class="podlinkpod"
>dbh_do</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect"
>connect</a></h2>

<dl>
<dt><a name="Arguments:_@connectinfo"
>Arguments: @connectinfo</a></dt>

<dd>
<dt><a name="Return_Value:_$new_schema"
>Return Value: $new_schema</a></dt>
</dl>

<p>Creates and returns a new Schema object. The connection info set on it is used to create a new instance of the storage backend and set it on the Schema object.</p>

<p>See <a href="../../DBIx/Class/Storage/DBI.html#connect_info" class="podlinkpod"
>&#34;connect_info&#34; in DBIx::Class::Storage::DBI</a> for DBI-specific syntax on the <code>@connectinfo</code> argument, or <a href="../../DBIx/Class/Storage.html" class="podlinkpod"
>DBIx::Class::Storage</a> in general.</p>

<p>Note that <code>connect_info</code> expects an arrayref of arguments, but <code>connect</code> does not. <code>connect</code> wraps its arguments in an arrayref before passing them to <code>connect_info</code>.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Overloading"
>Overloading</a></h3>

<p><code>connect</code> is a convenience method. It is equivalent to calling $schema-&#62;clone-&#62;connection(@connectinfo). To write your own overloaded version, overload <a href="#connection" class="podlinkpod"
>&#34;connection&#34;</a> instead.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="resultset"
>resultset</a></h2>

<dl>
<dt><a name="Arguments:_$source_name"
>Arguments: <a href="../../DBIx/Class/ResultSource.html#source_name" class="podlinkpod"
>$source_name</a></a></dt>

<dd>
<dt><a name="Return_Value:_$resultset"
>Return Value: <a href="../../DBIx/Class/ResultSet.html" class="podlinkpod"
>$resultset</a></a></dt>
</dl>

<pre>  my $rs = $schema-&#62;resultset(&#39;DVD&#39;);</pre>

<p>Returns the <a href="../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> object for the registered source name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sources"
>sources</a></h2>

<dl>
<dt><a name="Return_Value:_@source_names"
>Return Value: <a href="../../DBIx/Class/ResultSource.html#source_name" class="podlinkpod"
>@source_names</a></a></dt>
</dl>

<pre>  my @source_names = $schema-&#62;sources;</pre>

<p>Lists names of all the sources registered on this Schema object.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="source"
>source</a></h2>

<dl>
<dt><a name="Arguments:_$source_name"
>Arguments: <a href="../../DBIx/Class/ResultSource.html#source_name" class="podlinkpod"
>$source_name</a></a></dt>

<dd>
<dt><a name="Return_Value:_$result_source"
>Return Value: <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>$result_source</a></a></dt>
</dl>

<pre>  my $source = $schema-&#62;source(&#39;Book&#39;);</pre>

<p>Returns the <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> object for the registered source name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="class"
>class</a></h2>

<dl>
<dt><a name="Arguments:_$source_name"
>Arguments: <a href="../../DBIx/Class/ResultSource.html#source_name" class="podlinkpod"
>$source_name</a></a></dt>

<dd>
<dt><a name="Return_Value:_$classname"
>Return Value: $classname</a></dt>
</dl>

<pre>  my $class = $schema-&#62;class(&#39;CD&#39;);</pre>

<p>Retrieves the Result class name for the given source name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="txn_do"
>txn_do</a></h2>

<dl>
<dt><a name="Arguments:_$coderef,_@coderef_args?"
>Arguments: <code>$coderef</code>, @coderef_args?</a></dt>

<dd>
<dt><a name="Return_Value:_The_return_value_of_$coderef"
>Return Value: The return value of $coderef</a></dt>
</dl>

<p>Executes <code>$coderef</code> with (optional) arguments <code>@coderef_args</code> atomically, returning its result (if any). Equivalent to calling $schema-&#62;storage-&#62;txn_do. See <a href="../../DBIx/Class/Storage.html#txn_do" class="podlinkpod"
>&#34;txn_do&#34; in DBIx::Class::Storage</a> for more information.</p>

<p>This interface is preferred over using the individual methods <a href="#txn_begin" class="podlinkpod"
>&#34;txn_begin&#34;</a>, <a href="#txn_commit" class="podlinkpod"
>&#34;txn_commit&#34;</a>, and <a href="#txn_rollback" class="podlinkpod"
>&#34;txn_rollback&#34;</a> below.</p>

<p>WARNING: If you are connected with <code>AutoCommit =&#62; 0</code> the transaction is considered nested, and you will still need to call <a href="#txn_commit" class="podlinkpod"
>&#34;txn_commit&#34;</a> to write your changes when appropriate. You will also want to connect with <code>auto_savepoint =&#62; 1</code> to get partial rollback to work, if the storage driver for your database supports it.</p>

<p>Connecting with <code>AutoCommit =&#62; 1</code> is recommended.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="txn_scope_guard"
>txn_scope_guard</a></h2>

<p>Runs <code>txn_scope_guard</code> on the schema&#39;s storage. See <a href="../../DBIx/Class/Storage.html#txn_scope_guard" class="podlinkpod"
>&#34;txn_scope_guard&#34; in DBIx::Class::Storage</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="txn_begin"
>txn_begin</a></h2>

<p>Begins a transaction (does nothing if AutoCommit is off). Equivalent to calling $schema-&#62;storage-&#62;txn_begin. See <a href="../../DBIx/Class/Storage.html#txn_begin" class="podlinkpod"
>&#34;txn_begin&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="txn_commit"
>txn_commit</a></h2>

<p>Commits the current transaction. Equivalent to calling $schema-&#62;storage-&#62;txn_commit. See <a href="../../DBIx/Class/Storage.html#txn_commit" class="podlinkpod"
>&#34;txn_commit&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="txn_rollback"
>txn_rollback</a></h2>

<p>Rolls back the current transaction. Equivalent to calling $schema-&#62;storage-&#62;txn_rollback. See <a href="../../DBIx/Class/Storage.html#txn_rollback" class="podlinkpod"
>&#34;txn_rollback&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="storage"
>storage</a></h2>

<pre>  my $storage = $schema-&#62;storage;</pre>

<p>Returns the <a href="../../DBIx/Class/Storage.html" class="podlinkpod"
>DBIx::Class::Storage</a> object for this Schema. Grab this if you want to turn on SQL statement debugging at runtime, or set the quote character. For the default storage, the documentation can be found in <a href="../../DBIx/Class/Storage/DBI.html" class="podlinkpod"
>DBIx::Class::Storage::DBI</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="populate"
>populate</a></h2>

<dl>
<dt><a name="Arguments:_$source_name,_[_\@column_list,_\@row_values+_]_|_[_\%col_data+_]"
>Arguments: <a href="../../DBIx/Class/ResultSource.html#source_name" class="podlinkpod"
>$source_name</a>, [ \@column_list, \@row_values+ ] | [ \%col_data+ ]</a></dt>

<dd>
<dt><a name="Return_Value:_\@result_objects_(scalar_context)_|_@result_objects_(list_context)"
>Return Value: <a href="../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>\@result_objects</a> (scalar context) | <a href="../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>@result_objects</a> (list context)</a></dt>
</dl>

<p>A convenience shortcut to <a href="../../DBIx/Class/ResultSet.html#populate" class="podlinkpod"
>&#34;populate&#34; in DBIx::Class::ResultSet</a>. Equivalent to:</p>

<pre> $schema-&#62;resultset($source_name)-&#62;populate([...]);</pre>

<dl>
<dt><a name="NOTE"
>NOTE</a></dt>

<dd>
<p>The context of this method call has an important effect on what is submitted to storage. In void context data is fed directly to fastpath insertion routines provided by the underlying storage (most often <a href="../../DBI.html#execute_for_fetch" class="podlinkpod"
>&#34;execute_for_fetch&#34; in DBI</a>), bypassing the <a href="../../DBIx/Class/Row.html#new" class="podlinkpod"
>new</a> and <a href="../../DBIx/Class/Row.html#insert" class="podlinkpod"
>insert</a> calls on the <a href="../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>Result</a> class, including any augmentation of these methods provided by components. For example if you are using something like <a href="../../DBIx/Class/UUIDColumns.html" class="podlinkpod"
>DBIx::Class::UUIDColumns</a> to create primary keys for you, you will find that your PKs are empty. In this case you will have to explicitly force scalar or list context in order to create those values.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connection"
>connection</a></h2>

<dl>
<dt><a name="Arguments:_@args"
>Arguments: @args</a></dt>

<dd>
<dt><a name="Return_Value:_$new_schema"
>Return Value: $new_schema</a></dt>
</dl>

<p>Similar to <a href="#connect" class="podlinkpod"
>&#34;connect&#34;</a> except sets the storage object and connection data in-place on the Schema class. You should probably be calling <a href="#connect" class="podlinkpod"
>&#34;connect&#34;</a> to get a proper Schema object instead.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="Overloading"
>Overloading</a></h3>

<p>Overload <code>connection</code> to change the behaviour of <code>connect</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="compose_namespace"
>compose_namespace</a></h2>

<dl>
<dt><a name="Arguments:_$target_namespace,_$additional_base_class?"
>Arguments: $target_namespace, $additional_base_class?</a></dt>

<dd>
<dt><a name="Retur_Value:_$new_schema"
>Retur Value: $new_schema</a></dt>
</dl>

<p>For each <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> in the schema, this method creates a class in the target namespace (e.g. $target_namespace::CD, $target_namespace::Artist) that inherits from the corresponding classes attached to the current schema.</p>

<p>It also attaches a corresponding <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> object to the new $schema object. If <code>$additional_base_class</code> is given, the new composed classes will inherit from first the corresponding class from the current schema then the base class.</p>

<p>For example, for a schema with My::Schema::CD and My::Schema::Artist classes,</p>

<pre>  $schema-&#62;compose_namespace(&#39;My::DB&#39;, &#39;Base::Class&#39;);
  print join (&#39;, &#39;, @My::DB::CD::ISA) . &#34;\n&#34;;
  print join (&#39;, &#39;, @My::DB::Artist::ISA) .&#34;\n&#34;;</pre>

<p>will produce the output</p>

<pre>  My::Schema::CD, Base::Class
  My::Schema::Artist, Base::Class</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="svp_begin"
>svp_begin</a></h2>

<p>Creates a new savepoint (does nothing outside a transaction). Equivalent to calling $schema-&#62;storage-&#62;svp_begin. See <a href="../../DBIx/Class/Storage.html#svp_begin" class="podlinkpod"
>&#34;svp_begin&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="svp_release"
>svp_release</a></h2>

<p>Releases a savepoint (does nothing outside a transaction). Equivalent to calling $schema-&#62;storage-&#62;svp_release. See <a href="../../DBIx/Class/Storage.html#svp_release" class="podlinkpod"
>&#34;svp_release&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="svp_rollback"
>svp_rollback</a></h2>

<p>Rollback to a savepoint (does nothing outside a transaction). Equivalent to calling $schema-&#62;storage-&#62;svp_rollback. See <a href="../../DBIx/Class/Storage.html#svp_rollback" class="podlinkpod"
>&#34;svp_rollback&#34; in DBIx::Class::Storage</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="clone"
>clone</a></h2>

<dl>
<dt><a name="Arguments:_%attrs?"
>Arguments: %attrs?</a></dt>

<dd>
<dt><a name="Return_Value:_$new_schema"
>Return Value: $new_schema</a></dt>
</dl>

<p>Clones the schema and its associated result_source objects and returns the copy. The resulting copy will have the same attributes as the source schema, except for those attributes explicitly overriden by the provided <code>%attrs</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="throw_exception"
>throw_exception</a></h2>

<dl>
<dt><a name="Arguments:_$message"
>Arguments: $message</a></dt>
</dl>

<p>Throws an exception. Obeys the exemption rules of <a href="../../DBIx/Class/Carp.html" class="podlinkpod"
>DBIx::Class::Carp</a> to report errors from outer-user&#39;s perspective. See <a href="#exception_action" class="podlinkpod"
>&#34;exception_action&#34;</a> for details on overriding this method&#39;s behavior. If <a href="#stacktrace" class="podlinkpod"
>&#34;stacktrace&#34;</a> is turned on, <code>throw_exception</code>&#39;s default behavior will provide a detailed stack trace.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="deploy"
>deploy</a></h2>

<dl>
<dt><a name="Arguments:_\%sqlt_args,_$dir"
>Arguments: \%sqlt_args, $dir</a></dt>
</dl>

<p>Attempts to deploy the schema to the current storage using <a href="../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a>.</p>

<p>See <a href="../../SQL/Translator.html#METHODS" class="podlinkpod"
>&#34;METHODS&#34; in SQL::Translator</a> for a list of values for <code>\%sqlt_args</code>. The most common value for this would be <code>{ add_drop_table =&#62; 1 }</code> to have the SQL produced include a <code>DROP TABLE</code> statement for each table created. For quoting purposes supply <code>quote_identifiers</code>.</p>

<p>Additionally, the DBIx::Class parser accepts a <code>sources</code> parameter as a hash ref or an array ref, containing a list of source to deploy. If present, then only the sources listed will get deployed. Furthermore, you can use the <code>add_fk_index</code> parser parameter to prevent the parser from creating an index for each FK.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="deployment_statements"
>deployment_statements</a></h2>

<dl>
<dt><a name="Arguments:_See_&#34;deployment_statements&#34;_in_DBIx::Class::Storage::DBI"
>Arguments: See <a href="../../DBIx/Class/Storage/DBI.html#deployment_statements" class="podlinkpod"
>&#34;deployment_statements&#34; in DBIx::Class::Storage::DBI</a></a></dt>

<dd>
<dt><a name="Return_Value:_$listofstatements"
>Return Value: $listofstatements</a></dt>
</dl>

<p>A convenient shortcut to <code>$self-&#62;storage-&#62;deployment_statements($self, @args)</code>. Returns the SQL statements used by <a href="#deploy" class="podlinkpod"
>&#34;deploy&#34;</a> and <a href="../../DBIx/Class/Schema/Storage.html#deploy" class="podlinkpod"
>&#34;deploy&#34; in DBIx::Class::Schema::Storage</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_ddl_dir"
>create_ddl_dir</a></h2>

<dl>
<dt><a name="Arguments:_See_&#34;create_ddl_dir&#34;_in_DBIx::Class::Storage::DBI"
>Arguments: See <a href="../../DBIx/Class/Storage/DBI.html#create_ddl_dir" class="podlinkpod"
>&#34;create_ddl_dir&#34; in DBIx::Class::Storage::DBI</a></a></dt>
</dl>

<p>A convenient shortcut to <code>$self-&#62;storage-&#62;create_ddl_dir($self, @args)</code>.</p>

<p>Creates an SQL file based on the Schema, for each of the specified database types, in the given directory.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ddl_filename"
>ddl_filename</a></h2>

<dl>
<dt><a name="Arguments:_$database-type,_$version,_$directory,_$preversion"
>Arguments: $database-type, $version, $directory, $preversion</a></dt>

<dd>
<dt><a name="Return_Value:_$normalised_filename"
>Return Value: $normalised_filename</a></dt>
</dl>

<pre>  my $filename = $table-&#62;ddl_filename($type, $version, $dir, $preversion)</pre>

<p>This method is called by <code>create_ddl_dir</code> to compose a file name out of the supplied directory, database type and version number. The default file name format is: <code>$dir$schema-$version-$type.sql</code>.</p>

<p>You may override this method in your schema if you wish to use a different format.</p>

<pre> WARNING

 Prior to DBIx::Class version 0.08100 this method had a different signature:

    my $filename = $table-&#62;ddl_filename($type, $dir, $version, $preversion)

 In recent versions variables $dir and $version were reversed in order to
 bring the signature in line with other Schema/Storage methods. If you
 really need to maintain backward compatibility, you can do the following
 in any overriding methods:

    ($dir, $version) = ($version, $dir) if ($DBIx::Class::VERSION &#60; 0.08100);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="thaw"
>thaw</a></h2>

<p>Provided as the recommended way of thawing schema objects. You can call <code>Storable::thaw</code> directly if you wish, but the thawed objects will not have a reference to any schema, so are rather useless.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="freeze"
>freeze</a></h2>

<p>This doesn&#39;t actually do anything more than call <a href="../../Storable.html#nfreeze" class="podlinkpod"
>&#34;nfreeze&#34; in Storable</a>, it is just provided here for symmetry.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dclone"
>dclone</a></h2>

<dl>
<dt><a name="Arguments:_$object"
>Arguments: $object</a></dt>

<dd>
<dt><a name="Return_Value:_dcloned_$object"
>Return Value: dcloned $object</a></dt>
</dl>

<p>Recommended way of dcloning <a href="../../DBIx/Class/Row.html" class="podlinkpod"
>DBIx::Class::Row</a> and <a href="../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> objects so their references to the schema object (which itself is <b>not</b> cloned) are properly maintained.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="schema_version"
>schema_version</a></h2>

<p>Returns the current schema class&#39; $VERSION in a normalised way.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="register_class"
>register_class</a></h2>

<dl>
<dt><a name="Arguments:_$source_name,_$component_class"
>Arguments: $source_name, $component_class</a></dt>
</dl>

<p>This method is called by <a href="#load_namespaces" class="podlinkpod"
>&#34;load_namespaces&#34;</a> and <a href="#load_classes" class="podlinkpod"
>&#34;load_classes&#34;</a> to install the found classes into your Schema. You should be using those instead of this one.</p>

<p>You will only need this method if you have your Result classes in files which are not named after the packages (or all in the same file). You may also need it to register classes at runtime.</p>

<p>Registers a class which isa DBIx::Class::ResultSourceProxy. Equivalent to calling:</p>

<pre>  $schema-&#62;register_source($source_name, $component_class-&#62;result_source_instance);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="register_source"
>register_source</a></h2>

<dl>
<dt><a name="Arguments:_$source_name,_$result_source"
>Arguments: $source_name, <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>$result_source</a></a></dt>
</dl>

<p>This method is called by <a href="#register_class" class="podlinkpod"
>&#34;register_class&#34;</a>.</p>

<p>Registers the <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> in the schema with the given source name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="unregister_source"
>unregister_source</a></h2>

<dl>
<dt><a name="Arguments:_$source_name"
>Arguments: $source_name</a></dt>
</dl>

<p>Removes the <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>DBIx::Class::ResultSource</a> from the schema for the given source name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="register_extra_source"
>register_extra_source</a></h2>

<dl>
<dt><a name="Arguments:_$source_name,_$result_source"
>Arguments: $source_name, <a href="../../DBIx/Class/ResultSource.html" class="podlinkpod"
>$result_source</a></a></dt>
</dl>

<p>As <a href="#register_source" class="podlinkpod"
>&#34;register_source&#34;</a> but should be used if the result class already has a source and you want to register an extra one.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="compose_connection_(DEPRECATED)"
>compose_connection (DEPRECATED)</a></h2>

<dl>
<dt><a name="Arguments:_$target_namespace,_@db_info"
>Arguments: $target_namespace, @db_info</a></dt>

<dd>
<dt><a name="Return_Value:_$new_schema"
>Return Value: $new_schema</a></dt>
</dl>

<p>DEPRECATED. You probably wanted compose_namespace.</p>

<p>Actually, you probably just wanted to call connect.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR_AND_CONTRIBUTORS"
>AUTHOR AND CONTRIBUTORS</a></h1>

<p>See <a href="../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>AUTHOR</a> and <a href="../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>CONTRIBUTORS</a> in DBIx::Class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
