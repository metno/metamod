<html><head><title>DBIx::Class::Storage::DBI</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#connect_info'>connect_info</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#DBIx%3A%3AClass_specific_connection_attributes'>DBIx::Class specific connection attributes</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#on_connect_do'>on_connect_do</a>
    <li class='indexItem indexItem2'><a href='#on_disconnect_do'>on_disconnect_do</a>
    <li class='indexItem indexItem2'><a href='#dbh_do'>dbh_do</a>
    <li class='indexItem indexItem2'><a href='#disconnect'>disconnect</a>
    <li class='indexItem indexItem2'><a href='#with_deferred_fk_checks'>with_deferred_fk_checks</a>
    <li class='indexItem indexItem2'><a href='#connected'>connected</a>
    <li class='indexItem indexItem2'><a href='#dbh'>dbh</a>
    <li class='indexItem indexItem2'><a href='#select'>select</a>
    <li class='indexItem indexItem2'><a href='#sql_limit_dialect'>sql_limit_dialect</a>
    <li class='indexItem indexItem2'><a href='#last_insert_id'>last_insert_id</a>
    <li class='indexItem indexItem2'><a href='#_native_data_type'>_native_data_type</a>
    <li class='indexItem indexItem2'><a href='#sqlt_type'>sqlt_type</a>
    <li class='indexItem indexItem2'><a href='#bind_attribute_by_data_type'>bind_attribute_by_data_type</a>
    <li class='indexItem indexItem2'><a href='#is_datatype_numeric'>is_datatype_numeric</a>
    <li class='indexItem indexItem2'><a href='#create_ddl_dir'>create_ddl_dir</a>
    <li class='indexItem indexItem2'><a href='#deployment_statements'>deployment_statements</a>
    <li class='indexItem indexItem2'><a href='#datetime_parser'>datetime_parser</a>
    <li class='indexItem indexItem2'><a href='#datetime_parser_type'>datetime_parser_type</a>
    <li class='indexItem indexItem2'><a href='#build_datetime_parser'>build_datetime_parser</a>
    <li class='indexItem indexItem2'><a href='#is_replicating'>is_replicating</a>
    <li class='indexItem indexItem2'><a href='#lag_behind_master'>lag_behind_master</a>
    <li class='indexItem indexItem2'><a href='#relname_to_table_alias'>relname_to_table_alias</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#USAGE_NOTES'>USAGE NOTES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#DBIx%3A%3AClass_and_AutoCommit'>DBIx::Class and AutoCommit</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR_AND_CONTRIBUTORS'>AUTHOR AND CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Storage::DBI - DBI storage handler</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  my $schema = MySchema-&#62;connect(&#39;dbi:SQLite:my.db&#39;);

  $schema-&#62;storage-&#62;debug(1);

  my @stuff = $schema-&#62;storage-&#62;dbh_do(
    sub {
      my ($storage, $dbh, @args) = @_;
      $dbh-&#62;do(&#34;DROP TABLE authors&#34;);
    },
    @column_list
  );

  $schema-&#62;resultset(&#39;Book&#39;)-&#62;search({
     written_on =&#62; $schema-&#62;storage-&#62;datetime_parser-&#62;format_datetime(DateTime-&#62;now)
  });</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This class represents the connection to an RDBMS via <a href="../../../DBI.html" class="podlinkpod"
>DBI</a>. See <a href="../../../DBIx/Class/Storage.html" class="podlinkpod"
>DBIx::Class::Storage</a> for general information. This pod only documents DBI-specific methods and behaviors.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_info"
>connect_info</a></h2>

<p>This method is normally called by <a href="../../../DBIx/Class/Schema.html#connection" class="podlinkpod"
>&#34;connection&#34; in DBIx::Class::Schema</a>, which encapsulates its argument list in an arrayref before passing them here.</p>

<p>The argument list may contain:</p>

<ul>
<li>The same 4-element argument set one would normally pass to <a href="../../../DBI.html#connect" class="podlinkpod"
>&#34;connect&#34; in DBI</a>, optionally followed by <a href="#DBIx%3A%3AClass_specific_connection_attributes" class="podlinkpod"
>extra attributes</a> recognized by DBIx::Class:
<pre>  $connect_info_args = [ $dsn, $user, $password, \%dbi_attributes?, \%extra_attributes? ];</pre>
</li>

<li>A single code reference which returns a connected <a href="../../../DBI.html#connect" class="podlinkpod"
>DBI database handle</a> optionally followed by <a href="#DBIx%3A%3AClass_specific_connection_attributes" class="podlinkpod"
>extra attributes</a> recognized by DBIx::Class:
<pre>  $connect_info_args = [ sub { DBI-&#62;connect (...) }, \%extra_attributes? ];</pre>
</li>

<li>A single hashref with all the attributes and the dsn/user/password mixed together:
<pre>  $connect_info_args = [{
    dsn =&#62; $dsn,
    user =&#62; $user,
    password =&#62; $pass,
    %dbi_attributes,
    %extra_attributes,
  }];

  $connect_info_args = [{
    dbh_maker =&#62; sub { DBI-&#62;connect (...) },
    %dbi_attributes,
    %extra_attributes,
  }];</pre>

<p>This is particularly useful for <a href="../../../Catalyst.html" class="podlinkpod"
>Catalyst</a> based applications, allowing the following config (<a href="../../../Config/General.html" class="podlinkpod"
>Config::General</a> style):</p>

<pre>  &#60;Model::DB&#62;
    schema_class   App::DB
    &#60;connect_info&#62;
      dsn          dbi:mysql:database=test
      user         testuser
      password     TestPass
      AutoCommit   1
    &#60;/connect_info&#62;
  &#60;/Model::DB&#62;</pre>

<p>The <code>dsn</code>/<code>user</code>/<code>password</code> combination can be substituted by the <code>dbh_maker</code> key whose value is a coderef that returns a connected <a href="../../../DBI.html#connect" class="podlinkpod"
>DBI database handle</a></p>
</li>
</ul>

<p>Please note that the <a href="../../../DBI.html" class="podlinkpod"
>DBI</a> docs recommend that you always explicitly set <code>AutoCommit</code> to either <i>0</i> or <i>1</i>. <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> further recommends that it be set to <i>1</i>, and that you perform transactions via our <a href="../../../DBIx/Class/Schema.html#txn_do" class="podlinkpod"
>&#34;txn_do&#34; in DBIx::Class::Schema</a> method. <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> will set it to <i>1</i> if you do not do explicitly set it to zero. This is the default for most DBDs. See <a href="#DBIx%3A%3AClass_and_AutoCommit" class="podlinkpod"
>&#34;DBIx::Class and AutoCommit&#34;</a> for details.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="DBIx::Class_specific_connection_attributes"
>DBIx::Class specific connection attributes</a></h3>

<p>In addition to the standard <a href="../../../DBI.html#ATTRIBUTES_COMMON_TO_ALL_HANDLES" class="podlinkpod"
>DBI</a> <a href="../../../DBI.html#Database_Handle_Attributes" class="podlinkpod"
>connection</a> attributes, DBIx::Class recognizes the following connection options. These options can be mixed in with your other <a href="../../../DBI.html" class="podlinkpod"
>DBI</a> connection attributes, or placed in a separate hashref (<code>\%extra_attributes</code>) as shown above.</p>

<p>Every time <code>connect_info</code> is invoked, any previous settings for these options will be cleared before setting the new ones, regardless of whether any options are specified in the new <code>connect_info</code>.</p>

<dl>
<dt><a name="on_connect_do"
>on_connect_do</a></dt>

<dd>
<p>Specifies things to do immediately after connecting or re-connecting to the database. Its value may contain:</p>

<dl>
<dt><a name="a_scalar"
>a scalar</a></dt>

<dd>
<p>This contains one SQL statement to execute.</p>

<dt><a name="an_array_reference"
>an array reference</a></dt>

<dd>
<p>This contains SQL statements to execute in order. Each element contains a string or a code reference that returns a string.</p>

<dt><a name="a_code_reference"
>a code reference</a></dt>

<dd>
<p>This contains some code to execute. Unlike code references within an array reference, its return value is ignored.</p>
</dd>
</dl>

<dt><a name="on_disconnect_do"
>on_disconnect_do</a></dt>

<dd>
<p>Takes arguments in the same form as <a href="#on_connect_do" class="podlinkpod"
>&#34;on_connect_do&#34;</a> and executes them immediately before disconnecting from the database.</p>

<p>Note, this only runs if you explicitly call <a href="#disconnect" class="podlinkpod"
>&#34;disconnect&#34;</a> on the storage object.</p>

<dt><a name="on_connect_call"
>on_connect_call</a></dt>

<dd>
<p>A more generalized form of <a href="#on_connect_do" class="podlinkpod"
>&#34;on_connect_do&#34;</a> that calls the specified <code>connect_call_METHOD</code> methods in your storage driver.</p>

<pre>  on_connect_do =&#62; &#39;select 1&#39;</pre>

<p>is equivalent to:</p>

<pre>  on_connect_call =&#62; [ [ do_sql =&#62; &#39;select 1&#39; ] ]</pre>

<p>Its values may contain:</p>

<dl>
<dt><a name="a_scalar"
>a scalar</a></dt>

<dd>
<p>Will call the <code>connect_call_METHOD</code> method.</p>

<dt><a name="a_code_reference"
>a code reference</a></dt>

<dd>
<p>Will execute <code>$code-&#62;($storage)</code></p>

<dt><a name="an_array_reference"
>an array reference</a></dt>

<dd>
<p>Each value can be a method name or code reference.</p>

<dt><a name="an_array_of_arrays"
>an array of arrays</a></dt>

<dd>
<p>For each array, the first item is taken to be the <code>connect_call_</code> method name or code reference, and the rest are parameters to it.</p>
</dd>
</dl>

<p>Some predefined storage methods you may use:</p>

<dl>
<dt><a name="do_sql"
>do_sql</a></dt>

<dd>
<p>Executes a SQL string or a code reference that returns a SQL string. This is what <a href="#on_connect_do" class="podlinkpod"
>&#34;on_connect_do&#34;</a> and <a href="#on_disconnect_do" class="podlinkpod"
>&#34;on_disconnect_do&#34;</a> use.</p>

<p>It can take:</p>

<dl>
<dt><a name="a_scalar"
>a scalar</a></dt>

<dd>
<p>Will execute the scalar as SQL.</p>

<dt><a name="an_arrayref"
>an arrayref</a></dt>

<dd>
<p>Taken to be arguments to <a href="../../../DBI.html#do" class="podlinkpod"
>&#34;do&#34; in DBI</a>, the SQL string optionally followed by the attributes hashref and bind values.</p>

<dt><a name="a_code_reference"
>a code reference</a></dt>

<dd>
<p>Will execute <code>$code-&#62;($storage)</code> and execute the return array refs as above.</p>
</dd>
</dl>

<dt><a name="datetime_setup"
>datetime_setup</a></dt>

<dd>
<p>Execute any statements necessary to initialize the database session to return and accept datetime/timestamp values used with <a href="../../../DBIx/Class/InflateColumn/DateTime.html" class="podlinkpod"
>DBIx::Class::InflateColumn::DateTime</a>.</p>

<p>Only necessary for some databases, see your specific storage driver for implementation details.</p>
</dd>
</dl>

<dt><a name="on_disconnect_call"
>on_disconnect_call</a></dt>

<dd>
<p>Takes arguments in the same form as <a href="#on_connect_call" class="podlinkpod"
>&#34;on_connect_call&#34;</a> and executes them immediately before disconnecting from the database.</p>

<p>Calls the <code>disconnect_call_METHOD</code> methods as opposed to the <code>connect_call_METHOD</code> methods called by <a href="#on_connect_call" class="podlinkpod"
>&#34;on_connect_call&#34;</a>.</p>

<p>Note, this only runs if you explicitly call <a href="#disconnect" class="podlinkpod"
>&#34;disconnect&#34;</a> on the storage object.</p>

<dt><a name="disable_sth_caching"
>disable_sth_caching</a></dt>

<dd>
<p>If set to a true value, this option will disable the caching of statement handles via <a href="../../../DBI.html#prepare_cached" class="podlinkpod"
>&#34;prepare_cached&#34; in DBI</a>.</p>

<dt><a name="limit_dialect"
>limit_dialect</a></dt>

<dd>
<p>Sets a specific SQL::Abstract::Limit-style limit dialect, overriding the default <a href="#sql_limit_dialect" class="podlinkpod"
>&#34;sql_limit_dialect&#34;</a> setting of the storage (if any). For a list of available limit dialects see <a href="../../../DBIx/Class/SQLMaker/LimitDialects.html" class="podlinkpod"
>DBIx::Class::SQLMaker::LimitDialects</a>.</p>

<dt><a name="quote_names"
>quote_names</a></dt>

<dd>
<p>When true automatically sets <a href="#quote_char" class="podlinkpod"
>&#34;quote_char&#34;</a> and <a href="#name_sep" class="podlinkpod"
>&#34;name_sep&#34;</a> to the characters appropriate for your particular RDBMS. This option is preferred over specifying <a href="#quote_char" class="podlinkpod"
>&#34;quote_char&#34;</a> directly.</p>

<dt><a name="quote_char"
>quote_char</a></dt>

<dd>
<p>Specifies what characters to use to quote table and column names.</p>

<p><code>quote_char</code> expects either a single character, in which case is it is placed on either side of the table/column name, or an arrayref of length 2 in which case the table/column name is placed between the elements.</p>

<p>For example under MySQL you should use <code>quote_char =&#62; &#39;`&#39;</code>, and for SQL Server you should use <code>quote_char =&#62; [qw/[ ]/]</code>.</p>

<dt><a name="name_sep"
>name_sep</a></dt>

<dd>
<p>This parameter is only useful in conjunction with <code>quote_char</code>, and is used to specify the character that separates elements (schemas, tables, columns) from each other. If unspecified it defaults to the most commonly used <code>.</code>.</p>

<dt><a name="unsafe"
>unsafe</a></dt>

<dd>
<p>This Storage driver normally installs its own <code>HandleError</code>, sets <code>RaiseError</code> and <code>ShowErrorStatement</code> on, and sets <code>PrintError</code> off on all database handles, including those supplied by a coderef. It does this so that it can have consistent and useful error behavior.</p>

<p>If you set this option to a true value, Storage will not do its usual modifications to the database handle&#39;s attributes, and instead relies on the settings in your connect_info DBI options (or the values you set in your connection coderef, in the case that you are connecting via coderef).</p>

<p>Note that your custom settings can cause Storage to malfunction, especially if you set a <code>HandleError</code> handler that suppresses exceptions and/or disable <code>RaiseError</code>.</p>

<dt><a name="auto_savepoint"
>auto_savepoint</a></dt>

<dd>
<p>If this option is true, <a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> will use savepoints when nesting transactions, making it possible to recover from failure in the inner transaction without having to abort all outer transactions.</p>

<dt><a name="cursor_class"
>cursor_class</a></dt>

<dd>
<p>Use this argument to supply a cursor class other than the default <a href="../../../DBIx/Class/Storage/DBI/Cursor.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Cursor</a>.</p>
</dd>
</dl>

<p>Some real-life examples of arguments to <a href="#connect_info" class="podlinkpod"
>&#34;connect_info&#34;</a> and <a href="../../../DBIx/Class/Schema.html#connect" class="podlinkpod"
>&#34;connect&#34; in DBIx::Class::Schema</a></p>

<pre>  # Simple SQLite connection
  -&#62;connect_info([ &#39;dbi:SQLite:./foo.db&#39; ]);

  # Connect via subref
  -&#62;connect_info([ sub { DBI-&#62;connect(...) } ]);

  # Connect via subref in hashref
  -&#62;connect_info([{
    dbh_maker =&#62; sub { DBI-&#62;connect(...) },
    on_connect_do =&#62; &#39;alter session ...&#39;,
  }]);

  # A bit more complicated
  -&#62;connect_info(
    [
      &#39;dbi:Pg:dbname=foo&#39;,
      &#39;postgres&#39;,
      &#39;my_pg_password&#39;,
      { AutoCommit =&#62; 1 },
      { quote_char =&#62; q{&#34;} },
    ]
  );

  # Equivalent to the previous example
  -&#62;connect_info(
    [
      &#39;dbi:Pg:dbname=foo&#39;,
      &#39;postgres&#39;,
      &#39;my_pg_password&#39;,
      { AutoCommit =&#62; 1, quote_char =&#62; q{&#34;}, name_sep =&#62; q{.} },
    ]
  );

  # Same, but with hashref as argument
  # See parse_connect_info for explanation
  -&#62;connect_info(
    [{
      dsn         =&#62; &#39;dbi:Pg:dbname=foo&#39;,
      user        =&#62; &#39;postgres&#39;,
      password    =&#62; &#39;my_pg_password&#39;,
      AutoCommit  =&#62; 1,
      quote_char  =&#62; q{&#34;},
      name_sep    =&#62; q{.},
    }]
  );

  # Subref + DBIx::Class-specific connection options
  -&#62;connect_info(
    [
      sub { DBI-&#62;connect(...) },
      {
          quote_char =&#62; q{`},
          name_sep =&#62; q{@},
          on_connect_do =&#62; [&#39;SET search_path TO myschema,otherschema,public&#39;],
          disable_sth_caching =&#62; 1,
      },
    ]
  );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="on_connect_do"
>on_connect_do</a></h2>

<p>This method is deprecated in favour of setting via <a href="#connect_info" class="podlinkpod"
>&#34;connect_info&#34;</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="on_disconnect_do"
>on_disconnect_do</a></h2>

<p>This method is deprecated in favour of setting via <a href="#connect_info" class="podlinkpod"
>&#34;connect_info&#34;</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dbh_do"
>dbh_do</a></h2>

<p>Arguments: ($subref | $method_name), @extra_coderef_args?</p>

<p>Execute the given $subref or $method_name using the new exception-based connection management.</p>

<p>The first two arguments will be the storage object that <code>dbh_do</code> was called on and a database handle to use. Any additional arguments will be passed verbatim to the called subref as arguments 2 and onwards.</p>

<p>Using this (instead of $self-&#62;_dbh or $self-&#62;dbh) ensures correct exception handling and reconnection (or failover in future subclasses).</p>

<p>Your subref should have no side-effects outside of the database, as there is the potential for your subref to be partially double-executed if the database connection was stale/dysfunctional.</p>

<p>Example:</p>

<pre>  my @stuff = $schema-&#62;storage-&#62;dbh_do(
    sub {
      my ($storage, $dbh, @cols) = @_;
      my $cols = join(q{, }, @cols);
      $dbh-&#62;selectrow_array(&#34;SELECT $cols FROM foo&#34;);
    },
    @column_list
  );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="disconnect"
>disconnect</a></h2>

<p>Our <code>disconnect</code> method also performs a rollback first if the database is not in <code>AutoCommit</code> mode.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="with_deferred_fk_checks"
>with_deferred_fk_checks</a></h2>

<dl>
<dt><a name="Arguments:_$coderef"
>Arguments: <code>$coderef</code></a></dt>

<dd>
<dt><a name="Return_Value:_The_return_value_of_$coderef"
>Return Value: The return value of $coderef</a></dt>
</dl>

<p>Storage specific method to run the code ref with FK checks deferred or in MySQL&#39;s case disabled entirely.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connected"
>connected</a></h2>

<dl>
<dt><a name="Arguments:_none"
>Arguments: none</a></dt>

<dd>
<dt><a name="Return_Value:_1|0"
>Return Value: 1|0</a></dt>
</dl>

<p>Verifies that the current database handle is active and ready to execute an SQL statement (e.g. the connection did not get stale, server is still answering, etc.) This method is used internally by <a href="#dbh" class="podlinkpod"
>&#34;dbh&#34;</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dbh"
>dbh</a></h2>

<p>Returns a <code>$dbh</code> - a data base handle of class <a href="../../../DBI.html" class="podlinkpod"
>DBI</a>. The returned handle is guaranteed to be healthy by implicitly calling <a href="#connected" class="podlinkpod"
>&#34;connected&#34;</a>, and if necessary performing a reconnection before returning. Keep in mind that this is very <b>expensive</b> on some database engines. Consider using <a href="#dbh_do" class="podlinkpod"
>&#34;dbh_do&#34;</a> instead.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="select"
>select</a></h2>

<dl>
<dt><a name="Arguments:_$ident,_$select,_$condition,_$attrs"
>Arguments: $ident, $select, $condition, $attrs</a></dt>
</dl>

<p>Handle a SQL select statement.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sql_limit_dialect"
>sql_limit_dialect</a></h2>

<p>This is an accessor for the default SQL limit dialect used by a particular storage driver. Can be overridden by supplying an explicit <a href="#limit_dialect" class="podlinkpod"
>&#34;limit_dialect&#34;</a> to <a href="../../../DBIx/Class/Schema.html#connect" class="podlinkpod"
>&#34;connect&#34; in DBIx::Class::Schema</a>. For a list of available limit dialects see <a href="../../../DBIx/Class/SQLMaker/LimitDialects.html" class="podlinkpod"
>DBIx::Class::SQLMaker::LimitDialects</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="last_insert_id"
>last_insert_id</a></h2>

<p>Return the row id of the last insert.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_native_data_type"
>_native_data_type</a></h2>

<dl>
<dt><a name="Arguments:_$type_name"
>Arguments: $type_name</a></dt>
</dl>

<p>This API is <b>EXPERIMENTAL</b>, will almost definitely change in the future, and currently only used by <a href="../../../DBIx/Class/Storage/DBI/AutoCast.html" class="podlinkpod"
>::AutoCast</a> and <a href="../../../DBIx/Class/Storage/DBI/Sybase/ASE.html" class="podlinkpod"
>::Sybase::ASE</a>.</p>

<p>The default implementation returns <code>undef</code>, implement in your Storage driver if you need this functionality.</p>

<p>Should map types from other databases to the native RDBMS type, for example <code>VARCHAR2</code> to <code>VARCHAR</code>.</p>

<p>Types with modifiers should map to the underlying data type. For example, <code>INTEGER AUTO_INCREMENT</code> should become <code>INTEGER</code>.</p>

<p>Composite types should map to the container type, for example <code>ENUM(foo,bar,baz)</code> becomes <code>ENUM</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="sqlt_type"
>sqlt_type</a></h2>

<p>Returns the database driver name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="bind_attribute_by_data_type"
>bind_attribute_by_data_type</a></h2>

<p>Given a datatype from column info, returns a database specific bind attribute for <code>$dbh-&#62;bind_param($val,$attribute)</code> or nothing if we will let the database planner just handle it.</p>

<p>This method is always called after the driver has been determined and a DBI connection has been established. Therefore you can refer to <code>DBI::$constant</code> and/or <code>DBD::$driver::$constant</code> directly, without worrying about loading the correct modules.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_datatype_numeric"
>is_datatype_numeric</a></h2>

<p>Given a datatype from column_info, returns a boolean value indicating if the current RDBMS considers it a numeric value. This controls how <a href="../../../DBIx/Class/Row.html#set_column" class="podlinkpod"
>&#34;set_column&#34; in DBIx::Class::Row</a> decides whether to mark the column as dirty - when the datatype is deemed numeric a <code>!=</code> comparison will be performed instead of the usual <code>eq</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_ddl_dir"
>create_ddl_dir</a></h2>

<dl>
<dt><a name="Arguments:_$schema,_\@databases,_$version,_$directory,_$preversion,_\%sqlt_args"
>Arguments: $schema, \@databases, $version, $directory, $preversion, \%sqlt_args</a></dt>
</dl>

<p>Creates a SQL file based on the Schema, for each of the specified database engines in <code>\@databases</code> in the given directory. (note: specify <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> names, not <a href="../../../DBI.html" class="podlinkpod"
>DBI</a> driver names).</p>

<p>Given a previous version number, this will also create a file containing the ALTER TABLE statements to transform the previous schema into the current one. Note that these statements may contain <code>DROP TABLE</code> or <code>DROP COLUMN</code> statements that can potentially destroy data.</p>

<p>The file names are created using the <code>ddl_filename</code> method below, please override this method in your schema if you would like a different file name format. For the ALTER file, the same format is used, replacing $version in the name with &#34;$preversion-$version&#34;.</p>

<p>See <a href="../../../SQL/Translator.html#METHODS" class="podlinkpod"
>&#34;METHODS&#34; in SQL::Translator</a> for a list of values for <code>\%sqlt_args</code>. The most common value for this would be <code>{ add_drop_table =&#62; 1 }</code> to have the SQL produced include a <code>DROP TABLE</code> statement for each table created. For quoting purposes supply <code>quote_identifiers</code>.</p>

<p>If no arguments are passed, then the following default values are assumed:</p>

<dl>
<dt><a name="databases_-_[&#39;MySQL&#39;,_&#39;SQLite&#39;,_&#39;PostgreSQL&#39;]"
>databases - [&#39;MySQL&#39;, &#39;SQLite&#39;, &#39;PostgreSQL&#39;]</a></dt>

<dd>
<dt><a name="version_-_$schema-&#62;schema_version"
>version - $schema-&#62;schema_version</a></dt>

<dd>
<dt><a name="directory_-_&#39;./&#39;"
>directory - &#39;./&#39;</a></dt>

<dd>
<dt><a name="preversion_-_&#60;none&#62;"
>preversion - &#60;none&#62;</a></dt>
</dl>

<p>By default, <code>\%sqlt_args</code> will have</p>

<pre> { add_drop_table =&#62; 1, ignore_constraint_names =&#62; 1, ignore_index_names =&#62; 1 }</pre>

<p>merged with the hash passed in. To disable any of those features, pass in a hashref like the following</p>

<pre> { ignore_constraint_names =&#62; 0, # ... other options }</pre>

<p>WARNING: You are strongly advised to check all SQL files created, before applying them.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="deployment_statements"
>deployment_statements</a></h2>

<dl>
<dt><a name="Arguments:_$schema,_$type,_$version,_$directory,_$sqlt_args"
>Arguments: $schema, $type, $version, $directory, $sqlt_args</a></dt>
</dl>

<p>Returns the statements used by <a href="#deploy" class="podlinkpod"
>&#34;deploy&#34;</a> and <a href="../../../DBIx/Class/Schema.html#deploy" class="podlinkpod"
>&#34;deploy&#34; in DBIx::Class::Schema</a>.</p>

<p>The <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> (not <a href="../../../DBI.html" class="podlinkpod"
>DBI</a>) database driver name can be explicitly provided in <code>$type</code>, otherwise the result of <a href="#sqlt_type" class="podlinkpod"
>&#34;sqlt_type&#34;</a> is used as default.</p>

<p><code>$directory</code> is used to return statements from files in a previously created <a href="#create_ddl_dir" class="podlinkpod"
>&#34;create_ddl_dir&#34;</a> directory and is optional. The filenames are constructed from <a href="../../../DBIx/Class/Schema.html#ddl_filename" class="podlinkpod"
>&#34;ddl_filename&#34; in DBIx::Class::Schema</a>, the schema name and the <code>$version</code>.</p>

<p>If no <code>$directory</code> is specified then the statements are constructed on the fly using <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> and <code>$version</code> is ignored.</p>

<p>See <a href="../../../SQL/Translator.html#METHODS" class="podlinkpod"
>&#34;METHODS&#34; in SQL::Translator</a> for a list of values for <code>$sqlt_args</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="datetime_parser"
>datetime_parser</a></h2>

<p>Returns the datetime parser class</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="datetime_parser_type"
>datetime_parser_type</a></h2>

<p>Defines the datetime parser class - currently defaults to <a href="../../../DateTime/Format/MySQL.html" class="podlinkpod"
>DateTime::Format::MySQL</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="build_datetime_parser"
>build_datetime_parser</a></h2>

<p>See <a href="#datetime_parser" class="podlinkpod"
>&#34;datetime_parser&#34;</a></p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="is_replicating"
>is_replicating</a></h2>

<p>A boolean that reports if a particular <a href="../../../DBIx/Class/Storage/DBI.html" class="podlinkpod"
>DBIx::Class::Storage::DBI</a> is set to replicate from a master database. Default is undef, which is the result returned by databases that don&#39;t support replication.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="lag_behind_master"
>lag_behind_master</a></h2>

<p>Returns a number that represents a certain amount of lag behind a master db when a given storage is replicating. The number is database dependent, but starts at zero and increases with the amount of lag. Default in undef</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="relname_to_table_alias"
>relname_to_table_alias</a></h2>

<dl>
<dt><a name="Arguments:_$relname,_$join_count"
>Arguments: $relname, $join_count</a></dt>

<dd>
<dt><a name="Return_Value:_$alias"
>Return Value: $alias</a></dt>
</dl>

<p><a href="../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> uses <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a> names as table aliases in queries.</p>

<p>This hook is to allow specific <a href="../../../DBIx/Class/Storage.html" class="podlinkpod"
>DBIx::Class::Storage</a> drivers to change the way these aliases are named.</p>

<p>The default behavior is <code>&#34;$relname_$join_count&#34; if $join_count &#62; 1</code>, otherwise <code>&#34;$relname&#34;</code>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USAGE_NOTES"
>USAGE NOTES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DBIx::Class_and_AutoCommit"
>DBIx::Class and AutoCommit</a></h2>

<p>DBIx::Class can do some wonderful magic with handling exceptions, disconnections, and transactions when you use <code>AutoCommit =&#62; 1</code> (the default) combined with <a href="../../../DBIx/Class/Storage.html#txn_do" class="podlinkpod"
>txn_do</a> for transaction support.</p>

<p>If you set <code>AutoCommit =&#62; 0</code> in your connect info, then you are always in an assumed transaction between commits, and you&#39;re telling us you&#39;d like to manage that manually. A lot of the magic protections offered by this module will go away. We can&#39;t protect you from exceptions due to database disconnects because we don&#39;t know anything about how to restart your transactions. You&#39;re on your own for handling all sorts of exceptional cases if you choose the <code>AutoCommit =&#62; 0</code> path, just as you would be with raw DBI.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR_AND_CONTRIBUTORS"
>AUTHOR AND CONTRIBUTORS</a></h1>

<p>See <a href="../../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>AUTHOR</a> and <a href="../../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>CONTRIBUTORS</a> in DBIx::Class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
