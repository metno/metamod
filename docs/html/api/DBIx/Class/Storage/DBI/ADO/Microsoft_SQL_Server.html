<html><head><title>DBIx::Class::Storage::DBI::ADO::Microsoft_SQL_Server</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#EXAMPLE_DSN'>EXAMPLE DSN</a>
  <li class='indexItem indexItem1'><a href='#CAVEATS'>CAVEATS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#identities'>identities</a>
    <li class='indexItem indexItem2'><a href='#truncation_bug'>truncation bug</a>
    <li class='indexItem indexItem2'><a href='#LongReadLen'>LongReadLen</a>
    <li class='indexItem indexItem2'><a href='#binary_data'>binary data</a>
    <li class='indexItem indexItem2'><a href='#uniqueidentifier_columns'>uniqueidentifier columns</a>
    <li class='indexItem indexItem2'><a href='#fractional_seconds'>fractional seconds</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Storage::DBI::ADO::Microsoft_SQL_Server - Support for Microsoft SQL Server via DBD::ADO</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>This subclass supports MSSQL server connections via <a href="../../../../../DBD/ADO.html" class="podlinkpod"
>DBD::ADO</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The MSSQL specific functionality is provided by <a href="../../../../../DBIx/Class/Storage/DBI/MSSQL.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::MSSQL</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="EXAMPLE_DSN"
>EXAMPLE DSN</a></h1>

<pre>  dbi:ADO:provider=sqlncli10;server=EEEBOX\SQLEXPRESS</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CAVEATS"
>CAVEATS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="identities"
>identities</a></h2>

<p><code>_identity_method</code> is set to <code>@@identity</code>, as <code>SCOPE_IDENTITY()</code> doesn&#39;t work with <a href="../../../../../DBD/ADO.html" class="podlinkpod"
>DBD::ADO</a>. See <a href="../../../../../DBIx/Class/Storage/DBI/MSSQL.html#IMPLEMENTATION_NOTES" class="podlinkpod"
>&#34;IMPLEMENTATION NOTES&#34; in DBIx::Class::Storage::DBI::MSSQL</a> for caveats regarding this.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="truncation_bug"
>truncation bug</a></h2>

<p>There is a bug with MSSQL ADO providers where data gets truncated based on the size of the bind sizes in the first prepare call:</p>

<p><a href="https://rt.cpan.org/Ticket/Display.html?id=52048" class="podlinkurl"
>https://rt.cpan.org/Ticket/Display.html?id=52048</a></p>

<p>The <code>ado_size</code> workaround is used (see <a href="../../../../../DBD/ADO.html#ADO_Providers" class="podlinkpod"
>&#34;ADO Providers&#34; in DBD::ADO</a>) with the approximate maximum size of the data_type of the bound column, or 8000 (maximum VARCHAR size) if the data_type is not available.</p>

<p>Please report problems with this driver and send patches.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="LongReadLen"
>LongReadLen</a></h2>

<p><code>LongReadLen</code> is set to <code>LongReadLen * 2 + 1</code> on connection as it is necessary for some LOB types. Be aware of this if you localize this value on the <code>$dbh</code> directly.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="binary_data"
>binary data</a></h2>

<p>Due perhaps to the ado_size workaround we use, and/or other reasons, binary data such as <code>varbinary</code> column data comes back padded with trailing <code>NULL</code> chars. The Cursor class for this driver (<a href="../../../../../DBIx/Class/Storage/DBI/ADO/Microsoft_SQL_Server/Cursor.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::ADO::Microsoft_SQL_Server::Cursor</a>) removes them, of course if your binary data is actually <code>NULL</code> padded that may be an issue to keep in mind when using this driver.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="uniqueidentifier_columns"
>uniqueidentifier columns</a></h2>

<p>uniqueidentifier columns come back from ADO wrapped in braces and must be submitted to the MSSQL ADO driver wrapped in braces. We take care of this transparently in this driver and the associated Cursor class (<a href="../../../../../DBIx/Class/Storage/DBI/ADO/Microsoft_SQL_Server/Cursor.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::ADO::Microsoft_SQL_Server::Cursor</a>) so that you don&#39;t have to use braces in most cases (except in literal SQL, in those cases you will have to add the braces yourself.)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="fractional_seconds"
>fractional seconds</a></h2>

<p>Fractional seconds with <a href="../../../../../DBIx/Class/InflateColumn/DateTime.html" class="podlinkpod"
>DBIx::Class::InflateColumn::DateTime</a> are not currently supported, datetimes are truncated at the second.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>See <a href="../../../../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34; in DBIx::Class</a> and <a href="../../../../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34; in DBIx::Class</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
