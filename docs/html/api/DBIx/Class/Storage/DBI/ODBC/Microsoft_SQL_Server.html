<html><head><title>DBIx::Class::Storage::DBI::ODBC::Microsoft_SQL_Server</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#USAGE_NOTES'>USAGE NOTES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Basic_Linux_Setup_(Debian)'>Basic Linux Setup (Debian)</a>
    <li class='indexItem indexItem2'><a href='#Basic_Windows_Setup'>Basic Windows Setup</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#MULTIPLE_ACTIVE_STATEMENTS'>MULTIPLE ACTIVE STATEMENTS</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#connect_call_use_mars'>connect_call_use_mars</a>
    <li class='indexItem indexItem2'><a href='#connect_call_use_dynamic_cursors'>connect_call_use_dynamic_cursors</a>
    <li class='indexItem indexItem2'><a href='#connect_call_use_server_cursors'>connect_call_use_server_cursors</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Storage::DBI::ODBC::Microsoft_SQL_Server - Support specific to Microsoft SQL Server over ODBC</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This class implements support specific to Microsoft SQL Server over ODBC.
It is loaded automatically by DBIx::Class::Storage::DBI::ODBC when it detects a MSSQL back-end.</p>

<p>Most of the functionality is provided from the superclass <a href="../../../../../DBIx/Class/Storage/DBI/MSSQL.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::MSSQL</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USAGE_NOTES"
>USAGE NOTES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Basic_Linux_Setup_(Debian)"
>Basic Linux Setup (Debian)</a></h2>

<pre>  sudo aptitude install tdsodbc libdbd-odbc-perl unixodbc</pre>

<p>In case it is not already there put the following (adjust for non-64bit arch) in <code>/etc/odbcinst.ini</code>:</p>

<pre>  [FreeTDS]
  Description = FreeTDS
  Driver      = /usr/lib/x86_64-linux-gnu/odbc/libtdsodbc.so
  Setup       = /usr/lib/x86_64-linux-gnu/odbc/libtdsS.so
  UsageCount  = 1</pre>

<p>Set your <code>$dsn</code> in <a href="../../../../../DBIx/Class/Storage/DBI.html#connect_info" class="podlinkpod"
>connect_info</a> as follows:</p>

<pre>  dbi:ODBC:server=&#60;my.host.name&#62;;port=1433;driver=FreeTDS;tds_version=8.0</pre>

<p>If you use the EasySoft driver (<a href="http://www.easysoft.com" class="podlinkurl"
>http://www.easysoft.com</a>):</p>

<pre>  dbi:ODBC:server=&#60;my.host.name&#62;;port=1433;driver=Easysoft ODBC-SQL Server</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Basic_Windows_Setup"
>Basic Windows Setup</a></h2>

<p>Use the following <code>$dsn</code> for the Microsoft ODBC driver:</p>

<pre>  dbi:ODBC:driver={SQL Server};server=SERVER\SQL_SERVER_INSTANCE_NAME</pre>

<p>And for the Native Client:</p>

<pre>  dbi:ODBC:driver={SQL Server Native Client 10.0};server=SERVER\SQL_SERVER_INSTANCE_NAME</pre>

<p>Go into Control Panel -&#62; System and Security -&#62; Administrative Tools -&#62; Data Sources (ODBC) to check driver names and to set up data sources.</p>

<p>Use System DSNs, not User DSNs if you want to use DSNs.</p>

<p>If you set up a DSN, use the following <code>$dsn</code> for <a href="../../../../../DBIx/Class/Storage/DBI.html#connect_info" class="podlinkpod"
>connect_info</a>:</p>

<pre>  dbi:ODBC:dsn=MY_DSN</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="MULTIPLE_ACTIVE_STATEMENTS"
>MULTIPLE ACTIVE STATEMENTS</a></h1>

<p>The following options are alternative ways to enable concurrent executing statement support. Each has its own advantages and drawbacks and works on different platforms. Read each section carefully.</p>

<p>For more details about using MAS in MSSQL over DBD::ODBC see this excellent document provided by EasySoft: <a href="http://www.easysoft.com/developer/languages/perl/multiple-active-statements.html" class="podlinkurl"
>http://www.easysoft.com/developer/languages/perl/multiple-active-statements.html</a>.</p>

<p>In order of preference, they are:</p>

<ul>
<li><a href="#connect_call_use_mars" class="podlinkpod"
>mars</a></li>

<li><a href="#connect_call_use_dynamic_cursors" class="podlinkpod"
>dynamic_cursors</a></li>

<li><a href="#connect_call_use_server_cursors" class="podlinkpod"
>server_cursors</a></li>
</ul>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_call_use_mars"
>connect_call_use_mars</a></h2>

<p>Use as:</p>

<pre>  on_connect_call =&#62; &#39;use_mars&#39;</pre>

<p>in your connection info, or alternatively specify it directly:</p>

<pre>  Your::Schema-&#62;connect (
    $original_dsn . &#39;; MARS_Connection=Yes&#39;,
    $user,
    $pass,
    \%attrs,
  )</pre>

<p>Use to enable a feature of SQL Server 2005 and later, &#34;Multiple Active Result Sets&#34;. See <a href="../../../../../DBD/ODBC/FAQ.html#Does_DBD%3A%3AODBC_support_Multiple_Active_Statements%3F" class="podlinkpod"
>&#34;Does DBD::ODBC support Multiple Active Statements?&#34; in DBD::ODBC::FAQ</a> for more information.</p>

<p>This does not work on FreeTDS drivers at the time of this writing, and only works with the Native Client, later versions of the Windows MS ODBC driver, and the Easysoft driver.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_call_use_dynamic_cursors"
>connect_call_use_dynamic_cursors</a></h2>

<p>Use as:</p>

<pre>  on_connect_call =&#62; &#39;use_dynamic_cursors&#39;</pre>

<p>Which will add <code>odbc_cursortype =&#62; 2</code> to your DBI connection attributes, or alternatively specify the necessary flag directly:</p>

<pre>  Your::Schema-&#62;connect (@dsn, { ... odbc_cursortype =&#62; 2 })</pre>

<p>See <a href="../../../../../DBD/ODBC.html#odbc_cursortype" class="podlinkpod"
>&#34;odbc_cursortype&#34; in DBD::ODBC</a> for more information.</p>

<p>If you&#39;re using FreeTDS, <code>tds_version</code> must be set to at least <code>8.0</code>.</p>

<p>This will not work with CODE ref connect_info&#39;s.</p>

<p><b>WARNING:</b> on FreeTDS (and maybe some other drivers) this will break <code>SCOPE_IDENTITY()</code>, and <code>SELECT @@IDENTITY</code> will be used instead, which on SQL Server 2005 and later will return erroneous results on tables which have an on insert trigger that inserts into another table with an <code>IDENTITY</code> column.</p>

<p><b>WARNING:</b> on FreeTDS, changes made in one statement (e.g. an insert) may not be visible from a following statement (e.g. a select.)</p>

<p><b>WARNING:</b> FreeTDS versions &#62; 0.82 seem to have completely broken the ODBC protocol. DBIC will not allow dynamic cursor support with such versions to protect your data. Please hassle the authors of FreeTDS to act on the bugs that make their driver not overly usable with DBD::ODBC.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_call_use_server_cursors"
>connect_call_use_server_cursors</a></h2>

<p>Use as:</p>

<pre>  on_connect_call =&#62; &#39;use_server_cursors&#39;</pre>

<p>May allow multiple active select statements. See <a href="../../../../../DBD/ODBC.html#odbc_SQL_ROWSET_SIZE" class="podlinkpod"
>&#34;odbc_SQL_ROWSET_SIZE&#34; in DBD::ODBC</a> for more information.</p>

<p>Takes an optional parameter for the value to set the attribute to, default is <code>2</code>.</p>

<p><b>WARNING</b>: this does not work on all versions of SQL Server, and may lock up your database!</p>

<p>At the time of writing, this option only works on Microsoft&#39;s Windows drivers, later versions of the ODBC driver and the Native Client driver.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>See <a href="../../../../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34; in DBIx::Class</a> and <a href="../../../../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34; in DBIx::Class</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
