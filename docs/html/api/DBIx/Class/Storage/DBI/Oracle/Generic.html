<html><head><title>DBIx::Class::Storage::DBI::Oracle::Generic</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#get_autoinc_seq'>get_autoinc_seq</a>
    <li class='indexItem indexItem2'><a href='#datetime_parser_type'>datetime_parser_type</a>
    <li class='indexItem indexItem2'><a href='#connect_call_datetime_setup'>connect_call_datetime_setup</a>
    <li class='indexItem indexItem2'><a href='#relname_to_table_alias'>relname_to_table_alias</a>
    <li class='indexItem indexItem2'><a href='#with_deferred_fk_checks'>with_deferred_fk_checks</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#ATTRIBUTES'>ATTRIBUTES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#connect_by_or_connect_by_nocycle'>connect_by or connect_by_nocycle</a>
    <li class='indexItem indexItem2'><a href='#start_with'>start_with</a>
    <li class='indexItem indexItem2'><a href='#order_siblings_by'>order_siblings_by</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Storage::DBI::Oracle::Generic - Oracle Support for DBIx::Class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  # In your result (table) classes
  use base &#39;DBIx::Class::Core&#39;;
  __PACKAGE__-&#62;add_columns({ id =&#62; { sequence =&#62; &#39;mysequence&#39;, auto_nextval =&#62; 1 } });
  __PACKAGE__-&#62;set_primary_key(&#39;id&#39;);

  # Somewhere in your Code
  # add some data to a table with a hierarchical relationship
  $schema-&#62;resultset(&#39;Person&#39;)-&#62;create ({
        firstname =&#62; &#39;foo&#39;,
        lastname =&#62; &#39;bar&#39;,
        children =&#62; [
            {
                firstname =&#62; &#39;child1&#39;,
                lastname =&#62; &#39;bar&#39;,
                children =&#62; [
                    {
                        firstname =&#62; &#39;grandchild&#39;,
                        lastname =&#62; &#39;bar&#39;,
                    }
                ],
            },
            {
                firstname =&#62; &#39;child2&#39;,
                lastname =&#62; &#39;bar&#39;,
            },
        ],
    });

  # select from the hierarchical relationship
  my $rs = $schema-&#62;resultset(&#39;Person&#39;)-&#62;search({},
    {
      &#39;start_with&#39; =&#62; { &#39;firstname&#39; =&#62; &#39;foo&#39;, &#39;lastname&#39; =&#62; &#39;bar&#39; },
      &#39;connect_by&#39; =&#62; { &#39;parentid&#39; =&#62; { &#39;-prior&#39; =&#62; { -ident =&#62; &#39;personid&#39; } },
      &#39;order_siblings_by&#39; =&#62; { -asc =&#62; &#39;name&#39; },
    };
  );

  # this will select the whole tree starting from person &#34;foo bar&#34;, creating
  # following query:
  # SELECT
  #     me.persionid me.firstname, me.lastname, me.parentid
  # FROM
  #     person me
  # START WITH
  #     firstname = &#39;foo&#39; and lastname = &#39;bar&#39;
  # CONNECT BY
  #     parentid = prior personid
  # ORDER SIBLINGS BY
  #     firstname ASC</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This class implements base Oracle support. The subclass <a href="../../../../../DBIx/Class/Storage/DBI/Oracle/WhereJoins.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Oracle::WhereJoins</a> is for <code>(+)</code> joins in Oracle versions before 9.0.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_autoinc_seq"
>get_autoinc_seq</a></h2>

<p>Returns the sequence name for an autoincrement column</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="datetime_parser_type"
>datetime_parser_type</a></h2>

<p>This sets the proper DateTime::Format module for use with <a href="../../../../../DBIx/Class/InflateColumn/DateTime.html" class="podlinkpod"
>DBIx::Class::InflateColumn::DateTime</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_call_datetime_setup"
>connect_call_datetime_setup</a></h2>

<p>Used as:</p>

<pre>    on_connect_call =&#62; &#39;datetime_setup&#39;</pre>

<p>In <a href="../../../../../DBIx/Class/Storage/DBI.html#connect_info" class="podlinkpod"
>connect_info</a> to set the session nls date, and timestamp values for use with <a href="../../../../../DBIx/Class/InflateColumn/DateTime.html" class="podlinkpod"
>DBIx::Class::InflateColumn::DateTime</a> and the necessary environment variables for <a href="../../../../../DateTime/Format/Oracle.html" class="podlinkpod"
>DateTime::Format::Oracle</a>, which is used by it.</p>

<p>Maximum allowable precision is used, unless the environment variables have already been set.</p>

<p>These are the defaults used:</p>

<pre>  $ENV{NLS_DATE_FORMAT}         ||= &#39;YYYY-MM-DD HH24:MI:SS&#39;;
  $ENV{NLS_TIMESTAMP_FORMAT}    ||= &#39;YYYY-MM-DD HH24:MI:SS.FF&#39;;
  $ENV{NLS_TIMESTAMP_TZ_FORMAT} ||= &#39;YYYY-MM-DD HH24:MI:SS.FF TZHTZM&#39;;</pre>

<p>To get more than second precision with <a href="../../../../../DBIx/Class/InflateColumn/DateTime.html" class="podlinkpod"
>DBIx::Class::InflateColumn::DateTime</a> for your timestamps, use something like this:</p>

<pre>  use Time::HiRes &#39;time&#39;;
  my $ts = DateTime-&#62;from_epoch(epoch =&#62; time);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="relname_to_table_alias"
>relname_to_table_alias</a></h2>

<p><a href="../../../../../DBIx/Class.html" class="podlinkpod"
>DBIx::Class</a> uses <a href="../../../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a> names as table aliases in queries.</p>

<p>Unfortunately, Oracle doesn&#39;t support identifiers over 30 chars in length, so the <a href="../../../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a> name is shortened and appended with half of an MD5 hash.</p>

<p>See <a href="../../../../../DBIx/Class/Storage.html#relname_to_table_alias" class="podlinkpod"
>&#34;relname_to_table_alias&#34; in DBIx::Class::Storage</a>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="with_deferred_fk_checks"
>with_deferred_fk_checks</a></h2>

<p>Runs a coderef between:</p>

<pre>  alter session set constraints = deferred
  ...
  alter session set constraints = immediate</pre>

<p>to defer foreign key checks.</p>

<p>Constraints must be declared <code>DEFERRABLE</code> for this to work.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ATTRIBUTES"
>ATTRIBUTES</a></h1>

<p>Following additional attributes can be used in resultsets.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="connect_by_or_connect_by_nocycle"
>connect_by or connect_by_nocycle</a></h2>

<dl>
<dt><a name="Value:_\%connect_by"
>Value: \%connect_by</a></dt>
</dl>

<p>A hashref of conditions used to specify the relationship between parent rows and child rows of the hierarchy.</p>

<pre>  connect_by =&#62; { parentid =&#62; &#39;prior personid&#39; }

  # adds a connect by statement to the query:
  # SELECT
  #     me.persionid me.firstname, me.lastname, me.parentid
  # FROM
  #     person me
  # CONNECT BY
  #     parentid = prior persionid


  connect_by_nocycle =&#62; { parentid =&#62; &#39;prior personid&#39; }

  # adds a connect by statement to the query:
  # SELECT
  #     me.persionid me.firstname, me.lastname, me.parentid
  # FROM
  #     person me
  # CONNECT BY NOCYCLE
  #     parentid = prior persionid</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="start_with"
>start_with</a></h2>

<dl>
<dt><a name="Value:_\%condition"
>Value: \%condition</a></dt>
</dl>

<p>A hashref of conditions which specify the root row(s) of the hierarchy.</p>

<p>It uses the same syntax as <a href="../../../../../DBIx/Class/ResultSet.html#search" class="podlinkpod"
>&#34;search&#34; in DBIx::Class::ResultSet</a></p>

<pre>  start_with =&#62; { firstname =&#62; &#39;Foo&#39;, lastname =&#62; &#39;Bar&#39; }

  # SELECT
  #     me.persionid me.firstname, me.lastname, me.parentid
  # FROM
  #     person me
  # START WITH
  #     firstname = &#39;foo&#39; and lastname = &#39;bar&#39;
  # CONNECT BY
  #     parentid = prior persionid</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="order_siblings_by"
>order_siblings_by</a></h2>

<dl>
<dt><a name="Value:_($order_siblings_by_|_\@order_siblings_by)"
>Value: ($order_siblings_by | \@order_siblings_by)</a></dt>
</dl>

<p>Which column(s) to order the siblings by.</p>

<p>It uses the same syntax as <a href="../../../../../DBIx/Class/ResultSet.html#order_by" class="podlinkpod"
>&#34;order_by&#34; in DBIx::Class::ResultSet</a></p>

<pre>  &#39;order_siblings_by&#39; =&#62; &#39;firstname ASC&#39;

  # SELECT
  #     me.persionid me.firstname, me.lastname, me.parentid
  # FROM
  #     person me
  # CONNECT BY
  #     parentid = prior persionid
  # ORDER SIBLINGS BY
  #     firstname ASC</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>See <a href="../../../../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>&#34;AUTHOR&#34; in DBIx::Class</a> and <a href="../../../../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>&#34;CONTRIBUTORS&#34; in DBIx::Class</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
