<html><head><title>DBIx::Class::Storage::DBI::Replicated::Balancer</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#ATTRIBUTES'>ATTRIBUTES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#auto_validate_every_(%24seconds)'>auto_validate_every ($seconds)</a>
    <li class='indexItem indexItem2'><a href='#master'>master</a>
    <li class='indexItem indexItem2'><a href='#pool'>pool</a>
    <li class='indexItem indexItem2'><a href='#current_replicant'>current_replicant</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_build_current_replicant'>_build_current_replicant</a>
    <li class='indexItem indexItem2'><a href='#next_storage'>next_storage</a>
    <li class='indexItem indexItem2'><a href='#around%3A_next_storage'>around: next_storage</a>
    <li class='indexItem indexItem2'><a href='#increment_storage'>increment_storage</a>
    <li class='indexItem indexItem2'><a href='#around%3A_select'>around: select</a>
    <li class='indexItem indexItem2'><a href='#around%3A_select_single'>around: select_single</a>
    <li class='indexItem indexItem2'><a href='#before%3A_columns_info_for'>before: columns_info_for</a>
    <li class='indexItem indexItem2'><a href='#_get_forced_pool_(%24name)'>_get_forced_pool ($name)</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Storage::DBI::Replicated::Balancer - A Software Load Balancer</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>This role is used internally by <a href="../../../../../DBIx/Class/Storage/DBI/Replicated.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Given a pool (<a href="../../../../../DBIx/Class/Storage/DBI/Replicated/Pool.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated::Pool</a>) of replicated database&#39;s (<a href="../../../../../DBIx/Class/Storage/DBI/Replicated/Replicant.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated::Replicant</a>),
defines a method by which query load can be spread out across each replicant in the pool.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ATTRIBUTES"
>ATTRIBUTES</a></h1>

<p>This class defines the following attributes.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="auto_validate_every_($seconds)"
>auto_validate_every ($seconds)</a></h2>

<p>If auto_validate has some sort of value,
run <a href="../../../../../DBIx/Class/Storage/DBI/Replicated/Pool.html#validate_replicants" class="podlinkpod"
>&#34;validate_replicants&#34; in DBIx::Class::Storage::DBI::Replicated::Pool</a> every $seconds.
Be careful with this,
because if you set it to 0 you will end up validating every query.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="master"
>master</a></h2>

<p>The <a href="../../../../../DBIx/Class/Storage/DBI.html" class="podlinkpod"
>DBIx::Class::Storage::DBI</a> object that is the master database all the replicants are trying to follow.
The balancer needs to know it since it&#39;s the ultimate fallback.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="pool"
>pool</a></h2>

<p>The <a href="../../../../../DBIx/Class/Storage/DBI/Replicated/Pool.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated::Pool</a> object that we are trying to balance.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="current_replicant"
>current_replicant</a></h2>

<p>Replicant storages (slaves) handle all read only traffic.
The assumption is that your database will become readbound well before it becomes write bound and that being able to spread your read only traffic around to multiple databases is going to help you to scale traffic.</p>

<p>This attribute returns the next slave to handle a read request.
Your <a href="#pool" class="podlinkpod"
>&#34;pool&#34;</a> attribute has methods to help you shuffle through all the available replicants via its balancer object.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<p>This class defines the following methods.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_build_current_replicant"
>_build_current_replicant</a></h2>

<p>Lazy builder for the <a href="#current_replicant_storage" class="podlinkpod"
>&#34;current_replicant_storage&#34;</a> attribute.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="next_storage"
>next_storage</a></h2>

<p>This method should be defined in the class which consumes this role.</p>

<p>Given a pool object,
return the next replicant that will serve queries.
The default behavior is to grab the first replicant it finds but you can write your own subclasses of <a href="../../../../../DBIx/Class/Storage/DBI/Replicated/Balancer.html" class="podlinkpod"
>DBIx::Class::Storage::DBI::Replicated::Balancer</a> to support other balance systems.</p>

<p>This returns from the pool of active replicants.
If there are no active replicants,
then you should have it return the master as an ultimate fallback.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="around:_next_storage"
>around: next_storage</a></h2>

<p>Advice on next storage to add the autovalidation.
We have this broken out so that it&#39;s easier to break out the auto validation into a role.</p>

<p>This also returns the master in the case that none of the replicants are active or just just forgot to create them :)</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="increment_storage"
>increment_storage</a></h2>

<p>Rolls the Storage to whatever is next in the queue,
as defined by the Balancer.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="around:_select"
>around: select</a></h2>

<p>Advice on the select attribute.
Each time we use a replicant we need to change it via the storage pool algorithm.
That way we are spreading the load evenly (hopefully) across existing capacity.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="around:_select_single"
>around: select_single</a></h2>

<p>Advice on the select_single attribute.
Each time we use a replicant we need to change it via the storage pool algorithm.
That way we are spreading the load evenly (hopefully) across existing capacity.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="before:_columns_info_for"
>before: columns_info_for</a></h2>

<p>Advice on the current_replicant_storage attribute.
Each time we use a replicant we need to change it via the storage pool algorithm.
That way we are spreading the load evenly (hopefully) across existing capacity.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_get_forced_pool_($name)"
>_get_forced_pool ($name)</a></h2>

<p>Given an identifier,
find the most correct storage object to handle the query.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>John Napiorkowski &#60;jjnapiork@cpan.org&#62;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
