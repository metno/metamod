<html><head><title>DBIx::Class::Relationship::Base</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:16 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#add_relationship'>add_relationship</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#condition'>condition</a>
      <li class='indexItem indexItem3'><a href='#attributes'>attributes</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#register_relationship'>register_relationship</a>
    <li class='indexItem indexItem2'><a href='#related_resultset'>related_resultset</a>
    <li class='indexItem indexItem2'><a href='#%24relationship_accessor'>$relationship_accessor</a>
    <li class='indexItem indexItem2'><a href='#search_related'>search_related</a>
    <li class='indexItem indexItem2'><a href='#search_related_rs'>search_related_rs</a>
    <li class='indexItem indexItem2'><a href='#count_related'>count_related</a>
    <li class='indexItem indexItem2'><a href='#new_related'>new_related</a>
    <li class='indexItem indexItem2'><a href='#create_related'>create_related</a>
    <li class='indexItem indexItem2'><a href='#find_related'>find_related</a>
    <li class='indexItem indexItem2'><a href='#find_or_new_related'>find_or_new_related</a>
    <li class='indexItem indexItem2'><a href='#find_or_create_related'>find_or_create_related</a>
    <li class='indexItem indexItem2'><a href='#update_or_create_related'>update_or_create_related</a>
    <li class='indexItem indexItem2'><a href='#set_from_related'>set_from_related</a>
    <li class='indexItem indexItem2'><a href='#update_from_related'>update_from_related</a>
    <li class='indexItem indexItem2'><a href='#delete_related'>delete_related</a>
    <li class='indexItem indexItem2'><a href='#add_to_%24rel'>add_to_$rel</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#has_many_%2F_multi'>has_many / multi</a>
      <li class='indexItem indexItem3'><a href='#many_to_many'>many_to_many</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#set_%24rel'>set_$rel</a>
    <li class='indexItem indexItem2'><a href='#remove_from_%24rel'>remove_from_$rel</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR_AND_CONTRIBUTORS'>AUTHOR AND CONTRIBUTORS</a>
  <li class='indexItem indexItem1'><a href='#LICENSE'>LICENSE</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>DBIx::Class::Relationship::Base - Inter-table relationships</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  __PACKAGE__-&#62;add_relationship(
    spiders =&#62; &#39;My::DB::Result::Creatures&#39;,
    sub {
      my $args = shift;
      return {
        &#34;$args-&#62;{foreign_alias}.id&#34;   =&#62; { -ident =&#62; &#34;$args-&#62;{self_alias}.id&#34; },
        &#34;$args-&#62;{foreign_alias}.type&#34; =&#62; &#39;arachnid&#39;
      };
    },
  );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This class provides methods to describe the relationships between the tables in your database model. These are the &#34;bare bones&#34; relationships methods, for predefined ones, look in <a href="../../../DBIx/Class/Relationship.html" class="podlinkpod"
>DBIx::Class::Relationship</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="add_relationship"
>add_relationship</a></h2>

<dl>
<dt><a name="Arguments:_&#39;relname&#39;,_&#39;Foreign::Class&#39;,_$condition,_$attrs"
>Arguments: &#39;relname&#39;, &#39;Foreign::Class&#39;, $condition, $attrs</a></dt>
</dl>

<pre>  __PACKAGE__-&#62;add_relationship(&#39;relname&#39;,
                                &#39;Foreign::Class&#39;,
                                $condition, $attrs);</pre>

<p>Create a custom relationship between one result source and another source, indicated by its class name.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="condition"
>condition</a></h3>

<p>The condition argument describes the <code>ON</code> clause of the <code>JOIN</code> expression used to connect the two sources when creating SQL queries.</p>

<p>To create simple equality joins, supply a hashref containing the remote table column name as the key(s), and the local table column name as the value(s), for example given:</p>

<pre>  My::Schema::Author-&#62;has_many(
    books =&#62; &#39;My::Schema::Book&#39;,
    { &#39;foreign.author_id&#39; =&#62; &#39;self.id&#39; }
  );</pre>

<p>A query like:</p>

<pre>  $author_rs-&#62;search_related(&#39;books&#39;)-&#62;next</pre>

<p>will result in the following <code>JOIN</code> clause:</p>

<pre>  ... FROM author me LEFT JOIN book books ON books.author_id = me.id ...</pre>

<p>This describes a relationship between the <code>Author</code> table and the <code>Book</code> table where the <code>Book</code> table has a column <code>author_id</code> containing the ID value of the <code>Author</code>.</p>

<p><code>foreign</code> and <code>self</code> are pseudo aliases and must be entered literally. They will be replaced with the actual correct table alias when the SQL is produced.</p>

<p>Similarly:</p>

<pre>  My::Schema::Book-&#62;has_many(
    editions =&#62; &#39;My::Schema::Edition&#39;,
    {
      &#39;foreign.publisher_id&#39; =&#62; &#39;self.publisher_id&#39;,
      &#39;foreign.type_id&#39;      =&#62; &#39;self.type_id&#39;,
    }
  );

  ...

  $book_rs-&#62;search_related(&#39;editions&#39;)-&#62;next</pre>

<p>will result in the <code>JOIN</code> clause:</p>

<pre>  ... FROM book me
      LEFT JOIN edition editions ON
           editions.publisher_id = me.publisher_id
       AND editions.type_id = me.type_id ...</pre>

<p>This describes the relationship from <code>Book</code> to <code>Edition</code>, where the <code>Edition</code> table refers to a publisher and a type (e.g. &#34;paperback&#34;):</p>

<p>As is the default in <a href="../../../SQL/Abstract.html" class="podlinkpod"
>SQL::Abstract</a>, the key-value pairs will be <code>AND</code>ed in the result. <code>OR</code> can be achieved with an arrayref, for example a condition like:</p>

<pre>  My::Schema::Item-&#62;has_many(
    related_item_links =&#62; My::Schema::Item::Links,
    [
      { &#39;foreign.left_itemid&#39;  =&#62; &#39;self.id&#39; },
      { &#39;foreign.right_itemid&#39; =&#62; &#39;self.id&#39; },
    ],
  );</pre>

<p>will translate to the following <code>JOIN</code> clause:</p>

<pre> ... FROM item me JOIN item_relations related_item_links ON
         related_item_links.left_itemid = me.id
      OR related_item_links.right_itemid = me.id ...</pre>

<p>This describes the relationship from <code>Item</code> to <code>Item::Links</code>, where <code>Item::Links</code> is a many-to-many linking table, linking items back to themselves in a peer fashion (without a &#34;parent-child&#34; designation)</p>

<p>To specify joins which describe more than a simple equality of column values, the custom join condition coderef syntax can be used. For example:</p>

<pre>  My::Schema::Artist-&#62;has_many(
    cds_80s =&#62; &#39;My::Schema::CD&#39;,
    sub {
      my $args = shift;

      return {
        &#34;$args-&#62;{foreign_alias}.artist&#34; =&#62; { -ident =&#62; &#34;$args-&#62;{self_alias}.artistid&#34; },
        &#34;$args-&#62;{foreign_alias}.year&#34;   =&#62; { &#39;&#62;&#39;, &#34;1979&#34;, &#39;&#60;&#39;, &#34;1990&#34; },
      };
    }
  );

  ...

  $artist_rs-&#62;search_related(&#39;cds_80s&#39;)-&#62;next;</pre>

<p>will result in the <code>JOIN</code> clause:</p>

<pre>  ... FROM artist me LEFT JOIN cd cds_80s ON
        cds_80s.artist = me.artistid
    AND cds_80s.year &#60; ?
    AND cds_80s.year &#62; ?</pre>

<p>with the bind values:</p>

<pre>   &#39;1990&#39;, &#39;1979&#39;</pre>

<p><code>$args-&#62;{foreign_alias}</code> and <code>$args-&#62;{self_alias}</code> are supplied the same values that would be otherwise substituted for <code>foreign</code> and <code>self</code> in the simple hashref syntax case.</p>

<p>The coderef is expected to return a valid <a href="../../../SQL/Abstract.html" class="podlinkpod"
>SQL::Abstract</a> query-structure, just like what one would supply as the first argument to <a href="../../../DBIx/Class/ResultSet.html#search" class="podlinkpod"
>&#34;search&#34; in DBIx::Class::ResultSet</a>. The return value will be passed directly to <a href="../../../SQL/Abstract.html" class="podlinkpod"
>SQL::Abstract</a> and the resulting SQL will be used verbatim as the <code>ON</code> clause of the <code>JOIN</code> statement associated with this relationship.</p>

<p>While every coderef-based condition must return a valid <code>ON</code> clause, it may elect to additionally return a simplified join-free condition hashref when invoked as <code>$result-&#62;relationship</code>, as opposed to <code>$rs-&#62;related_resultset(&#39;relationship&#39;)</code>. In this case <code>$result</code> is passed to the coderef as <code>$args-&#62;{self_rowobj}</code>, so a user can do the following:</p>

<pre>  sub {
    my $args = shift;

    return (
      {
        &#34;$args-&#62;{foreign_alias}.artist&#34; =&#62; { -ident =&#62; &#34;$args-&#62;{self_alias}.artistid&#34; },
        &#34;$args-&#62;{foreign_alias}.year&#34;   =&#62; { &#39;&#62;&#39;, &#34;1979&#34;, &#39;&#60;&#39;, &#34;1990&#34; },
      },
      $args-&#62;{self_rowobj} &#38;&#38; {
        &#34;$args-&#62;{foreign_alias}.artist&#34; =&#62; $args-&#62;{self_rowobj}-&#62;artistid,
        &#34;$args-&#62;{foreign_alias}.year&#34;   =&#62; { &#39;&#62;&#39;, &#34;1979&#34;, &#39;&#60;&#39;, &#34;1990&#34; },
      },
    );
  }</pre>

<p>Now this code:</p>

<pre>    my $artist = $schema-&#62;resultset(&#34;Artist&#34;)-&#62;find({ id =&#62; 4 });
    $artist-&#62;cds_80s-&#62;all;</pre>

<p>Can skip a <code>JOIN</code> altogether and instead produce:</p>

<pre>    SELECT cds_80s.cdid, cds_80s.artist, cds_80s.title, cds_80s.year, cds_80s.genreid, cds_80s.single_track
      FROM cd cds_80s
      WHERE cds_80s.artist = ?
        AND cds_80s.year &#60; ?
        AND cds_80s.year &#62; ?</pre>

<p>With the bind values:</p>

<pre>    &#39;4&#39;, &#39;1990&#39;, &#39;1979&#39;</pre>

<p>Note that in order to be able to use <a href="../../../DBIx/Class/Relationship/Base.html#create_related" class="podlinkpod"
>$row-&#62;create_related</a>, the coderef must not only return as its second such a &#34;simple&#34; condition hashref which does not depend on joins being available, but the hashref must contain only plain values/deflatable objects, such that the result can be passed directly to <a href="../../../DBIx/Class/Relationship/Base.html#set_from_related" class="podlinkpod"
>&#34;set_from_related&#34; in DBIx::Class::Relationship::Base</a>. For instance the <code>year</code> constraint in the above example prevents the relationship from being used to to create related objects (an exception will be thrown).</p>

<p>In order to allow the user to go truly crazy when generating a custom <code>ON</code> clause, the <code>$args</code> hashref passed to the subroutine contains some extra metadata. Currently the supplied coderef is executed as:</p>

<pre>  $relationship_info-&#62;{cond}-&#62;({
    self_alias        =&#62; The alias of the invoking resultset (&#39;me&#39; in case of a result object),
    foreign_alias     =&#62; The alias of the to-be-joined resultset (often matches relname),
    self_resultsource =&#62; The invocant&#39;s resultsource,
    foreign_relname   =&#62; The relationship name (does *not* always match foreign_alias),
    self_rowobj       =&#62; The invocant itself in case of a $result_object-&#62;$relationship call
  });</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="attributes"
>attributes</a></h3>

<p>The <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>standard ResultSet attributes</a> may be used as relationship attributes. In particular, the &#39;where&#39; attribute is useful for filtering relationships:</p>

<pre>     __PACKAGE__-&#62;has_many( &#39;valid_users&#39;, &#39;MyApp::Schema::User&#39;,
        { &#39;foreign.user_id&#39; =&#62; &#39;self.user_id&#39; },
        { where =&#62; { valid =&#62; 1 } }
    );</pre>

<p>The following attributes are also valid:</p>

<dl>
<dt><a name="join_type"
>join_type</a></dt>

<dd>
<p>Explicitly specifies the type of join to use in the relationship. Any SQL join type is valid, e.g. <code>LEFT</code> or <code>RIGHT</code>. It will be placed in the SQL command immediately before <code>JOIN</code>.</p>

<dt><a name="proxy_=&#62;_$column_|_\@columns_|_\%column"
>proxy =&#62; $column | \@columns | \%column</a></dt>

<dd>
<p>The &#39;proxy&#39; attribute can be used to retrieve values, and to perform updates if the relationship has &#39;cascade_update&#39; set. The &#39;might_have&#39; and &#39;has_one&#39; relationships have this set by default; if you want a proxy to update across a &#39;belongs_to&#39; relationship, you must set the attribute yourself.</p>

<dl>
<dt><a name="\@columns"
>\@columns</a></dt>

<dd>
<p>An arrayref containing a list of accessors in the foreign class to create in the main class. If, for example, you do the following:</p>

<pre>  MyApp::Schema::CD-&#62;might_have(liner_notes =&#62; &#39;MyApp::Schema::LinerNotes&#39;,
    undef, {
      proxy =&#62; [ qw/notes/ ],
    });</pre>

<p>Then, assuming MyApp::Schema::LinerNotes has an accessor named notes, you can do:</p>

<pre>  my $cd = MyApp::Schema::CD-&#62;find(1);
  $cd-&#62;notes(&#39;Notes go here&#39;); # set notes -- LinerNotes object is
                               # created if it doesn&#39;t exist</pre>

<p>For a &#39;belongs_to relationship, note the &#39;cascade_update&#39;:</p>

<pre>  MyApp::Schema::Track-&#62;belongs_to( cd =&#62; &#39;DBICTest::Schema::CD&#39;, &#39;cd,
      { proxy =&#62; [&#39;title&#39;], cascade_update =&#62; 1 }
  );
  $track-&#62;title(&#39;New Title&#39;);
  $track-&#62;update; # updates title in CD</pre>

<dt><a name="\%column"
>\%column</a></dt>

<dd>
<p>A hashref where each key is the accessor you want installed in the main class, and its value is the name of the original in the fireign class.</p>

<pre>  MyApp::Schema::Track-&#62;belongs_to( cd =&#62; &#39;DBICTest::Schema::CD&#39;, &#39;cd&#39;, {
      proxy =&#62; { cd_title =&#62; &#39;title&#39; },
  });</pre>

<p>This will create an accessor named <code>cd_title</code> on the <code>$track</code> result object.</p>
</dd>
</dl>

<p>NOTE: you can pass a nested struct too, for example:</p>

<pre>  MyApp::Schema::Track-&#62;belongs_to( cd =&#62; &#39;DBICTest::Schema::CD&#39;, &#39;cd&#39;, {
    proxy =&#62; [ &#39;year&#39;, { cd_title =&#62; &#39;title&#39; } ],
  });</pre>

<dt><a name="accessor"
>accessor</a></dt>

<dd>
<p>Specifies the type of accessor that should be created for the relationship. Valid values are <code>single</code> (for when there is only a single related object), <code>multi</code> (when there can be many), and <code>filter</code> (for when there is a single related object, but you also want the relationship accessor to double as a column accessor). For <code>multi</code> accessors, an add_to_* method is also created, which calls <code>create_related</code> for the relationship.</p>

<dt><a name="is_foreign_key_constraint"
>is_foreign_key_constraint</a></dt>

<dd>
<p>If you are using <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> to create SQL for you and you find that it is creating constraints where it shouldn&#39;t, or not creating them where it should, set this attribute to a true or false value to override the detection of when to create constraints.</p>

<dt><a name="cascade_copy"
>cascade_copy</a></dt>

<dd>
<p>If <code>cascade_copy</code> is true on a <code>has_many</code> relationship for an object, then when you copy the object all the related objects will be copied too. To turn this behaviour off, pass <code>cascade_copy =&#62; 0</code> in the <code>$attr</code> hashref.</p>

<p>The behaviour defaults to <code>cascade_copy =&#62; 1</code> for <code>has_many</code> relationships.</p>

<dt><a name="cascade_delete"
>cascade_delete</a></dt>

<dd>
<p>By default, DBIx::Class cascades deletes across <code>has_many</code>, <code>has_one</code> and <code>might_have</code> relationships. You can disable this behaviour on a per-relationship basis by supplying <code>cascade_delete =&#62; 0</code> in the relationship attributes.</p>

<p>The cascaded operations are performed after the requested delete, so if your database has a constraint on the relationship, it will have deleted/updated the related records or raised an exception before DBIx::Class gets to perform the cascaded operation.</p>

<dt><a name="cascade_update"
>cascade_update</a></dt>

<dd>
<p>By default, DBIx::Class cascades updates across <code>has_one</code> and <code>might_have</code> relationships. You can disable this behaviour on a per-relationship basis by supplying <code>cascade_update =&#62; 0</code> in the relationship attributes.</p>

<p>The <code>belongs_to</code> relationship does not update across relationships by default, so if you have a &#39;proxy&#39; attribute on a belongs_to and want to use &#39;update&#39; on it, you muse set <code>cascade_update =&#62; 1</code>.</p>

<p>This is not a RDMS style cascade update - it purely means that when an object has update called on it, all the related objects also have update called. It will not change foreign keys automatically - you must arrange to do this yourself.</p>

<dt><a name="on_delete_/_on_update"
>on_delete / on_update</a></dt>

<dd>
<p>If you are using <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> to create SQL for you, you can use these attributes to explicitly set the desired <code>ON DELETE</code> or <code>ON UPDATE</code> constraint type. If not supplied the SQLT parser will attempt to infer the constraint type by interrogating the attributes of the <b>opposite</b> relationship. For any &#39;multi&#39; relationship with <code>cascade_delete =&#62; 1</code>, the corresponding belongs_to relationship will be created with an <code>ON DELETE CASCADE</code> constraint. For any relationship bearing <code>cascade_copy =&#62; 1</code> the resulting belongs_to constraint will be <code>ON UPDATE CASCADE</code>. If you wish to disable this autodetection, and just use the RDBMS&#39; default constraint type, pass <code>on_delete =&#62; undef</code> or <code>on_delete =&#62; &#39;&#39;</code>, and the same for <code>on_update</code> respectively.</p>

<dt><a name="is_deferrable"
>is_deferrable</a></dt>

<dd>
<p>Tells <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> that the foreign key constraint it creates should be deferrable. In other words, the user may request that the constraint be ignored until the end of the transaction. Currently, only the PostgreSQL producer actually supports this.</p>

<dt><a name="add_fk_index"
>add_fk_index</a></dt>

<dd>
<p>Tells <a href="../../../SQL/Translator.html" class="podlinkpod"
>SQL::Translator</a> to add an index for this constraint. Can also be specified globally in the args to <a href="../../../DBIx/Class/Schema.html#deploy" class="podlinkpod"
>&#34;deploy&#34; in DBIx::Class::Schema</a> or <a href="../../../DBIx/Class/Schema.html#create_ddl_dir" class="podlinkpod"
>&#34;create_ddl_dir&#34; in DBIx::Class::Schema</a>. Default is on, set to 0 to disable.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="register_relationship"
>register_relationship</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$rel_info"
>Arguments: $rel_name, $rel_info</a></dt>
</dl>

<p>Registers a relationship on the class. This is called internally by DBIx::Class::ResultSourceProxy to set up Accessors and Proxies.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="related_resultset"
>related_resultset</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name"
>Arguments: $rel_name</a></dt>

<dd>
<dt><a name="Return_Value:_$related_resultset"
>Return Value: <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>$related_resultset</a></a></dt>
</dl>

<pre>  $rs = $cd-&#62;related_resultset(&#39;artist&#39;);</pre>

<p>Returns a <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> for the relationship named $rel_name.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$relationship_accessor"
>$relationship_accessor</a></h2>

<dl>
<dt><a name="Arguments:_none"
>Arguments: none</a></dt>

<dd>
<dt><a name="Return_Value:_$result_|_$related_resultset_|_undef"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a> | <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>$related_resultset</a> | undef</a></dt>
</dl>

<pre>  # These pairs do the same thing
  $row = $cd-&#62;related_resultset(&#39;artist&#39;)-&#62;single;  # has_one relationship
  $row = $cd-&#62;artist;
  $rs = $cd-&#62;related_resultset(&#39;tracks&#39;);           # has_many relationship
  $rs = $cd-&#62;tracks;</pre>

<p>This is the recommended way to traverse through relationships, based on the <a href="#accessor" class="podlinkpod"
>&#34;accessor&#34;</a> name given in the relationship definition.</p>

<p>This will return either a <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>Result</a> or a <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>ResultSet</a>, depending on if the relationship is <code>single</code> (returns only one row) or <code>multi</code> (returns many rows). The method may also return <code>undef</code> if the relationship doesn&#39;t exist for this instance (like in the case of <code>might_have</code> relationships).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="search_related"
>search_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$cond?,_\%attrs?"
>Arguments: $rel_name, $cond?, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>\%attrs?</a></a></dt>

<dd>
<dt><a name="Return_Value:_$resultset_(scalar_context)_|_@result_objs_(list_context)"
>Return Value: <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>$resultset</a> (scalar context) | <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>@result_objs</a> (list context)</a></dt>
</dl>

<p>Run a search on a related resultset. The search will be restricted to the results represented by the <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> it was called upon.</p>

<p>See <a href="../../../DBIx/Class/ResultSet.html#search_related" class="podlinkpod"
>&#34;search_related&#34; in DBIx::Class::ResultSet</a> for more information.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="search_related_rs"
>search_related_rs</a></h2>

<p>This method works exactly the same as search_related, except that it guarantees a resultset, even in list context.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="count_related"
>count_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$cond?,_\%attrs?"
>Arguments: $rel_name, $cond?, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>\%attrs?</a></a></dt>

<dd>
<dt><a name="Return_Value:_$count"
>Return Value: $count</a></dt>
</dl>

<p>Returns the count of all the rows in the related resultset, restricted by the current result or where conditions.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new_related"
>new_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data"
>Arguments: $rel_name, \%col_data</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<p>Create a new result object of the related foreign class. It will magically set any foreign key columns of the new object to the related primary key columns of the source object for you. The newly created result will not be saved into your storage until you call <a href="../../../DBIx/Class/Row.html#insert" class="podlinkpod"
>&#34;insert&#34; in DBIx::Class::Row</a> on it.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="create_related"
>create_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data"
>Arguments: $rel_name, \%col_data</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<pre>  my $result = $obj-&#62;create_related($rel_name, \%col_data);</pre>

<p>Creates a new result object, similarly to new_related, and also inserts the result&#39;s data into your storage medium. See the distinction between <code>create</code> and <code>new</code> in <a href="../../../DBIx/Class/ResultSet.html" class="podlinkpod"
>DBIx::Class::ResultSet</a> for details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_related"
>find_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data_|_@pk_values,_{_key_=&#62;_$unique_constraint,_%attrs_}?"
>Arguments: $rel_name, \%col_data | @pk_values, { key =&#62; $unique_constraint, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>%attrs</a> }?</a></dt>

<dd>
<dt><a name="Return_Value:_$result_|_undef"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a> | undef</a></dt>
</dl>

<pre>  my $result = $obj-&#62;find_related($rel_name, \%col_data);</pre>

<p>Attempt to find a related object using its primary key or unique constraints. See <a href="../../../DBIx/Class/ResultSet.html#find" class="podlinkpod"
>&#34;find&#34; in DBIx::Class::ResultSet</a> for details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_or_new_related"
>find_or_new_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data,_{_key_=&#62;_$unique_constraint,_%attrs_}?"
>Arguments: $rel_name, \%col_data, { key =&#62; $unique_constraint, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>%attrs</a> }?</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<p>Find a result object of a related class. See <a href="../../../DBIx/Class/ResultSet.html#find_or_new" class="podlinkpod"
>&#34;find_or_new&#34; in DBIx::Class::ResultSet</a> for details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="find_or_create_related"
>find_or_create_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data,_{_key_=&#62;_$unique_constraint,_%attrs_}?"
>Arguments: $rel_name, \%col_data, { key =&#62; $unique_constraint, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>%attrs</a> }?</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<p>Find or create a result object of a related class. See <a href="../../../DBIx/Class/ResultSet.html#find_or_create" class="podlinkpod"
>&#34;find_or_create&#34; in DBIx::Class::ResultSet</a> for details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="update_or_create_related"
>update_or_create_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_\%col_data,_{_key_=&#62;_$unique_constraint,_%attrs_}?"
>Arguments: $rel_name, \%col_data, { key =&#62; $unique_constraint, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>%attrs</a> }?</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<p>Update or create a result object of a related class. See <a href="../../../DBIx/Class/ResultSet.html#update_or_create" class="podlinkpod"
>&#34;update_or_create&#34; in DBIx::Class::ResultSet</a> for details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_from_related"
>set_from_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$result"
>Arguments: $rel_name, <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>

<dd>
<dt><a name="Return_Value:_not_defined"
>Return Value: not defined</a></dt>
</dl>

<pre>  $book-&#62;set_from_related(&#39;author&#39;, $author_obj);
  $book-&#62;author($author_obj);                      ## same thing</pre>

<p>Set column values on the current object, using related values from the given related object. This is used to associate previously separate objects, for example, to set the correct author for a book, find the Author object, then call set_from_related on the book.</p>

<p>This is called internally when you pass existing objects as values to <a href="../../../DBIx/Class/ResultSet.html#create" class="podlinkpod"
>&#34;create&#34; in DBIx::Class::ResultSet</a>, or pass an object to a belongs_to accessor.</p>

<p>The columns are only set in the local copy of the object, call <a href="#update" class="podlinkpod"
>&#34;update&#34;</a> to set them in the storage.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="update_from_related"
>update_from_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$result"
>Arguments: $rel_name, <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>

<dd>
<dt><a name="Return_Value:_not_defined"
>Return Value: not defined</a></dt>
</dl>

<pre>  $book-&#62;update_from_related(&#39;author&#39;, $author_obj);</pre>

<p>The same as <a href="#set_from_related" class="podlinkpod"
>&#34;set_from_related&#34;</a>, but the changes are immediately updated in storage.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="delete_related"
>delete_related</a></h2>

<dl>
<dt><a name="Arguments:_$rel_name,_$cond?,_\%attrs?"
>Arguments: $rel_name, $cond?, <a href="../../../DBIx/Class/ResultSet.html#ATTRIBUTES" class="podlinkpod"
>\%attrs?</a></a></dt>

<dd>
<dt><a name="Return_Value:_$underlying_storage_rv"
>Return Value: $underlying_storage_rv</a></dt>
</dl>

<p>Delete any related row, subject to the given conditions. Internally, this calls:</p>

<pre>  $self-&#62;search_related(@_)-&#62;delete</pre>

<p>And returns the result of that.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="add_to_$rel"
>add_to_$rel</a></h2>

<p><b>Currently only available for <code>has_many</code>, <code>many_to_many</code> and &#39;multi&#39; type relationships.</b></p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="has_many_/_multi"
>has_many / multi</a></h3>

<dl>
<dt><a name="Arguments:_\%col_data"
>Arguments: \%col_data</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<p>Creates/inserts a new result object. Internally, this calls:</p>

<pre>  $self-&#62;create_related($rel, @_)</pre>

<p>And returns the result of that.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="many_to_many"
>many_to_many</a></h3>

<dl>
<dt><a name="Arguments:_(\%col_data_|_$result),_\%link_col_data?"
>Arguments: (\%col_data | <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a>), \%link_col_data?</a></dt>

<dd>
<dt><a name="Return_Value:_$result"
>Return Value: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>
</dl>

<pre>  my $role = $schema-&#62;resultset(&#39;Role&#39;)-&#62;find(1);
  $actor-&#62;add_to_roles($role);
      # creates a My::DBIC::Schema::ActorRoles linking table result object

  $actor-&#62;add_to_roles({ name =&#62; &#39;lead&#39; }, { salary =&#62; 15_000_000 });
      # creates a new My::DBIC::Schema::Role result object and the linking table
      # object with an extra column in the link</pre>

<p>Adds a linking table object. If the first argument is a hash reference, the related object is created first with the column values in the hash. If an object reference is given, just the linking table object is created. In either case, any additional column values for the linking table object can be specified in <code>\%link_col_data</code>.</p>

<p>See <a href="../../../DBIx/Class/Relationship.html#many_to_many" class="podlinkpod"
>&#34;many_to_many&#34; in DBIx::Class::Relationship</a> for additional details.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_$rel"
>set_$rel</a></h2>

<p><b>Currently only available for <code>many_to_many</code> relationships.</b></p>

<dl>
<dt><a name="Arguments:_(\@hashrefs_of_col_data_|_\@result_objs),_$link_vals?"
>Arguments: (\@hashrefs_of_col_data | <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>\@result_objs</a>), $link_vals?</a></dt>

<dd>
<dt><a name="Return_Value:_not_defined"
>Return Value: not defined</a></dt>
</dl>

<pre>  my $actor = $schema-&#62;resultset(&#39;Actor&#39;)-&#62;find(1);
  my @roles = $schema-&#62;resultset(&#39;Role&#39;)-&#62;search({ role =&#62;
     { &#39;-in&#39; =&#62; [&#39;Fred&#39;, &#39;Barney&#39;] } } );

  $actor-&#62;set_roles(\@roles);
     # Replaces all of $actor&#39;s previous roles with the two named

  $actor-&#62;set_roles(\@roles, { salary =&#62; 15_000_000 });
     # Sets a column in the link table for all roles</pre>

<p>Replace all the related objects with the given reference to a list of objects. This does a <code>delete</code> <b>on the link table resultset</b> to remove the association between the current object and all related objects, then calls <code>add_to_$rel</code> repeatedly to link all the new objects.</p>

<p>Note that this means that this method will <b>not</b> delete any objects in the table on the right side of the relation, merely that it will delete the link between them.</p>

<p>Due to a mistake in the original implementation of this method, it will also accept a list of objects or hash references. This is <b>deprecated</b> and will be removed in a future version.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="remove_from_$rel"
>remove_from_$rel</a></h2>

<p><b>Currently only available for <code>many_to_many</code> relationships.</b></p>

<dl>
<dt><a name="Arguments:_$result"
>Arguments: <a href="../../../DBIx/Class/Manual/ResultClass.html" class="podlinkpod"
>$result</a></a></dt>

<dd>
<dt><a name="Return_Value:_not_defined"
>Return Value: not defined</a></dt>
</dl>

<pre>  my $role = $schema-&#62;resultset(&#39;Role&#39;)-&#62;find(1);
  $actor-&#62;remove_from_roles($role);
      # removes $role&#39;s My::DBIC::Schema::ActorRoles linking table result object</pre>

<p>Removes the link between the current object and the related object. Note that the related object itself won&#39;t be deleted unless you call -&#62;delete() on it. This method just removes the link between the two objects.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR_AND_CONTRIBUTORS"
>AUTHOR AND CONTRIBUTORS</a></h1>

<p>See <a href="../../../DBIx/Class.html#AUTHOR" class="podlinkpod"
>AUTHOR</a> and <a href="../../../DBIx/Class.html#CONTRIBUTORS" class="podlinkpod"
>CONTRIBUTORS</a> in DBIx::Class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LICENSE"
>LICENSE</a></h1>

<p>You may distribute this code under the same terms as Perl itself.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
