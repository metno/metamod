<html><head><title>IO::Pipely</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.16,
  using Pod::Simple::PullParser v3.16,
  under Perl v5.014002 at Tue Mar 25 17:14:19 2014 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#VERSION'>VERSION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#pipely'>pipely</a>
    <li class='indexItem indexItem2'><a href='#socketpairly'>socketpairly</a>
    <li class='indexItem indexItem2'><a href='#PIPE_TYPES'>PIPE TYPES</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#pipe'>pipe</a>
      <li class='indexItem indexItem3'><a href='#socketpair'>socketpair</a>
      <li class='indexItem indexItem3'><a href='#inet'>inet</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#KNOWN_ISSUES'>KNOWN ISSUES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Cygwin'>Cygwin</a>
    <li class='indexItem indexItem2'><a href='#MacOS_9'>MacOS 9</a>
    <li class='indexItem indexItem2'><a href='#Symbol%3A%3Agensym'>Symbol::gensym</a>
    <li class='indexItem indexItem2'><a href='#Windows'>Windows</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#BUGS'>BUGS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR_%26_COPYRIGHT'>AUTHOR &#38; COPYRIGHT</a>
  <li class='indexItem indexItem1'><a href='#HISTORY'>HISTORY</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>IO::Pipely - Portably create pipe() or pipe-like handles,
one way or another.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="VERSION"
>VERSION</a></h1>

<p>version 0.005</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>Please read DESCRIPTION for detailed semantics and caveats.</p>

<pre>  use IO::Pipely qw(pipely socketpairly);

  # Create a one-directional pipe() or pipe-like thing
  # the best conduit type available.

  my ($read, $write) = pipely();

  # Create a one-directional pipe-like thing using an
  # INET socket specifically.  Other types are available.

  my ($read, $write) = pipely(type =&#62; &#39;inet&#39;);

  # Create a bidirectional pipe-like thing using
  # the best conduit type available.

  my (
    $side_a_read,  $side_b_read,
    $side_a_write, $side_b_write,
  ) = socketpairly();

  # Create a bidirectional pipe-like thing using an INET socket
  # specifically.

  my (
    $side_a_read,  $side_b_read,
    $side_a_write, $side_b_write,
  ) = socketpairly(type =&#62; &#39;inet&#39;);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Pipes are troublesome beasts because there are a few different, incompatible ways to create them. Not all platforms support all ways, and some platforms may have hidden difficulties like incomplete or buggy support.</p>

<p>IO::Pipely provides a couple functions to portably create one- and two-way pipes and pipe-like socket pairs. It acknowledges and works around known platform issues so you don&#39;t have to.</p>

<p>On the other hand, it doesn&#39;t work around unknown issues, so please report any problems early and often.</p>

<p>IO::Pipely currently understands pipe(), UNIX-domain socketpair() and regular IPv4 localhost sockets. This covers every platform tested so far, but it&#39;s hardly complete. Please help support other mechanisms, such as INET-domain socketpair() and IPv6 localhost sockets.</p>

<p>IO::Pipely will use different kinds of pipes or sockets depending on the operating system&#39;s capabilities and the number of directions requested. The autodetection may be overridden by specifying a particular pipe type.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="pipely"
>pipely</a></h2>

<p>pipely() creates a one-directional pipe() or socket. It&#39;s modeled after Perl&#39;s built-in pipe() function, but it creates and returns handles rather than opening ones given to it.</p>

<p>On success, pipely() returns two file handles, the first to read from the pipe, and the second writes into the pipe. It returns nothing on failure.</p>

<pre>  use IO::Pipely qw(pipely);
  my ($a_read, $b_write) = pipely();
  die &#34;pipely() failed: $!&#34; unless $a_read;</pre>

<p>When given a choice, it will prefer to use leaner pipe() calls instead of socketpair() and socket().</p>

<p>pipely()&#39;s choice can be forced using an optional named &#34;type&#34; parameter. See <a href="#PIPE_TYPES" class="podlinkpod"
>&#34;PIPE TYPES&#34;</a> for the types that can be used.</p>

<pre>  my ($a_read, $b_write) = pipely(
    type =&#62; &#39;pipe&#39;,
  );</pre>

<p>On most systems, pipely() will prefer to open a pipe() first. It will fall back to a UNIX socketpair() or two localhost Internet sockets, in that order.</p>

<p>On Windows (ActiveState and Strawberry Perl), pipely() prefers two localhost Internet sockets. It will fall back to socketpair() and pipe(), both of which will probably fail.</p>

<p>Cygwin Perl prefers pipe() first, localhost Internet sockets, and then socketpair(). socketpair() has been known to have problems on Cygwin.</p>

<p>MacPerl (MacOS 9 and earlier) has similar capaibilities to Windows.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="socketpairly"
>socketpairly</a></h2>

<p>socketpairly() creates a two-directional socket pair. It&#39;s modeled after Perl&#39;s built-in socketpair(), but it creates and returns handles rather than opening ones given to it.</p>

<p>On success, socketpairly() returns four file handles, read and write for one end, and read and write for the other. On failure, it returns nothing.</p>

<pre>  use IO::Pipely qw(socketpairly);
  my ($a_read, $b_read, $a_write, $b_write) = socketpairly();
  die &#34;socketpairly() failed: $!&#34; unless $a_read;</pre>

<p>socketpairly() returns two extra &#34;writer&#34; handles. They exist for the fallback case where two pipe() calls are needed instead of one socket pair. The extra handles can be ignored whenever pipe() will never be used. For example:</p>

<pre>  use IO::Pipely qw(socketpairly);
  my ($side_a, $side_b) = socketpairly( type =&#62; &#39;socketpair&#39; );
  die &#34;socketpairly() failed: $!&#34; unless $side_a;</pre>

<p>When given a choice, it will prefer bidirectional sockets instead of pipe() calls.</p>

<p>socketpairly()&#39;s choice can be forced using an optional named &#34;type&#34; parameter. See <a href="#PIPE_TYPES" class="podlinkpod"
>&#34;PIPE TYPES&#34;</a> for the types that can be used. In this example, two unidirectional pipes wil be used instead of a more efficient pair of sockets:</p>

<pre>  my ($a_read, $a_write, $b_read, $b_write) = pipely(
    type =&#62; &#39;pipe&#39;,
  );</pre>

<p>On most systems, socketpairly() will try to open a UNIX socketpair() first. It will then fall back to a pair of localhost Internet sockets, and finally it will try a pair of pipe() calls.</p>

<p>On Windows (ActiveState and Strawberry Perl), socketpairly() prefers a pair of localhost Internet sockets first. It will then fall back to a UNIX socketpair(), and finally a couple of pipe() calls. The fallback options will probably fail, but the code remains hopeful.</p>

<p>Cygwin Perl prefers localhost Internet sockets first, followed by a pair of pipe() calls, and finally a UNIX socketpair(). Those who know may find this counter-intuitive, but it works around known issues in some versions of Cygwin socketpair().</p>

<p>MacPerl (MacOS 9 and earlier) has similar capaibilities to Windows.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="PIPE_TYPES"
>PIPE TYPES</a></h2>

<p>IO::Pipely currently supports three types of pipe and socket. Other types are possible, but these three cover all known uses so far. Please ask (or send patches) if additional types are needed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="pipe"
>pipe</a></h3>

<p>Attempt to establish a one-way pipe using one pipe() filehandle pair (2 file descriptors), or a two-way pipe-like connection using two pipe() pairs (4 file descriptors).</p>

<p>IO::Pipely prefers to use pipe() for one-way pipes and some form of socket pair for two-way pipelike things.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="socketpair"
>socketpair</a></h3>

<p>Attempt to establish a one- or two-way pipelike connection using a single socketpair() call. This uses two file descriptors regardless whether the connection is one- or two-way.</p>

<p>IO::Pipely prefers socketpair() for two-way connections, unless the current platform has known issues with the socketpair() call.</p>

<p>Socket pairs are UNIX domain only for now. INET domain may be added if it improves compatibility on some platform, or if someone contributes the code.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="inet"
>inet</a></h3>

<p>Attempt to establish a one- or two-way pipelike connection using localhost socket() calls. This uses two file descriptors regardless whether the connection is one- or two-way.</p>

<p>Localhost INET domain sockets are a last resort for platforms that don&#39;t support something better. They are the least secure method of communication since tools like tcpdump and Wireshark can tap into them. On the other hand, this makes them easiest to debug.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="KNOWN_ISSUES"
>KNOWN ISSUES</a></h1>

<p>These are issues known to the developers at the time of this writing. Things change, so check back now and then.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Cygwin"
>Cygwin</a></h2>

<p>CygWin seems to have a problem with socketpair() and exec(). When an exec&#39;d process closes, any data on sockets created with socketpair() is not flushed. From irc.perl.org channel #poe:</p>

<pre>  &#60;dngnand&#62;   Sounds like a lapse in cygwin&#39;s exec implementation.
              It works ok under Unix-ish systems?
  &#60;jdeluise2&#62; yes, it works perfectly
  &#60;jdeluise2&#62; but, if we just use POE::Pipe::TwoWay-&#62;new(&#34;pipe&#34;)
              it always works fine on cygwin
  &#60;jdeluise2&#62; by the way, it looks like the reason is that
              POE::Pipe::OneWay works because it tries to make a
              pipe first instead of a socketpair
  &#60;jdeluise2&#62; this socketpair problem seems like a long-standing
              one with cygwin, according to searches on google,
              but never been fixed.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="MacOS_9"
>MacOS 9</a></h2>

<p>IO::Pipely supports MacOS 9 for historical reasons. It&#39;s unclear whether anyone still uses MacPerl, but the support is cheap since pipes and sockets there have many of the same caveats as they do on Windows.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Symbol::gensym"
>Symbol::gensym</a></h2>

<p>IO::Pipely uses Symbol::gensym() instead of autovivifying file handles. The main reasons against gensym() have been stylistic ones so far. Meanwhile, gensym() is compatible farther back than handle autovivification.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Windows"
>Windows</a></h2>

<p>ActiveState and Strawberry Perl don&#39;t support pipe() or UNIX socketpair(). Localhost Internet sockets are used for everything there, including one-way pipes.</p>

<p>For one-way pipes, the unused socket directions are shut down to avoid sending data the wrong way through them. Use socketpairly() instead.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS</a></h1>

<p>The functions implemented here die outright upon failure, requiring eval{} around their calls.</p>

<p>The following conduit types are currently unsupported because nobody has needed them so far. Please submit a request (and/or a patch) if any of these is needed:</p>

<pre>  UNIX socket()
  INET-domain socketpair()
  IPv4-specific localhost sockets
  IPv6-specific localhost sockets</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR_&#38;_COPYRIGHT"
>AUTHOR &#38; COPYRIGHT</a></h1>

<p>IO::Pipely is copyright 2000-2013 by Rocco Caputo. All rights reserved. IO::Pipely is free software; you may redistribute it and/or modify it under the same terms as Perl itself.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="HISTORY"
>HISTORY</a></h1>

<p>IO::Pipely is a spin-off of the <a href="../POE.html" class="podlinkpod"
>POE</a> project&#39;s portable pipes. Earlier versions of the code have been tested and used in production systems for over a decade.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
